/*
 RequireJS 2.0.2 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
 RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/text for details
*/
var redhelper;
(function(){if(typeof redhelper==="undefined"){redhelper={};var a,d,b;(function(e){function j(a){return x.call(a)==="[object Function]"}function f(a){return x.call(a)==="[object Array]"}function c(a,b){if(a){var c;for(c=0;c<a.length;c+=1)if(a[c]&&b(a[c],c,a))break}}function k(a,b){if(a){var c;for(c=a.length-1;c>-1;c-=1)if(a[c]&&b(a[c],c,a))break}}function n(a,b){for(var c in a)if(a.hasOwnProperty(c)&&b(a[c],c))break}function t(a,b,c,d){b&&n(b,function(b,e){if(c||!a.hasOwnProperty(e))d&&typeof b!==
"string"?(a[e]||(a[e]={}),t(a[e],b,c,d)):a[e]=b});return a}function r(a,b){return function(){return b.apply(a,arguments)}}function q(a){if(!a)return a;var b=e;c(a.split("."),function(a){b=b[a]});return b}function m(a,b,c){return function(){var d=S.call(arguments,0),e;if(c&&j(e=d[d.length-1]))e.__requireJsBuild=!0;d.push(b);return a.apply(null,d)}}function p(a,b,d){c([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(c){var e=c[1]||c[0];a[c[0]]=b?m(b[e],d):
function(){var a=P[u];return a[e].apply(a,arguments)}})}function i(a,b,c,d){b=Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);b.requireType=a;b.requireModules=d;if(c)b.originalError=c;return b}function h(){if(J&&J.readyState==="interactive")return J;k(document.getElementsByTagName("script"),function(a){if(a.readyState==="interactive")return J=a});return J}var l=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,v=/require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,C=/\.js$/,K=/^\.\//,x=Object.prototype.toString,
s=Array.prototype,S=s.slice,O=s.splice,D=!!(typeof window!=="undefined"&&navigator&&document),w=!D&&typeof importScripts!=="undefined",B=D&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,u="_",$=typeof opera!=="undefined"&&opera&&opera.toString()==="[object Opera]",P={},Q={},T=[],R=!1,H,U,W,N,E,J,X,Y,y;if(typeof b==="undefined"){if(typeof a!=="undefined"){if(j(a))return;Q=a;a=void 0}typeof d!=="undefined"&&!j(d)&&(Q=d,d=void 0);H=a=function(a,b,c,d){var e=u,i;!f(a)&&typeof a!==
"string"&&(i=a,f(b)?(a=b,b=c,c=d):a=[]);if(i&&i.context)e=i.context;(d=P[e])||(d=P[e]=H.s.newContext(e));i&&d.configure(i);return d.require(a,b,c)};H.config=function(a){return H(a)};d||(d=H);H.version="2.0.2";H.jsExtRegExp=/^\/|:|\?|\.js$/;H.isBrowser=D;s=H.s={contexts:P,newContext:function(a){function b(a,c,d){var e=c&&c.split("/"),f=L.map,i=f&&f["*"],k,h,l,j;if(a&&a.charAt(0)===".")if(c){e=L.pkgs[c]?[c]:e.slice(0,e.length-1);c=a=e.concat(a.split("/"));for(k=0;c[k];k+=1)if(h=c[k],h===".")c.splice(k,
1),k-=1;else if(h==="..")if(k===1&&(c[2]===".."||c[0]===".."))break;else k>0&&(c.splice(k-1,2),k-=2);k=L.pkgs[c=a[0]];a=a.join("/");k&&a===c+"/"+k.main&&(a=c)}else a.indexOf("./")===0&&(a=a.substring(2));if(d&&(e||i)&&f){c=a.split("/");for(k=c.length;k>0;k-=1){l=c.slice(0,k).join("/");if(e)for(h=e.length;h>0;h-=1)if(d=f[e.slice(0,h).join("/")])if(d=d[l]){j=d;break}!j&&i&&i[l]&&(j=i[l]);if(j){c.splice(0,k,j);a=c.join("/");break}}}return a}function d(a){D&&c(document.getElementsByTagName("script"),
function(b){if(b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===I.contextName)return b.parentNode.removeChild(b),!0})}function k(a){var b=L.paths[a];if(b&&f(b)&&b.length>1)return d(a),b.shift(),I.undef(a),I.require([a]),!0}function h(a,c,d,e){var f=a?a.indexOf("!"):-1,i=null,k=c?c.name:null,l=a,j=!0,p="",n,m;a||(j=!1,a="_@r"+(sa+=1));f!==-1&&(i=a.substring(0,f),a=a.substring(f+1,a.length));i&&(i=b(i,k,e),m=V[i]);a&&(i?p=m&&m.normalize?m.normalize(a,function(a){return b(a,
k,e)}):b(a,k,e):(p=b(a,k,e),n=I.nameToUrl(a,null,c)));a=i&&!m&&!d?"_unnormalized"+(Ba+=1):"";return{prefix:i,name:p,parentMap:c,unnormalized:!!a,url:n,originalName:l,isDefine:j,id:(i?i+"!"+p:p)+a}}function l(a){var b=a.id,c=E[b];c||(c=E[b]=new I.Module(a));return c}function v(a,b,c){var d=a.id,e=E[d];if(V.hasOwnProperty(d)&&(!e||e.defineEmitComplete))b==="defined"&&c(V[d]);else l(a).on(b,c)}function s(a,b){var d=a.requireModules,e=!1;if(b)b(a);else if(c(d,function(b){if(b=E[b])b.error=a,b.events.error&&
(e=!0,b.emit("error",a))}),!e)H.onError(a)}function u(){T.length&&(O.apply(ca,[ca.length-1,0].concat(T)),T=[])}function x(a,b,c){a=a&&a.map;b=m(c||I.require,a,b);p(b,I,a);b.isBrowser=D;return b}function S(a){delete E[a];c(fa,function(b,c){if(b.map.id===a)return fa.splice(c,1),b.defined||(I.waitCount-=1),!0})}function y(a,b){var d=a.map.id,e=a.depMaps,f;if(a.inited){if(b[d])return a;b[d]=!0;c(e,function(a){if(a=E[a.id])return!a.inited||!a.enabled?(f=null,delete b[d],!0):f=y(a,t({},b))});return f}}
function N(a,b,d){var e=a.map.id,f=a.depMaps;if(a.inited&&a.map.isDefine){if(b[e])return V[e];b[e]=a;c(f,function(c){var c=c.id,f=E[c];!ga[c]&&f&&(!f.inited||!f.enabled?d[e]=!0:(f=N(f,b,d),d[c]||a.defineDepById(c,f)))});a.check(!0);return V[e]}}function W(a){a.check()}function U(){var a=L.waitSeconds*1E3,b=a&&I.startTime+a<(new Date).getTime(),e=[],f=!1,h=!0,l,j,p;if(!pa){pa=!0;n(E,function(a){l=a.map;j=l.id;if(a.enabled&&!a.error)if(!a.inited&&b)k(j)?f=p=!0:(e.push(j),d(j));else if(!a.inited&&a.fetched&&
l.isDefine&&(f=!0,!l.prefix))return h=!1});if(b&&e.length)return a=i("timeout","Load timeout for modules: "+e,null,e),a.contextName=I.contextName,s(a);h&&(c(fa,function(a){if(!a.defined){var a=y(a,{}),b={};a&&(N(a,b,{}),n(b,W))}}),n(E,W));if((!b||p)&&f)if((D||w)&&!la)la=setTimeout(function(){la=0;U()},50);pa=!1}}function P(a){l(h(a[0],null,!0)).init(a[1],a[2])}function Q(a){var a=a.currentTarget||a.srcElement,b=I.onScriptLoad;a.detachEvent&&!$?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",
b,!1);b=I.onScriptError;a.detachEvent&&!$||a.removeEventListener("error",b,!1);return{node:a,id:a&&a.getAttribute("data-requiremodule")}}var L={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{}},E={},X={},ca=[],V={},Y={},sa=1,Ba=1,fa=[],pa,qa,I,ga,la;ga={require:function(a){return x(a)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports=V[a.map.id]={}},module:function(a){return a.module={id:a.map.id,uri:a.map.url,config:function(){return L.config&&L.config[a.map.id]||{}},exports:V[a.map.id]}}};
qa=function(a){this.events=X[a.id]||{};this.map=a;this.shim=L.shim[a.id];this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};qa.prototype={init:function(a,b,c,d){d=d||{};if(!this.inited){this.factory=b;if(c)this.on("error",c);else this.events.error&&(c=r(this,function(a){this.emit("error",a)}));this.depMaps=a&&a.slice(0);this.depMaps.rjsSkipMap=a.rjsSkipMap;this.errback=c;this.inited=!0;this.ignore=d.ignore;d.enabled||this.enabled?this.enable():this.check()}},
defineDepById:function(a,b){var d;c(this.depMaps,function(b,c){if(b.id===a)return d=c,!0});return this.defineDep(d,b)},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0;I.startTime=(new Date).getTime();var a=this.map;if(this.shim)x(this,!0)(this.shim.deps||[],r(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()}},load:function(){var a=
this.map.url;Y[a]||(Y[a]=!0,I.load(this.map.id,a))},check:function(a){if(this.enabled&&!this.enabling){var b=this.map.id,c=this.depExports,d=this.exports,e=this.factory,f;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(j(e)){if(this.events.error)try{d=I.execCb(b,e,c,d)}catch(i){f=i}else d=I.execCb(b,e,c,d);if(this.map.isDefine)if((c=this.module)&&c.exports!==void 0&&c.exports!==this.exports)d=c.exports;else if(d===
void 0&&this.usingExports)d=this.exports;if(f)return f.requireMap=this.map,f.requireModules=[this.map.id],f.requireType="define",s(this.error=f)}else d=e;this.exports=d;if(this.map.isDefine&&!this.ignore&&(V[b]=d,H.onResourceLoad))H.onResourceLoad(I,this.map,this.depMaps);delete E[b];this.defined=!0;I.waitCount-=1;I.waitCount===0&&(fa=[])}this.defining=!1;if(!a&&this.defined&&!this.defineEmitted)this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0}}else this.fetch()}},
callPlugin:function(){var a=this.map,c=a.id,d=h(a.prefix,null,!1,!0);v(d,"defined",r(this,function(d){var e=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null;if(this.map.unnormalized){if(d.normalize&&(e=d.normalize(e,function(a){return b(a,f,!0)})||""),d=h(a.prefix+"!"+e,this.map.parentMap,!1,!0),v(d,"defined",r(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),d=E[d.id]){if(this.events.error)d.on("error",r(this,function(a){this.emit("error",a)}));d.enable()}}else e=
r(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=r(this,function(a){this.inited=!0;this.error=a;a.requireModules=[c];n(E,function(a){a.map.id.indexOf(c+"_unnormalized")===0&&S(a.map.id)});s(a)}),e.fromText=function(a,b){var c=R;c&&(R=!1);l(h(a));H.exec(b);c&&(R=!0);I.completeLoad(a)},d.load(a.name,x(a.parentMap,!0,function(a,b){a.rjsSkipMap=!0;return I.require(a,b)}),e,L)}));I.enable(d,this);this.pluginMaps[d.id]=d},enable:function(){this.enabled=!0;if(!this.waitPushed)fa.push(this),
I.waitCount+=1,this.waitPushed=!0;this.enabling=!0;c(this.depMaps,r(this,function(a,b){var c,d;if(typeof a==="string"){a=h(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.depMaps.rjsSkipMap);this.depMaps[b]=a;if(c=ga[a.id]){this.depExports[b]=c(this);return}this.depCount+=1;v(a,"defined",r(this,function(a){this.defineDep(b,a);this.check()}));this.errback&&v(a,"error",this.errback)}c=a.id;d=E[c];!ga[c]&&d&&!d.enabled&&I.enable(a,this)}));n(this.pluginMaps,r(this,function(a){var b=E[a.id];
b&&!b.enabled&&I.enable(a,this)}));this.enabling=!1;this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]);c.push(b)},emit:function(a,b){c(this.events[a],function(a){a(b)});a==="error"&&delete this.events[a]}};return I={config:L,contextName:a,registry:E,defined:V,urlFetched:Y,waitCount:0,defQueue:ca,Module:qa,makeModuleMap:h,configure:function(a){a.baseUrl&&a.baseUrl.charAt(a.baseUrl.length-1)!=="/"&&(a.baseUrl+="/");var b=L.pkgs,d=L.shim,e=L.paths,i=L.map;t(L,a,!0);L.paths=
t(e,a.paths,!0);if(a.map)L.map=t(i||{},a.map,!0,!0);if(a.shim)n(a.shim,function(a,b){f(a)&&(a={deps:a});if(a.exports&&!a.exports.__buildReady)a.exports=I.makeShimExports(a.exports);d[b]=a}),L.shim=d;if(a.packages)c(a.packages,function(a){a=typeof a==="string"?{name:a}:a;b[a.name]={name:a.name,location:a.location||a.name,main:(a.main||"main").replace(K,"").replace(C,"")}}),L.pkgs=b;n(E,function(a,b){a.map=h(b)});if(a.deps||a.callback)I.require(a.deps||[],a.callback)},makeShimExports:function(a){var b;
return typeof a==="string"?(b=function(){return q(a)},b.exports=a,b):function(){return a.apply(e,arguments)}},requireDefined:function(a,b){var c=h(a,b,!1,!0).id;return V.hasOwnProperty(c)},requireSpecified:function(a,b){a=h(a,b,!1,!0).id;return V.hasOwnProperty(a)||E.hasOwnProperty(a)},require:function(b,c,d,e){var f;if(typeof b==="string"){if(j(c))return s(i("requireargs","Invalid require call"),d);if(H.get)return H.get(I,b,c);b=h(b,c,!1,!0);b=b.id;return!V.hasOwnProperty(b)?s(i("notloaded",'Module name "'+
b+'" has not been loaded yet for context: '+a)):V[b]}d&&!j(d)&&(e=d,d=void 0);c&&!j(c)&&(e=c,c=void 0);for(u();ca.length;)if(f=ca.shift(),f[0]===null)return s(i("mismatch","Mismatched anonymous redhelper.define() module: "+f[f.length-1]));else P(f);l(h(null,e)).init(b,c,d,{enabled:!0});U();return I.require},undef:function(a){var b=h(a,null,!0),c=E[a];delete V[a];delete Y[b.url];delete X[a];if(c){if(c.events.defined)X[a]=c.events;S(a)}},enable:function(a){E[a.id]&&l(a).enable()},completeLoad:function(a){var b=
L.shim[a]||{},c=b.exports&&b.exports.exports,d,e;for(u();ca.length;){e=ca.shift();if(e[0]===null){e[0]=a;if(d)break;d=!0}else e[0]===a&&(d=!0);P(e)}e=E[a];if(!d&&!V[a]&&e&&!e.inited)if(L.enforceDefine&&(!c||!q(c)))if(k(a))return;else return s(i("nodefine","No define call for "+a,null,[a]));else P([a,b.deps||[],b.exports]);U()},toUrl:function(a,b){var c=a.lastIndexOf("."),d=null;c!==-1&&(d=a.substring(c,a.length),a=a.substring(0,c));return I.nameToUrl(a,d,b)},nameToUrl:function(a,c,d){var e,i,k,h,
l,a=b(a,d&&d.id,!0);if(H.jsExtRegExp.test(a))c=a+(c||"");else{e=L.paths;i=L.pkgs;d=a.split("/");for(h=d.length;h>0;h-=1)if(l=d.slice(0,h).join("/"),k=i[l],l=e[l]){f(l)&&(l=l[0]);d.splice(0,h,l);break}else if(k){a=a===k.name?k.location+"/"+k.main:k.location;d.splice(0,h,a);break}c=d.join("/")+(c||".js");c=(c.charAt(0)==="/"||c.match(/^[\w\+\.\-]+:/)?"":L.baseUrl)+c}return L.urlArgs?c+((c.indexOf("?")===-1?"?":"&")+L.urlArgs):c},load:function(a,b){H.load(I,a,b)},execCb:function(a,b,c,d){return b.apply(d,
c)},onScriptLoad:function(a){if(a.type==="load"||B.test((a.currentTarget||a.srcElement).readyState))J=null,a=Q(a),I.completeLoad(a.id)},onScriptError:function(a){var b=Q(a);if(!k(b.id))return s(i("scripterror","Script error",a,[b.id]))}}}};H({});p(H);if(D&&(U=s.head=document.getElementsByTagName("head")[0],W=document.getElementsByTagName("base")[0]))U=s.head=W.parentNode;H.onError=function(a){throw a;};H.load=function(a,b,c){var d=a&&a.config||{},e;if(D)return e=d.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml",
"html:script"):document.createElement("script"),e.type=d.scriptType||"text/javascript",e.charset="utf-8",e.setAttribute("data-requirecontext",a.contextName),e.setAttribute("data-requiremodule",b),e.attachEvent&&!(e.attachEvent.toString&&e.attachEvent.toString().indexOf("[native code")<0)&&!$?(R=!0,e.attachEvent("onreadystatechange",a.onScriptLoad)):(e.addEventListener("load",a.onScriptLoad,!1),e.addEventListener("error",a.onScriptError,!1)),e.src=c,X=e,W?U.insertBefore(e,W):U.appendChild(e),X=null,
e;else w&&(importScripts(c),a.completeLoad(b))};D&&k(document.getElementsByTagName("script"),function(a){if(!U)U=a.parentNode;if(N=a.getAttribute("data-main")){E=N.split("/");Y=E.pop();y=E.length?E.join("/")+"/":"./";if(!Q.baseUrl)Q.baseUrl=y;N=Y.replace(C,"");Q.deps=Q.deps?Q.deps.concat(N):[N];return!0}});b=function(a,b,c){var d,e;typeof a!=="string"&&(c=b,b=a,a=null);f(b)||(c=b,b=[]);!b.length&&j(c)&&c.length&&(c.toString().replace(l,"").replace(v,function(a,c){b.push(c)}),b=(c.length===1?["require"]:
["require","exports","module"]).concat(b));if(R&&(d=X||h()))a||(a=d.getAttribute("data-requiremodule")),e=P[d.getAttribute("data-requirecontext")];(e?e.defQueue:T).push([a,b,c])};b.amd={jQuery:!0};H.exec=function(a){return eval(a)};H(Q)}})(this);redhelper.requirejs=a;redhelper.require=d;redhelper.define=b}})();redhelper.define("requireLib",function(){});
redhelper.define("common/extensions/base64",[],function(){var a={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(d){for(var b="",e,j,f,c,k,n,t=0,d=a._utf8_encode(d);t<d.length;)e=d.charCodeAt(t++),j=d.charCodeAt(t++),f=d.charCodeAt(t++),c=e>>2,e=(e&3)<<4|j>>4,k=(j&15)<<2|f>>6,n=f&63,isNaN(j)?k=n=64:isNaN(f)&&(n=64),b=b+this._keyStr.charAt(c)+this._keyStr.charAt(e)+this._keyStr.charAt(k)+this._keyStr.charAt(n);return b},decode:function(d){for(var b="",e,
j,f,c,k,n=0,d=d.replace(/[^A-Za-z0-9\+\/=]/g,"");n<d.length;)e=this._keyStr.indexOf(d.charAt(n++)),j=this._keyStr.indexOf(d.charAt(n++)),c=this._keyStr.indexOf(d.charAt(n++)),k=this._keyStr.indexOf(d.charAt(n++)),e=e<<2|j>>4,j=(j&15)<<4|c>>2,f=(c&3)<<6|k,b+=String.fromCharCode(e),c!=64&&(b+=String.fromCharCode(j)),k!=64&&(b+=String.fromCharCode(f));return b=a._utf8_decode(b)},_utf8_encode:function(a){for(var a=a.replace(/\r\n/g,"\n"),b="",e=0;e<a.length;e++){var j=a.charCodeAt(e);j<128?b+=String.fromCharCode(j):
(j>127&&j<2048?b+=String.fromCharCode(j>>6|192):(b+=String.fromCharCode(j>>12|224),b+=String.fromCharCode(j>>6&63|128)),b+=String.fromCharCode(j&63|128))}return b},_utf8_decode:function(a){for(var b="",e=0,j=0,f=0,c=0;e<a.length;)j=a.charCodeAt(e),j<128?(b+=String.fromCharCode(j),e++):j>191&&j<224?(f=a.charCodeAt(e+1),b+=String.fromCharCode((j&31)<<6|f&63),e+=2):(f=a.charCodeAt(e+1),c=a.charCodeAt(e+2),b+=String.fromCharCode((j&15)<<12|(f&63)<<6|c&63),e+=3);return b}};return a});
redhelper.define("common/communication/encoder",["common/extensions/base64"],function(a){return{serialize:function(a){return JSON.stringify(a)},parse:function(a){return JSON.parse(a)},compress:function(d){return a.encode(JSON.stringify(d))},decompress:function(d){return JSON.parse(a.decode(d))}}});
redhelper.define("config/setup",["common/communication/encoder"],function(a){var d;try{d=a.decompress(location.hash.split("#")[1])}catch(b){d={url:"//standalone"}}var e={DEBUG:!1,SHOW_EVENTS:!1,SHOW_SESSION:!1,XMPP_DOMAIN:"xmpp.redhelper.ru",DATA_URL:location.protocol+"//dh7xgsr9ech2h.cloudfront.net",BOSH_SERVICE:location.protocol+"//"+location.host+"/http-bind/",NX_URL:location.protocol+"//nx.redhelper.ru/nx/",CLIENT_NAME:location.href.split("?")[1].split("c=")[1].split("&")[0].split("#")[0],PARENT_URI:d.url,
PARENT_URL:d.url.split("//")[0]+"//"+d.url.split("//")[1].split("/")[0],STANDALONE:location.href.indexOf("&standalone")>-1,REQUIRE_OPERATOR:null,CURRENT_URL:"",CURRENT_TITLE:"",QUEUE_DELAY_COUNT:0};try{if(localStorage.getItem("rhlp.debug"))e.DEBUG=!0}catch(j){}e.empty=function(a){return a===void 0||a===""||typeof a==="number"&&isNaN(a)||a===null};Number.prototype.toVisitorJid=function(){return this+"@visitor."+e.XMPP_DOMAIN};String.prototype.toVisitorJid=function(){return this+"@visitor."+e.XMPP_DOMAIN};
String.prototype.toOperatorJid=function(){return this+"@operator."+e.XMPP_DOMAIN};String.prototype.extractNode=function(){var a=this.indexOf("@");return a>-1?this.slice(0,a):this};return e});
redhelper.define("common/extensions/debug",["config/setup"],function(a){return{log:function(d){a.DEBUG&&console&&console.log&&console.log(d)},eventLog:function(d){typeof a.SHOW_EVENTS!="undefined"&&a.SHOW_EVENTS&&console&&console.log&&console.log(d)},sessionLog:function(d){typeof a.SHOW_SESSION!="undefined"&&a.SHOW_SESSION&&console&&console.log&&console.log(d)},info:function(d){a.DEBUG&&console&&console.info&&console.info(d)},clear:function(){a.DEBUG&&console&&clear&&clear()},debug:function(d){a.DEBUG&&
console&&console.debug&&console.debug(d)},time:function(d){a.DEBUG&&console&&console.time&&console.time(d)},timeEnd:function(d){a.DEBUG&&console&&console.timeEnd&&console.timeEnd(d)},profile:function(){a.DEBUG&&console&&console.profile&&console.profile()},profileEnd:function(){a.DEBUG&&console&&console.profileEnd&&console.profileEnd()},error:function(d){a.DEBUG&&console&&console.trace&&console.trace();a.DEBUG&&console&&console.error&&console.error(d)},assert:function(d,b){a.DEBUG&&console&&console.assert&&
console.assert(d,b)}}});
redhelper.define("common/application/eventTarget",["config/setup","common/extensions/debug"],function(a,d){function b(a,b){this.message=b;this.name="Custom Event Exception";this.target=a}var e=function(a){this._listeners={};this.targetName=a};e.prototype={addEventListener:function(e,f){var c="dispatcher_"+e;if(a.empty(e))throw new b(this.targetName,"empty type");if(typeof f!=="function")throw new b(this.targetName,"provided listener for event type "+e+" is not a function");this._listeners[c]instanceof
Array||(this._listeners[c]=[]);for(var k in this._listeners[c])if(k===f){d.eventLog("Listener already exists:\ntargetName="+this.targetName+", type="+e);return}this._listeners[c].push(f);d.eventLog("New event listener added:\ntargetName="+this.targetName+", type="+e)},removeAllEventListeners:function(a){var b="dispatcher_"+a;this._listeners[b]&&(this._listeners[b]=[],d.eventLog("All listeners were removed\ntargetName="+this.targetName+", type="+a))},removeEventListener:function(a,b){var c="dispatcher_"+
a;if(this._listeners[c]){var e=this._listeners[c].indexOf(b);e!==-1&&(this._listeners[c].splice(e,1),d.eventLog("One listener was removed\ntargetName="+this.targetName+", type="+a))}},fire:function(a,e){typeof a==="string"&&(a={type:a});if(!a.target)a.target=this;if(!a.type)throw new b(this.targetName,"Event missing 'type' property");if(typeof e==="object")for(var c in e)e.hasOwnProperty(c)&&(a[c]=e[c]);c=0;var k="dispatcher_"+a.type;if(this._listeners[k])for(var k=this._listeners[k],n=k.length;c<
n;c++)try{k[c].call(this,a)}catch(t){d.error(t)}if(a.type!=="*"&&this._listeners["*"]){k=this._listeners["*"];for(n=k.length;c<n;c++)try{k[c].call(this,a)}catch(r){d.error(r)}}e&&!e.isMessageTarget&&d.eventLog("Event was fired, "+c+" listeners was called:\ntargetName="+this.targetName+", type="+a.type)}};return e});redhelper.define("application/dispatcher",["common/application/eventTarget"],function(a){return new a("Chat")});
if(!("bind"in Function.prototype))Function.prototype.bind=function(a){var d=this;if(arguments.length<=1)return function(){return d.apply(a,arguments)};else{var b=Array.prototype.slice.call(arguments,1);return function(){return d.apply(a,arguments.length===0?b:b.concat(Array.prototype.slice.call(arguments)))}}};if(!("trim"in String.prototype))String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};
if(!("indexOf"in Array.prototype))Array.prototype.indexOf=function(a,d){d===void 0&&(d=0);d<0&&(d+=this.length);d<0&&(d=0);for(var b=this.length;d<b;d++)if(this[d]===a)return d;return-1};if(!("lastIndexOf"in Array.prototype))Array.prototype.lastIndexOf=function(a,d){d===void 0&&(d=this.length-1);d<0&&(d+=this.length);d>this.length-1&&(d=this.length-1);for(d++;d-- >0;)if(d in this&&this[d]===a)return d;return-1};
if(!("forEach"in Array.prototype))Array.prototype.forEach=function(a,d){for(var b=0,e=this.length;b<e;b++)b in this&&a.call(d,this[b],b,this)};if(!("map"in Array.prototype))Array.prototype.map=function(a,d){for(var b=Array(this.length),e=0,j=this.length;e<j;e++)e in this&&(b[e]=a.call(d,this[e],e,this));return b};if(!("filter"in Array.prototype))Array.prototype.filter=function(a,d){for(var b=[],e,j=0,f=this.length;j<f;j++)j in this&&a.call(d,e=this[j],j,this)&&b.push(e);return b};
if(!("every"in Array.prototype))Array.prototype.every=function(a,d){for(var b=0,e=this.length;b<e;b++)if(b in this&&!a.call(d,this[b],b,this))return!1;return!0};if(!("some"in Array.prototype))Array.prototype.some=function(a,d){for(var b=0,e=this.length;b<e;b++)if(b in this&&a.call(d,this[b],b,this))return!0;return!1};if(JSON&&typeof JSON.stringify!="function")JSON.stringify=JSON.encode;if(JSON&&typeof JSON.parse!="function")JSON.parse=JSON.decode;
window.rhlpSetInterval=function(a,d){var b=function(){try{a()}catch(e){}setTimeout(b,d)};b()};window.rhlpSetRealInterval=function(a,d){var b=Math.ceil(1E3/d),e=function(){setTimeout(e,b*d);for(var j=0;j<b;j++)setTimeout(function(){a()},j*d)};e()};redhelper.define("common/extensions/compatibility",function(){});
redhelper.define("common/extensions/jquery",["common/extensions/compatibility"],function(){var a;(function(d,b){function e(a){var b=Q[a]={},c,d,a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}function j(g,z,c){if(c===b&&g.nodeType===1)if(c="data-"+z.replace(H,"-$1").toLowerCase(),c=g.getAttribute(c),typeof c==="string"){try{c=c==="true"?!0:c==="false"?!1:c==="null"?null:a.isNumeric(c)?+c:R.test(c)?a.parseJSON(c):c}catch(d){}a.data(g,z,c)}else c=b;return c}function f(g){for(var b in g)if(!(b===
"data"&&a.isEmptyObject(g[b]))&&b!=="toJSON")return!1;return!0}function c(g,b,c){var d=b+"defer",e=b+"queue",f=b+"mark",i=a._data(g,d);i&&(c==="queue"||!a._data(g,e))&&(c==="mark"||!a._data(g,f))&&setTimeout(function(){!a._data(g,e)&&!a._data(g,f)&&(a.removeData(g,d,!0),i.fire())},0)}function k(){return!1}function n(){return!0}function t(g,b,c){b=b||0;if(a.isFunction(b))return a.grep(g,function(a,g){return!!b.call(a,g,a)===c});else if(b.nodeType)return a.grep(g,function(a){return a===b===c});else if(typeof b===
"string"){var d=a.grep(g,function(a){return a.nodeType===1});if(lb.test(b))return a.filter(b,d,!c);else b=a.filter(b,d)}return a.grep(g,function(g){return a.inArray(g,b)>=0===c})}function r(a){var b=Ja.split("|"),a=a.createDocumentFragment();if(a.createElement)for(;b.length;)a.createElement(b.pop());return a}function q(g,b){if(b.nodeType===1&&a.hasData(g)){var c,d,e;d=a._data(g);var f=a._data(b,d),i=d.events;if(i)for(c in delete f.handle,f.events={},i)for(d=0,e=i[c].length;d<e;d++)a.event.add(b,c,
i[c][d]);if(f.data)f.data=a.extend({},f.data)}}function m(g,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes();b.mergeAttributes&&b.mergeAttributes(g);c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=g.outerHTML;else if(c==="input"&&(g.type==="checkbox"||g.type==="radio")){if(g.checked)b.defaultChecked=b.checked=g.checked;if(b.value!==g.value)b.value=g.value}else if(c==="option")b.selected=g.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=g.defaultValue;else if(c===
"script"&&b.text!==g.text)b.text=g.text;b.removeAttribute(a.expando);b.removeAttribute("_submit_attached");b.removeAttribute("_change_attached")}}function p(a){return typeof a.getElementsByTagName!=="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!=="undefined"?a.querySelectorAll("*"):[]}function i(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function h(g){var b=(g.nodeName||"").toLowerCase();b==="input"?i(g):b!=="script"&&typeof g.getElementsByTagName!==
"undefined"&&a.grep(g.getElementsByTagName("input"),i)}function l(g,b,c){var d=b==="width"?g.offsetWidth:g.offsetHeight,e=b==="width"?1:0;if(d>0){if(c!=="border")for(;e<4;e+=2)c||(d-=parseFloat(a.css(g,"padding"+ea[e]))||0),c==="margin"?d+=parseFloat(a.css(g,c+ea[e]))||0:d-=parseFloat(a.css(g,"border"+ea[e]+"Width"))||0;return d+"px"}d=ka(g,b);if(d<0||d==null)d=g.style[b];if(Aa.test(d))return d;d=parseFloat(d)||0;if(c)for(;e<4;e+=2)d+=parseFloat(a.css(g,"padding"+ea[e]))||0,c!=="padding"&&(d+=parseFloat(a.css(g,
"border"+ea[e]+"Width"))||0),c==="margin"&&(d+=parseFloat(a.css(g,c+ea[e]))||0);return d+"px"}function v(g){return function(b,c){var z;typeof b!=="string"&&(c=b,b="*");if(a.isFunction(c))for(var d=b.toLowerCase().split(La),e=0,f=d.length,i,k;e<f;e++)i=d[e],(k=/^\+/.test(i))&&(i=i.substr(1)||"*"),z=g[i]=g[i]||[],i=z,i[k?"unshift":"push"](c)}}function C(a,z,c,d,e,f){e=e||z.dataTypes[0];f=f||{};f[e]=!0;for(var e=a[e],i=0,k=e?e.length:0,h=a===Ca,l;i<k&&(h||!l);i++)l=e[i](z,c,d),typeof l==="string"&&(!h||
f[l]?l=b:(z.dataTypes.unshift(l),l=C(a,z,c,d,l,f)));if((h||!l)&&!f["*"])l=C(a,z,c,d,"*",f);return l}function K(g,c){var d,e,f=a.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?g:e||(e={}))[d]=c[d]);e&&a.extend(!0,g,e)}function x(g,b,c,d){if(a.isArray(b))a.each(b,function(a,b){c||nb.test(g)?d(g,b):x(g+"["+(typeof b==="object"?a:"")+"]",b,c,d)});else if(!c&&a.type(b)==="object")for(var e in b)x(g+"["+e+"]",b[e],c,d);else d(g,b)}function s(){try{return new d.XMLHttpRequest}catch(a){}}function S(){setTimeout(O,
0);return ta=a.now()}function O(){ta=b}function D(g,b){var c={};a.each(ua.concat.apply([],ua.slice(0,b)),function(){c[this]=g});return c}function w(g){if(!Da[g]){var b=u.body,c=a("<"+g+">").appendTo(b),d=c.css("display");c.remove();if(d==="none"||d===""){if(!aa)aa=u.createElement("iframe"),aa.frameBorder=aa.width=aa.height=0;b.appendChild(aa);if(!ma||!aa.createElement)ma=(aa.contentWindow||aa.contentDocument).document,ma.write((a.support.boxModel?"<!doctype html>":"")+"<html><body>"),ma.close();c=
ma.createElement(g);ma.body.appendChild(c);d=a.css(c,"display");b.removeChild(aa)}Da[g]=d}return Da[g]}function B(g){return a.isWindow(g)?g:g.nodeType===9?g.defaultView||g.parentWindow:!1}var u=d.document,$=d.navigator,P=d.location;a=function(){function a(){if(!c.isReady){try{u.documentElement.doScroll("left")}catch(b){setTimeout(a,1);return}c.ready()}}var c=function(a,g){return new c.fn.init(a,g,i)},e=d.jQuery,f=d.$,i,k=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,h=/\S/,l=/^\s+/,p=/\s+$/,j=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,
n=/^[\],:{}\s]*$/,m=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,q=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,v=/(?:^|:|,)(?:\s*\[)+/g,t=/(webkit)[ \/]([\w.]+)/,r=/(opera)(?:.*version)?[ \/]([\w.]+)/,s=/(msie) ([\w.]+)/,F=/(mozilla)(?:.*? rv:([\w.]+))?/,C=/-([a-z]|[0-9])/ig,x=/^-ms-/,K=function(a,g){return(g+"").toUpperCase()},A=$.userAgent,va,na,ob=Object.prototype.toString,Ea=Object.prototype.hasOwnProperty,Fa=Array.prototype.push,ra=Array.prototype.slice,B=String.prototype.trim,
w=Array.prototype.indexOf,J={};c.fn=c.prototype={constructor:c,init:function(a,g,d){var e;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(a==="body"&&!g&&u.body)return this.context=u,this[0]=u.body,this.selector=a,this.length=1,this;if(typeof a==="string")if((e=a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3?[null,a,null]:k.exec(a))&&(e[1]||!g))if(e[1])return d=(g=g instanceof c?g[0]:g)?g.ownerDocument||g:u,(a=j.exec(a))?c.isPlainObject(g)?(a=[u.createElement(a[1])],
c.fn.attr.call(a,g,!0)):a=[d.createElement(a[1])]:(a=c.buildFragment([e[1]],[d]),a=(a.cacheable?c.clone(a.fragment):a.fragment).childNodes),c.merge(this,a);else{if((g=u.getElementById(e[2]))&&g.parentNode){if(g.id!==e[2])return d.find(a);this.length=1;this[0]=g}this.context=u;this.selector=a;return this}else return!g||g.jquery?(g||d).find(a):this.constructor(g).find(a);else if(c.isFunction(a))return d.ready(a);if(a.selector!==b)this.selector=a.selector,this.context=a.context;return c.makeArray(a,
this)},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return ra.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,g,b){var d=this.constructor();c.isArray(a)?Fa.apply(d,a):c.merge(d,a);d.prevObject=this;d.context=this.context;if(g==="find")d.selector=this.selector+(this.selector?" ":"")+b;else if(g)d.selector=this.selector+"."+g+"("+b+")";return d},each:function(a,g){return c.each(this,a,g)},
ready:function(a){c.bindReady();va.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(ra.apply(this,arguments),"slice",ra.call(arguments).join(","))},map:function(a){return this.pushStack(c.map(this,function(g,b){return a.call(g,b,g)}))},end:function(){return this.prevObject||this.constructor(null)},push:Fa,sort:[].sort,splice:[].splice};c.fn.init.prototype=
c.fn;c.extend=c.fn.extend=function(){var a,g,d,e,G,f=arguments[0]||{},M=1,i=arguments.length,k=!1;typeof f==="boolean"&&(k=f,f=arguments[1]||{},M=2);typeof f!=="object"&&!c.isFunction(f)&&(f={});i===M&&(f=this,--M);for(;M<i;M++)if((a=arguments[M])!=null)for(g in a)d=f[g],e=a[g],f!==e&&(k&&e&&(c.isPlainObject(e)||(G=c.isArray(e)))?(G?(G=!1,d=d&&c.isArray(d)?d:[]):d=d&&c.isPlainObject(d)?d:{},f[g]=c.extend(k,d,e)):e!==b&&(f[g]=e));return f};c.extend({noConflict:function(a){if(d.$===c)d.$=f;if(a&&d.jQuery===
c)d.jQuery=e;return c},isReady:!1,readyWait:1,holdReady:function(a){a?c.readyWait++:c.ready(!0)},ready:function(a){if(a===!0&&!--c.readyWait||a!==!0&&!c.isReady){if(!u.body)return setTimeout(c.ready,1);c.isReady=!0;a!==!0&&--c.readyWait>0||(va.fireWith(u,[c]),c.fn.trigger&&c(u).trigger("ready").off("ready"))}},bindReady:function(){if(!va){va=c.Callbacks("once memory");if(u.readyState==="complete")return setTimeout(c.ready,1);if(u.addEventListener)u.addEventListener("DOMContentLoaded",na,!1),d.addEventListener("load",
c.ready,!1);else if(u.attachEvent){u.attachEvent("onreadystatechange",na);d.attachEvent("onload",c.ready);var b=!1;try{b=d.frameElement==null}catch(e){}u.documentElement.doScroll&&b&&a()}}},isFunction:function(a){return c.type(a)==="function"},isArray:Array.isArray||function(a){return c.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):J[ob.call(a)]||"object"},isPlainObject:function(a){if(!a||
c.type(a)!=="object"||a.nodeType||c.isWindow(a))return!1;try{if(a.constructor&&!Ea.call(a,"constructor")&&!Ea.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(g){return!1}for(var d in a);return d===b||Ea.call(a,d)},isEmptyObject:function(a){for(var g in a)return!1;return!0},error:function(a){throw Error(a);},parseJSON:function(a){if(typeof a!=="string"||!a)return null;a=c.trim(a);if(d.JSON&&d.JSON.parse)return d.JSON.parse(a);if(n.test(a.replace(m,"@").replace(q,"]").replace(v,"")))return(new Function("return "+
a))();c.error("Invalid JSON: "+a)},parseXML:function(a){if(typeof a!=="string"||!a)return null;var g,e;try{d.DOMParser?(e=new DOMParser,g=e.parseFromString(a,"text/xml")):(g=new ActiveXObject("Microsoft.XMLDOM"),g.async="false",g.loadXML(a))}catch(G){g=b}(!g||!g.documentElement||g.getElementsByTagName("parsererror").length)&&c.error("Invalid XML: "+a);return g},noop:function(){},globalEval:function(a){a&&h.test(a)&&(d.execScript||function(a){d.eval.call(d,a)})(a)},camelCase:function(a){return a.replace(x,
"ms-").replace(C,K)},nodeName:function(a,g){return a.nodeName&&a.nodeName.toUpperCase()===g.toUpperCase()},each:function(a,g,d){var e,G=0,f=a.length,M=f===b||c.isFunction(a);if(d)if(M)for(e in a){if(g.apply(a[e],d)===!1)break}else for(;G<f;){if(g.apply(a[G++],d)===!1)break}else if(M)for(e in a){if(g.call(a[e],e,a[e])===!1)break}else for(;G<f;)if(g.call(a[G],G,a[G++])===!1)break;return a},trim:B?function(a){return a==null?"":B.call(a)}:function(a){return a==null?"":a.toString().replace(l,"").replace(p,
"")},makeArray:function(a,g){var b=g||[];if(a!=null){var d=c.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||c.isWindow(a)?Fa.call(b,a):c.merge(b,a)}return b},inArray:function(a,g,b){var c;if(g){if(w)return w.call(g,a,b);c=g.length;for(b=b?b<0?Math.max(0,c+b):b:0;b<c;b++)if(b in g&&g[b]===a)return b}return-1},merge:function(a,g){var c=a.length,d=0;if(typeof g.length==="number")for(var z=g.length;d<z;d++)a[c++]=g[d];else for(;g[d]!==b;)a[c++]=g[d++];a.length=c;return a},grep:function(a,
g,b){for(var c=[],d,b=!!b,z=0,e=a.length;z<e;z++)d=!!g(a[z],z),b!==d&&c.push(a[z]);return c},map:function(a,g,d){var e,G,f=[],M=0,i=a.length;if(a instanceof c||i!==b&&typeof i==="number"&&(i>0&&a[0]&&a[i-1]||i===0||c.isArray(a)))for(;M<i;M++)e=g(a[M],M,d),e!=null&&(f[f.length]=e);else for(G in a)e=g(a[G],G,d),e!=null&&(f[f.length]=e);return f.concat.apply([],f)},guid:1,proxy:function(a,g){if(typeof g==="string")var d=a[g],g=a,a=d;if(!c.isFunction(a))return b;var e=ra.call(arguments,2),d=function(){return a.apply(g,
e.concat(ra.call(arguments)))};d.guid=a.guid=a.guid||d.guid||c.guid++;return d},access:function(a,g,d,e,G,f,M){var i,k=d==null,h=0,l=a.length;if(d&&typeof d==="object"){for(h in d)c.access(a,g,h,d[h],1,f,e);G=1}else if(e!==b){i=M===b&&c.isFunction(e);k&&(i?(i=g,g=function(a,g,b){return i.call(c(a),b)}):(g.call(a,e),g=null));if(g)for(;h<l;h++)g(a[h],d,i?e.call(a[h],h,g(a[h],d)):e,M);G=1}return G?a:k?g.call(a):l?g(a[0],d):f},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();
a=t.exec(a)||r.exec(a)||s.exec(a)||a.indexOf("compatible")<0&&F.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},sub:function(){function a(g,b){return new a.fn.init(g,b)}c.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(b,d){d&&d instanceof c&&!(d instanceof a)&&(d=a(d));return c.fn.init.call(this,b,d,g)};a.fn.init.prototype=a.fn;var g=a(u);return a},browser:{}});c.each("Boolean Number String Function Array Date RegExp Object".split(" "),
function(a,g){J["[object "+g+"]"]=g.toLowerCase()});A=c.uaMatch(A);if(A.browser)c.browser[A.browser]=!0,c.browser.version=A.version;if(c.browser.webkit)c.browser.safari=!0;h.test("\u00a0")&&(l=/^[\s\xA0]+/,p=/[\s\xA0]+$/);i=c(u);u.addEventListener?na=function(){u.removeEventListener("DOMContentLoaded",na,!1);c.ready()}:u.attachEvent&&(na=function(){u.readyState==="complete"&&(u.detachEvent("onreadystatechange",na),c.ready())});return c}();var Q={};a.Callbacks=function(g){var g=g?Q[g]||e(g):{},c=[],
d=[],f,i,k,h,l,p,j=function(b){var d,e,G,f;for(d=0,e=b.length;d<e;d++)G=b[d],f=a.type(G),f==="array"?j(G):f==="function"&&(!g.unique||!m.has(G))&&c.push(G)},n=function(a,b){b=b||[];f=!g.memory||[a,b];k=i=!0;p=h||0;h=0;for(l=c.length;c&&p<l;p++)if(c[p].apply(a,b)===!1&&g.stopOnFalse){f=!0;break}k=!1;c&&(g.once?f===!0?m.disable():c=[]:d&&d.length&&(f=d.shift(),m.fireWith(f[0],f[1])))},m={add:function(){if(c){var a=c.length;j(arguments);k?l=c.length:f&&f!==!0&&(h=a,n(f[0],f[1]))}return this},remove:function(){if(c)for(var a=
arguments,b=0,d=a.length;b<d;b++)for(var e=0;e<c.length;e++)if(a[b]===c[e]&&(k&&e<=l&&(l--,e<=p&&p--),c.splice(e--,1),g.unique))break;return this},has:function(a){if(c)for(var g=0,b=c.length;g<b;g++)if(a===c[g])return!0;return!1},empty:function(){c=[];return this},disable:function(){c=d=f=b;return this},disabled:function(){return!c},lock:function(){d=b;(!f||f===!0)&&m.disable();return this},locked:function(){return!d},fireWith:function(a,b){d&&(k?g.once||d.push([a,b]):(!g.once||!f)&&n(a,b));return this},
fire:function(){m.fireWith(this,arguments);return this},fired:function(){return!!i}};return m};var T=[].slice;a.extend({Deferred:function(g){var b=a.Callbacks("once memory"),c=a.Callbacks("once memory"),d=a.Callbacks("memory"),e="pending",f={resolve:b,reject:c,notify:d},i={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,g,b){k.done(a).fail(g).progress(b);return this},always:function(){k.done.apply(k,arguments).fail.apply(k,arguments);
return this},pipe:function(g,b,c){return a.Deferred(function(d){a.each({done:[g,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(g,b){var c=b[0],e=b[1],z;if(a.isFunction(c))k[g](function(){if((z=c.apply(this,arguments))&&a.isFunction(z.promise))z.promise().then(d.resolve,d.reject,d.notify);else d[e+"With"](this===k?d:this,[z])});else k[g](d[e])})}).promise()},promise:function(a){if(a==null)a=i;else for(var g in i)a[g]=i[g];return a}},k=i.promise({}),h;for(h in f)k[h]=f[h].fire,k[h+"With"]=
f[h].fireWith;k.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock);g&&g.call(k,k);return k},when:function(g){function b(a){return function(g){d[a]=arguments.length>1?T.call(arguments,0):g;--k||h.resolveWith(h,d)}}function c(a){return function(g){i[a]=arguments.length>1?T.call(arguments,0):g;h.notifyWith(l,i)}}var d=T.call(arguments,0),e=0,f=d.length,i=Array(f),k=f,h=f<=1&&g&&a.isFunction(g.promise)?g:a.Deferred(),l=h.promise();if(f>1){for(;e<f;e++)d[e]&&
d[e].promise&&a.isFunction(d[e].promise)?d[e].promise().then(b(e),h.reject,c(e)):--k;k||h.resolveWith(h,d)}else h!==g&&h.resolveWith(h,f?[g]:[]);return l}});a.support=function(){var g,b,c,e,f,i,k,h,l=u.createElement("div");l.setAttribute("className","t");l.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";b=l.getElementsByTagName("*");c=l.getElementsByTagName("a")[0];if(!b||!b.length||!c)return{};e=u.createElement("select");f=e.appendChild(u.createElement("option"));
b=l.getElementsByTagName("input")[0];g={leadingWhitespace:l.firstChild.nodeType===3,tbody:!l.getElementsByTagName("tbody").length,htmlSerialize:!!l.getElementsByTagName("link").length,style:/top/.test(c.getAttribute("style")),hrefNormalized:c.getAttribute("href")==="/a",opacity:/^0.55/.test(c.style.opacity),cssFloat:!!c.style.cssFloat,checkOn:b.value==="on",optSelected:f.selected,getSetAttribute:l.className!=="t",enctype:!!u.createElement("form").enctype,html5Clone:u.createElement("nav").cloneNode(!0).outerHTML!==
"<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0};a.boxModel=g.boxModel=u.compatMode==="CSS1Compat";b.checked=!0;g.noCloneChecked=b.cloneNode(!0).checked;e.disabled=!0;g.optDisabled=!f.disabled;try{delete l.test}catch(p){g.deleteExpando=!1}!l.addEventListener&&l.attachEvent&&l.fireEvent&&(l.attachEvent("onclick",function(){g.noCloneEvent=!1}),l.cloneNode(!0).fireEvent("onclick"));
b=u.createElement("input");b.value="t";b.setAttribute("type","radio");g.radioValue=b.value==="t";b.setAttribute("checked","checked");b.setAttribute("name","t");l.appendChild(b);c=u.createDocumentFragment();c.appendChild(l.lastChild);g.checkClone=c.cloneNode(!0).cloneNode(!0).lastChild.checked;g.appendChecked=b.checked;c.removeChild(b);c.appendChild(l);if(l.attachEvent)for(k in{submit:1,change:1,focusin:1})b="on"+k,h=b in l,h||(l.setAttribute(b,"return;"),h=typeof l[b]==="function"),g[k+"Bubbles"]=
h;c.removeChild(l);c=e=f=l=b=null;a(function(){var b,c,e,z,f=u.getElementsByTagName("body")[0];if(f){b=u.createElement("div");b.style.cssText="padding:0;margin:0;border:0;visibility:hidden;width:0;height:0;position:static;top:0;margin-top:1px";f.insertBefore(b,f.firstChild);l=u.createElement("div");b.appendChild(l);l.innerHTML="<table><tr><td style='padding:0;margin:0;border:0;display:none'></td><td>t</td></tr></table>";i=l.getElementsByTagName("td");h=i[0].offsetHeight===0;i[0].style.display="";
i[1].style.display="none";g.reliableHiddenOffsets=h&&i[0].offsetHeight===0;if(d.getComputedStyle)l.innerHTML="",c=u.createElement("div"),c.style.width="0",c.style.marginRight="0",l.style.width="2px",l.appendChild(c),g.reliableMarginRight=(parseInt((d.getComputedStyle(c,null)||{marginRight:0}).marginRight,10)||0)===0;if(typeof l.style.zoom!=="undefined")l.innerHTML="",l.style.width=l.style.padding="1px",l.style.border=0,l.style.overflow="hidden",l.style.display="inline",l.style.zoom=1,g.inlineBlockNeedsLayout=
l.offsetWidth===3,l.style.display="block",l.style.overflow="visible",l.innerHTML="<div style='width:5px;'></div>",g.shrinkWrapBlocks=l.offsetWidth!==3;l.style.cssText="position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:0;visibility:hidden;";l.innerHTML="<div style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;display:block;'><div style='padding:0;margin:0;border:0;display:block;overflow:hidden;'></div></div><table style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";
c=l.firstChild;e=c.firstChild;z={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:c.nextSibling.firstChild.firstChild.offsetTop===5};e.style.position="fixed";e.style.top="20px";z.fixedPosition=e.offsetTop===20||e.offsetTop===15;e.style.position=e.style.top="";c.style.overflow="hidden";c.style.position="relative";z.subtractsBorderForOverflowNotVisible=e.offsetTop===-5;z.doesNotIncludeMarginInBodyOffset=f.offsetTop!==1;if(d.getComputedStyle)l.style.marginTop="1%",g.pixelMargin=(d.getComputedStyle(l,
null)||{marginTop:0}).marginTop!=="1%";if(typeof b.style.zoom!=="undefined")b.style.zoom=1;f.removeChild(b);l=null;a.extend(g,z)}});return g}();var R=/^(?:\{.*\}|\[.*\])$/,H=/([A-Z])/g;a.extend({cache:{},uuid:0,expando:"jQuery"+(a.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(g){g=g.nodeType?a.cache[g[a.expando]]:g[a.expando];return!!g&&!f(g)},data:function(g,c,d,e){if(a.acceptData(g)){var f;f=a.expando;
var i=typeof c==="string",l=g.nodeType,k=l?a.cache:g,h=l?g[f]:g[f]&&f,p=c==="events";if(h&&k[h]&&(p||e||k[h].data)||!(i&&d===b)){h||(l?g[f]=h=++a.uuid:h=f);if(!k[h]&&(k[h]={},!l))k[h].toJSON=a.noop;if(typeof c==="object"||typeof c==="function")e?k[h]=a.extend(k[h],c):k[h].data=a.extend(k[h].data,c);f=g=k[h];if(!e){if(!g.data)g.data={};g=g.data}d!==b&&(g[a.camelCase(c)]=d);if(p&&!g[c])return f.events;i?(d=g[c],d==null&&(d=g[a.camelCase(c)])):d=g;return d}}},removeData:function(g,b,c){if(a.acceptData(g)){var d,
e,i,l=a.expando,k=g.nodeType,h=k?a.cache:g,p=k?g[l]:l;if(h[p]){if(b&&(d=c?h[p]:h[p].data)){a.isArray(b)||(b in d?b=[b]:(b=a.camelCase(b),b=b in d?[b]:b.split(" ")));for(e=0,i=b.length;e<i;e++)delete d[b[e]];if(!(c?f:a.isEmptyObject)(d))return}if(!c&&(delete h[p].data,!f(h[p])))return;a.support.deleteExpando||!h.setInterval?delete h[p]:h[p]=null;k&&(a.support.deleteExpando?delete g[l]:g.removeAttribute?g.removeAttribute(l):g[l]=null)}}},_data:function(g,b,c){return a.data(g,b,c,!0)},acceptData:function(g){if(g.nodeName){var b=
a.noData[g.nodeName.toLowerCase()];if(b)return!(b===!0||g.getAttribute("classid")!==b)}return!0}});a.fn.extend({data:function(g,c){var d,e,f,i,l,k=this[0],h=0,p=null;if(g===b){if(this.length&&(p=a.data(k),k.nodeType===1&&!a._data(k,"parsedAttrs"))){f=k.attributes;for(l=f.length;h<l;h++)i=f[h].name,i.indexOf("data-")===0&&(i=a.camelCase(i.substring(5)),j(k,i,p[i]));a._data(k,"parsedAttrs",!0)}return p}if(typeof g==="object")return this.each(function(){a.data(this,g)});d=g.split(".",2);d[1]=d[1]?"."+
d[1]:"";e=d[1]+"!";return a.access(this,function(c){if(c===b)return p=this.triggerHandler("getData"+e,[d[0]]),p===b&&k&&(p=a.data(k,g),p=j(k,g,p)),p===b&&d[1]?this.data(d[0]):p;d[1]=c;this.each(function(){var b=a(this);b.triggerHandler("setData"+e,d);a.data(this,g,c);b.triggerHandler("changeData"+e,d)})},null,c,arguments.length>1,null,!1)},removeData:function(g){return this.each(function(){a.removeData(this,g)})}});a.extend({_mark:function(g,b){g&&(b=(b||"fx")+"mark",a._data(g,b,(a._data(g,b)||0)+
1))},_unmark:function(g,b,d){g!==!0&&(d=b,b=g,g=!1);if(b){var d=d||"fx",e=d+"mark";(g=g?0:(a._data(b,e)||1)-1)?a._data(b,e,g):(a.removeData(b,e,!0),c(b,d,"mark"))}},queue:function(g,b,c){var d;if(g)return b=(b||"fx")+"queue",d=a._data(g,b),c&&(!d||a.isArray(c)?d=a._data(g,b,a.makeArray(c)):d.push(c)),d||[]},dequeue:function(g,b){var b=b||"fx",d=a.queue(g,b),e=d.shift(),f={};e==="inprogress"&&(e=d.shift());e&&(b==="fx"&&d.unshift("inprogress"),a._data(g,b+".run",f),e.call(g,function(){a.dequeue(g,
b)},f));d.length||(a.removeData(g,b+"queue "+b+".run",!0),c(g,b,"queue"))}});a.fn.extend({queue:function(g,c){var d=2;typeof g!=="string"&&(c=g,g="fx",d--);return arguments.length<d?a.queue(this[0],g):c===b?this:this.each(function(){var b=a.queue(this,g,c);g==="fx"&&b[0]!=="inprogress"&&a.dequeue(this,g)})},dequeue:function(g){return this.each(function(){a.dequeue(this,g)})},delay:function(g,b){g=a.fx?a.fx.speeds[g]||g:g;return this.queue(b||"fx",function(a,b){var c=setTimeout(a,g);b.stop=function(){clearTimeout(c)}})},
clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(g,c){function d(){--l||e.resolveWith(f,[f])}typeof g!=="string"&&(c=g,g=b);for(var g=g||"fx",e=a.Deferred(),f=this,i=f.length,l=1,k=g+"defer",h=g+"queue",p=g+"mark",j;i--;)if(j=a.data(f[i],k,b,!0)||(a.data(f[i],h,b,!0)||a.data(f[i],p,b,!0))&&a.data(f[i],k,a.Callbacks("once memory"),!0))l++,j.add(d);d();return e.promise(c)}});var U=/[\n\t\r]/g,W=/\s+/,N=/\r/g,E=/^(?:button|input)$/i,J=/^(?:button|input|object|select|textarea)$/i,
X=/^a(?:rea)?$/i,Y=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,y=a.support.getSetAttribute,F,A,ja;a.fn.extend({attr:function(g,b){return a.access(this,a.attr,g,b,arguments.length>1)},removeAttr:function(g){return this.each(function(){a.removeAttr(this,g)})},prop:function(g,b){return a.access(this,a.prop,g,b,arguments.length>1)},removeProp:function(g){g=a.propFix[g]||g;return this.each(function(){try{this[g]=b,delete this[g]}catch(a){}})},
addClass:function(g){var b,c,d,e,f,i,l;if(a.isFunction(g))return this.each(function(b){a(this).addClass(g.call(this,b,this.className))});if(g&&typeof g==="string"){b=g.split(W);for(c=0,d=this.length;c<d;c++)if(e=this[c],e.nodeType===1)if(!e.className&&b.length===1)e.className=g;else{f=" "+e.className+" ";for(i=0,l=b.length;i<l;i++)~f.indexOf(" "+b[i]+" ")||(f+=b[i]+" ");e.className=a.trim(f)}}return this},removeClass:function(g){var c,d,e,f,i,l,k;if(a.isFunction(g))return this.each(function(b){a(this).removeClass(g.call(this,
b,this.className))});if(g&&typeof g==="string"||g===b){c=(g||"").split(W);for(d=0,e=this.length;d<e;d++)if(f=this[d],f.nodeType===1&&f.className)if(g){i=(" "+f.className+" ").replace(U," ");for(l=0,k=c.length;l<k;l++)i=i.replace(" "+c[l]+" "," ");f.className=a.trim(i)}else f.className=""}return this},toggleClass:function(g,b){var c=typeof g,d=typeof b==="boolean";return a.isFunction(g)?this.each(function(c){a(this).toggleClass(g.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string")for(var e,
f=0,i=a(this),l=b,k=g.split(W);e=k[f++];)l=d?l:!i.hasClass(e),i[l?"addClass":"removeClass"](e);else if(c==="undefined"||c==="boolean")this.className&&a._data(this,"__className__",this.className),this.className=this.className||g===!1?"":a._data(this,"__className__")||""})},hasClass:function(a){for(var a=" "+a+" ",b=0,c=this.length;b<c;b++)if(this[b].nodeType===1&&(" "+this[b].className+" ").replace(U," ").indexOf(a)>-1)return!0;return!1},val:function(g){var c,d,e,f=this[0];if(arguments.length)return e=
a.isFunction(g),this.each(function(d){var f=a(this);if(this.nodeType===1&&(d=e?g.call(this,d,f.val()):g,d==null?d="":typeof d==="number"?d+="":a.isArray(d)&&(d=a.map(d,function(a){return a==null?"":a+""})),c=a.valHooks[this.type]||a.valHooks[this.nodeName.toLowerCase()],!c||!("set"in c)||c.set(this,d,"value")===b))this.value=d});else if(f){if((c=a.valHooks[f.type]||a.valHooks[f.nodeName.toLowerCase()])&&"get"in c&&(d=c.get(f,"value"))!==b)return d;d=f.value;return typeof d==="string"?d.replace(N,
""):d==null?"":d}}});a.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(g){var b,c,d=g.selectedIndex,e=[],f=g.options,i=g.type==="select-one";if(d<0)return null;g=i?d:0;for(c=i?d+1:f.length;g<c;g++)if(b=f[g],b.selected&&(a.support.optDisabled?!b.disabled:b.getAttribute("disabled")===null)&&(!b.parentNode.disabled||!a.nodeName(b.parentNode,"optgroup"))){b=a(b).val();if(i)return b;e.push(b)}return i&&!e.length&&f.length?a(f[d]).val():
e},set:function(g,b){var c=a.makeArray(b);a(g).find("option").each(function(){this.selected=a.inArray(a(this).val(),c)>=0});if(!c.length)g.selectedIndex=-1;return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(g,c,d,e){var f,i,l=g.nodeType;if(g&&!(l===3||l===8||l===2)){if(e&&c in a.attrFn)return a(g)[c](d);if(typeof g.getAttribute==="undefined")return a.prop(g,c,d);if(e=l!==1||!a.isXMLDoc(g))c=c.toLowerCase(),i=a.attrHooks[c]||(Y.test(c)?A:F);if(d!==
b)if(d===null)a.removeAttr(g,c);else return i&&"set"in i&&e&&(f=i.set(g,d,c))!==b?f:(g.setAttribute(c,""+d),d);else return i&&"get"in i&&e&&(f=i.get(g,c))!==null?f:(f=g.getAttribute(c),f===null?b:f)}},removeAttr:function(g,b){var c,d,e,f,i,l=0;if(b&&g.nodeType===1){d=b.toLowerCase().split(W);for(f=d.length;l<f;l++)if(e=d[l])c=a.propFix[e]||e,(i=Y.test(e))||a.attr(g,e,""),g.removeAttribute(y?e:c),i&&c in g&&(g[c]=!1)}},attrHooks:{type:{set:function(g,b){if(E.test(g.nodeName)&&g.parentNode)a.error("type property can't be changed");
else if(!a.support.radioValue&&b==="radio"&&a.nodeName(g,"input")){var c=g.value;g.setAttribute("type",b);if(c)g.value=c;return b}}},value:{get:function(g,b){return F&&a.nodeName(g,"button")?F.get(g,b):b in g?g.value:null},set:function(g,b,c){if(F&&a.nodeName(g,"button"))return F.set(g,b,c);g.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",
frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(g,c,d){var e,f,i=g.nodeType;if(g&&!(i===3||i===8||i===2)){if(i!==1||!a.isXMLDoc(g))c=a.propFix[c]||c,f=a.propHooks[c];return d!==b?f&&"set"in f&&(e=f.set(g,d,c))!==b?e:g[c]=d:f&&"get"in f&&(e=f.get(g,c))!==null?e:g[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):J.test(a.nodeName)||X.test(a.nodeName)&&a.href?0:b}}}});a.attrHooks.tabindex=a.propHooks.tabIndex;
A={get:function(g,c){var d,e=a.prop(g,c);return e===!0||typeof e!=="boolean"&&(d=g.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(g,b,c){b===!1?a.removeAttr(g,c):(b=a.propFix[c]||c,b in g&&(g[b]=!0),g.setAttribute(c,c.toLowerCase()));return c}};if(!y)ja={name:!0,id:!0,coords:!0},F=a.valHooks.button={get:function(a,c){var d;return(d=a.getAttributeNode(c))&&(ja[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,c){var d=a.getAttributeNode(c);d||(d=u.createAttribute(c),
a.setAttributeNode(d));return d.nodeValue=b+""}},a.attrHooks.tabindex.set=F.set,a.each(["width","height"],function(g,b){a.attrHooks[b]=a.extend(a.attrHooks[b],{set:function(a,g){if(g==="")return a.setAttribute(b,"auto"),g}})}),a.attrHooks.contenteditable={get:F.get,set:function(a,b,c){b===""&&(b="false");F.set(a,b,c)}};a.support.hrefNormalized||a.each(["href","src","width","height"],function(g,c){a.attrHooks[c]=a.extend(a.attrHooks[c],{get:function(a){a=a.getAttribute(c,2);return a===null?b:a}})});
if(!a.support.style)a.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}};if(!a.support.optSelected)a.propHooks.selected=a.extend(a.propHooks.selected,{get:function(){return null}});if(!a.support.enctype)a.propFix.enctype="encoding";a.support.checkOn||a.each(["radio","checkbox"],function(){a.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}});a.each(["radio","checkbox"],function(){a.valHooks[this]=
a.extend(a.valHooks[this],{set:function(g,b){if(a.isArray(b))return g.checked=a.inArray(a(g).val(),b)>=0}})});var da=/^(?:textarea|input|select)$/i,ba=/^([^\.]*)?(?:\.(.+))?$/,Wa=/(?:^|\s)hover(\.\S+)?\b/,eb=/^key/,fb=/^(?:mouse|contextmenu)|click/,Ha=/^(?:focusinfocus|focusoutblur)$/,gb=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,hb=function(a){if(a=gb.exec(a))a[1]=(a[1]||"").toLowerCase(),a[3]=a[3]&&RegExp("(?:^|\\s)"+a[3]+"(?:\\s|$)");return a},Ia=function(b){return a.event.special.hover?b:b.replace(Wa,
"mouseenter$1 mouseleave$1")};a.event={add:function(g,c,d,e,f){var i,l,k,h,p,j,n,m,q;if(!(g.nodeType===3||g.nodeType===8||!c||!d||!(i=a._data(g)))){if(d.handler)n=d,d=n.handler,f=n.selector;if(!d.guid)d.guid=a.guid++;k=i.events;if(!k)i.events=k={};l=i.handle;if(!l)i.handle=l=function(g){return typeof a!=="undefined"&&(!g||a.event.triggered!==g.type)?a.event.dispatch.apply(l.elem,arguments):b},l.elem=g;c=a.trim(Ia(c)).split(" ");for(i=0;i<c.length;i++){h=ba.exec(c[i])||[];p=h[1];j=(h[2]||"").split(".").sort();
q=a.event.special[p]||{};p=(f?q.delegateType:q.bindType)||p;q=a.event.special[p]||{};h=a.extend({type:p,origType:h[1],data:e,handler:d,guid:d.guid,selector:f,quick:f&&hb(f),namespace:j.join(".")},n);m=k[p];if(!m&&(m=k[p]=[],m.delegateCount=0,!q.setup||q.setup.call(g,e,j,l)===!1))g.addEventListener?g.addEventListener(p,l,!1):g.attachEvent&&g.attachEvent("on"+p,l);if(q.add&&(q.add.call(g,h),!h.handler.guid))h.handler.guid=d.guid;f?m.splice(m.delegateCount++,0,h):m.push(h);a.event.global[p]=!0}g=null}},
global:{},remove:function(b,c,d,e,f){var i=a.hasData(b)&&a._data(b),l,k,h,p,j,n,m,q,v,t;if(i&&(m=i.events)){c=a.trim(Ia(c||"")).split(" ");for(l=0;l<c.length;l++)if(k=ba.exec(c[l])||[],h=p=k[1],k=k[2],h){q=a.event.special[h]||{};h=(e?q.delegateType:q.bindType)||h;v=m[h]||[];j=v.length;k=k?RegExp("(^|\\.)"+k.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<v.length;n++)if(t=v[n],(f||p===t.origType)&&(!d||d.guid===t.guid)&&(!k||k.test(t.namespace))&&(!e||e===t.selector||e==="**"&&t.selector))v.splice(n--,
1),t.selector&&v.delegateCount--,q.remove&&q.remove.call(b,t);v.length===0&&j!==v.length&&((!q.teardown||q.teardown.call(b,k)===!1)&&a.removeEvent(b,h,i.handle),delete m[h])}else for(h in m)a.event.remove(b,h+c[l],d,e,!0);if(a.isEmptyObject(m)){if(c=i.handle)c.elem=null;a.removeData(b,["events","handle"],!0)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(g,c,e,f){if(!e||!(e.nodeType===3||e.nodeType===8)){var i=g.type||g,l=[],k,h,p,j,n;if(!Ha.test(i+a.event.triggered)&&(i.indexOf("!")>=
0&&(i=i.slice(0,-1),k=!0),i.indexOf(".")>=0&&(l=i.split("."),i=l.shift(),l.sort()),e&&!a.event.customEvent[i]||a.event.global[i]))if(g=typeof g==="object"?g[a.expando]?g:new a.Event(i,g):new a.Event(i),g.type=i,g.isTrigger=!0,g.exclusive=k,g.namespace=l.join("."),g.namespace_re=g.namespace?RegExp("(^|\\.)"+l.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,k=i.indexOf(":")<0?"on"+i:"",e){g.result=b;if(!g.target)g.target=e;c=c!=null?a.makeArray(c):[];c.unshift(g);p=a.event.special[i]||{};if(!(p.trigger&&p.trigger.apply(e,
c)===!1)){n=[[e,p.bindType||i]];if(!f&&!p.noBubble&&!a.isWindow(e)){j=p.delegateType||i;l=Ha.test(j+i)?e:e.parentNode;for(h=null;l;l=l.parentNode)n.push([l,j]),h=l;h&&h===e.ownerDocument&&n.push([h.defaultView||h.parentWindow||d,j])}for(h=0;h<n.length&&!g.isPropagationStopped();h++)l=n[h][0],g.type=n[h][1],(j=(a._data(l,"events")||{})[g.type]&&a._data(l,"handle"))&&j.apply(l,c),(j=k&&l[k])&&a.acceptData(l)&&j.apply(l,c)===!1&&g.preventDefault();g.type=i;if(!f&&!g.isDefaultPrevented()&&(!p._default||
p._default.apply(e.ownerDocument,c)===!1)&&!(i==="click"&&a.nodeName(e,"a"))&&a.acceptData(e))if(k&&e[i]&&(i!=="focus"&&i!=="blur"||g.target.offsetWidth!==0)&&!a.isWindow(e))(h=e[k])&&(e[k]=null),a.event.triggered=i,e[i](),a.event.triggered=b,h&&(e[k]=h);return g.result}}else for(h in e=a.cache,e)e[h].events&&e[h].events[i]&&a.event.trigger(g,c,e[h].handle.elem,!0)}},dispatch:function(g){var g=a.event.fix(g||d.event),c=(a._data(this,"events")||{})[g.type]||[],e=c.delegateCount,f=[].slice.call(arguments,
0),i=!g.exclusive&&!g.namespace,l=a.event.special[g.type]||{},k=[],h,p,j,n,m,q,v;f[0]=g;g.delegateTarget=this;if(!(l.preDispatch&&l.preDispatch.call(this,g)===!1)){if(e&&!(g.button&&g.type==="click")){j=a(this);j.context=this.ownerDocument||this;for(p=g.target;p!=this;p=p.parentNode||this)if(p.disabled!==!0){m={};q=[];j[0]=p;for(h=0;h<e;h++){n=c[h];v=n.selector;if(m[v]===b){var t=m,r=v,s;if(n.quick){s=n.quick;var F=p.attributes||{};s=(!s[1]||p.nodeName.toLowerCase()===s[1])&&(!s[2]||(F.id||{}).value===
s[2])&&(!s[3]||s[3].test((F["class"]||{}).value))}else s=j.is(v);t[r]=s}m[v]&&q.push(n)}q.length&&k.push({elem:p,matches:q})}}c.length>e&&k.push({elem:this,matches:c.slice(e)});for(h=0;h<k.length&&!g.isPropagationStopped();h++){e=k[h];g.currentTarget=e.elem;for(c=0;c<e.matches.length&&!g.isImmediatePropagationStopped();c++)if(n=e.matches[c],i||!g.namespace&&!n.namespace||g.namespace_re&&g.namespace_re.test(n.namespace))if(g.data=n.data,g.handleObj=n,n=((a.event.special[n.origType]||{}).handle||n.handler).apply(e.elem,
f),n!==b)g.result=n,n===!1&&(g.preventDefault(),g.stopPropagation())}l.postDispatch&&l.postDispatch.call(this,g);return g.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){if(a.which==null)a.which=b.charCode!=null?b.charCode:b.keyCode;return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(a,c){var d,e,f=c.button,i=c.fromElement;if(a.pageX==null&&c.clientX!=null)d=a.target.ownerDocument||u,e=d.documentElement,d=d.body,a.pageX=c.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||d&&d.clientLeft||0),a.pageY=c.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||d&&d.clientTop||0);if(!a.relatedTarget&&i)a.relatedTarget=i===a.target?c.toElement:i;if(!a.which&&f!==b)a.which=f&1?1:f&2?3:f&4?2:0;return a}},fix:function(g){if(g[a.expando])return g;var c,
d,e=g,f=a.event.fixHooks[g.type]||{},i=f.props?this.props.concat(f.props):this.props,g=a.Event(e);for(c=i.length;c;)d=i[--c],g[d]=e[d];if(!g.target)g.target=e.srcElement||u;if(g.target.nodeType===3)g.target=g.target.parentNode;if(g.metaKey===b)g.metaKey=g.ctrlKey;return f.filter?f.filter(g,e):g},special:{ready:{setup:a.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(b,c,d){if(a.isWindow(this))this.onbeforeunload=d},teardown:function(a,
b){if(this.onbeforeunload===b)this.onbeforeunload=null}}},simulate:function(b,c,d,e){b=a.extend(new a.Event,d,{type:b,isSimulated:!0,originalEvent:{}});e?a.event.trigger(b,null,c):a.event.dispatch.call(c,b);b.isDefaultPrevented()&&d.preventDefault()}};a.event.handle=a.event.dispatch;a.removeEvent=u.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)};a.Event=function(b,c){if(!(this instanceof a.Event))return new a.Event(b,
c);b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||b.returnValue===!1||b.getPreventDefault&&b.getPreventDefault()?n:k):this.type=b;c&&a.extend(this,c);this.timeStamp=b&&b.timeStamp||a.now();this[a.expando]=!0};a.Event.prototype={preventDefault:function(){this.isDefaultPrevented=n;var a=this.originalEvent;if(a)a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=n;var a=this.originalEvent;if(a)a.stopPropagation&&
a.stopPropagation(),a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=n;this.stopPropagation()},isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k};a.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(b,c){a.event.special[b]={delegateType:c,bindType:c,handle:function(b){var g=b.relatedTarget,d=b.handleObj,e;if(!g||g!==this&&!a.contains(this,g))b.type=d.origType,e=d.handler.apply(this,arguments),b.type=c;return e}}});if(!a.support.submitBubbles)a.event.special.submit=
{setup:function(){if(a.nodeName(this,"form"))return!1;a.event.add(this,"click._submit keypress._submit",function(c){c=c.target;if((c=a.nodeName(c,"input")||a.nodeName(c,"button")?c.form:b)&&!c._submit_attached)a.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),c._submit_attached=!0})},postDispatch:function(b){b._submit_bubble&&(delete b._submit_bubble,this.parentNode&&!b.isTrigger&&a.event.simulate("submit",this.parentNode,b,!0))},teardown:function(){if(a.nodeName(this,"form"))return!1;
a.event.remove(this,"._submit")}};if(!a.support.changeBubbles)a.event.special.change={setup:function(){if(da.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")a.event.add(this,"propertychange._change",function(a){if(a.originalEvent.propertyName==="checked")this._just_changed=!0}),a.event.add(this,"click._change",function(b){if(this._just_changed&&!b.isTrigger)this._just_changed=!1,a.event.simulate("change",this,b,!0)});return!1}a.event.add(this,"beforeactivate._change",function(b){b=
b.target;if(da.test(b.nodeName)&&!b._change_attached)a.event.add(b,"change._change",function(b){this.parentNode&&!b.isSimulated&&!b.isTrigger&&a.event.simulate("change",this.parentNode,b,!0)}),b._change_attached=!0})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){a.event.remove(this,"._change");return da.test(this.nodeName)}};a.support.focusinBubbles||a.each({focus:"focusin",
blur:"focusout"},function(b,c){var d=0,e=function(b){a.event.simulate(c,b.target,a.event.fix(b),!0)};a.event.special[c]={setup:function(){d++===0&&u.addEventListener(b,e,!0)},teardown:function(){--d===0&&u.removeEventListener(b,e,!0)}}});a.fn.extend({on:function(c,d,e,f,i){var l,h;if(typeof c==="object"){typeof d!=="string"&&(e=e||d,d=b);for(h in c)this.on(h,d,e,c[h],i);return this}e==null&&f==null?(f=d,e=d=b):f==null&&(typeof d==="string"?(f=e,e=b):(f=e,e=d,d=b));if(f===!1)f=k;else if(!f)return this;
if(i===1)l=f,f=function(b){a().off(b);return l.apply(this,arguments)},f.guid=l.guid||(l.guid=a.guid++);return this.each(function(){a.event.add(this,c,f,e,d)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(c,d,e){if(c&&c.preventDefault&&c.handleObj){var f=c.handleObj;a(c.delegateTarget).off(f.namespace?f.origType+"."+f.namespace:f.origType,f.selector,f.handler);return this}if(typeof c==="object"){for(f in c)this.off(f,d,c[f]);return this}if(d===!1||typeof d==="function")e=d,d=b;e===
!1&&(e=k);return this.each(function(){a.event.remove(this,c,e,d)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(b,c,d){a(this.context).on(b,this.selector,c,d);return this},die:function(b,c){a(this.context).off(b,this.selector||"**",c);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(b,c){return this.each(function(){a.event.trigger(b,
c,this)})},triggerHandler:function(b,c){if(this[0])return a.event.trigger(b,c,this[0],!0)},toggle:function(b){var c=arguments,d=b.guid||a.guid++,e=0,f=function(d){var f=(a._data(this,"lastToggle"+b.guid)||0)%e;a._data(this,"lastToggle"+b.guid,f+1);d.preventDefault();return c[f].apply(this,arguments)||!1};for(f.guid=d;e<c.length;)c[e++].guid=d;return this.click(f)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});a.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu touchstart touchend touchmove".split(" "),
function(b,c){a.fn[c]=function(a,b){b==null&&(b=a,a=null);return arguments.length>0?this.on(c,null,a,b):this.trigger(c)};a.attrFn&&(a.attrFn[c]=!0);if(eb.test(c))a.event.fixHooks[c]=a.event.keyHooks;if(fb.test(c))a.event.fixHooks[c]=a.event.mouseHooks});(function(){function c(a,b,g,d,e,i){for(var e=0,l=d.length;e<l;e++){var h=d[e];if(h){for(var k=!1,h=h[a];h;){if(h[f]===g){k=d[h.sizset];break}if(h.nodeType===1&&!i)h[f]=g,h.sizset=e;if(h.nodeName.toLowerCase()===b){k=h;break}h=h[a]}d[e]=k}}}function d(a,
b,c,g,e,i){for(var e=0,l=g.length;e<l;e++){var h=g[e];if(h){for(var k=!1,h=h[a];h;){if(h[f]===c){k=g[h.sizset];break}if(h.nodeType===1){if(!i)h[f]=c,h.sizset=e;if(typeof b!=="string"){if(h===b){k=!0;break}}else if(m.filter(b,[h]).length>0){k=h;break}}h=h[a]}g[e]=k}}}var e=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,f="sizcache"+(Math.random()+"").replace(".",""),i=0,l=Object.prototype.toString,h=!1,k=!0,p=/\\/g,
n=/\r\n/g,j=/\W/;[0,0].sort(function(){k=!1;return 0});var m=function(a,b,c,g){var c=c||[],d=b=b||u;if(b.nodeType!==1&&b.nodeType!==9)return[];if(!a||typeof a!=="string")return c;var f,i,h,k,p,n=!0,j=m.isXML(b),z=[],M=a;do if(e.exec(""),f=e.exec(M))if(M=f[3],z.push(f[1]),f[2]){k=f[3];break}while(f);if(z.length>1&&t.exec(a))if(z.length===2&&v.relative[z[0]])i=K(z[0]+z[1],b,g);else for(i=v.relative[z[0]]?[b]:m(z.shift(),b);z.length;)a=z.shift(),v.relative[a]&&(a+=z.shift()),i=K(a,i,g);else if(!g&&z.length>
1&&b.nodeType===9&&!j&&v.match.ID.test(z[0])&&!v.match.ID.test(z[z.length-1])&&(f=m.find(z.shift(),b,j),b=f.expr?m.filter(f.expr,f.set)[0]:f.set[0]),b){f=g?{expr:z.pop(),set:F(g)}:m.find(z.pop(),z.length===1&&(z[0]==="~"||z[0]==="+")&&b.parentNode?b.parentNode:b,j);i=f.expr?m.filter(f.expr,f.set):f.set;for(z.length>0?h=F(i):n=!1;z.length;)f=p=z.pop(),v.relative[p]?f=z.pop():p="",f==null&&(f=b),v.relative[p](h,f,j)}else h=[];h||(h=i);h||m.error(p||a);if(l.call(h)==="[object Array]")if(n)if(b&&b.nodeType===
1)for(a=0;h[a]!=null;a++)h[a]&&(h[a]===!0||h[a].nodeType===1&&m.contains(b,h[a]))&&c.push(i[a]);else for(a=0;h[a]!=null;a++)h[a]&&h[a].nodeType===1&&c.push(i[a]);else c.push.apply(c,h);else F(h,c);k&&(m(k,d,c,g),m.uniqueSort(c));return c};m.uniqueSort=function(a){if(x&&(h=k,a.sort(x),h))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a};m.matches=function(a,b){return m(a,null,null,b)};m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0};m.find=function(a,b,c){var g,
d,e,f,i,h;if(!a)return[];for(d=0,e=v.order.length;d<e;d++)if(i=v.order[d],f=v.leftMatch[i].exec(a))if(h=f[1],f.splice(1,1),h.substr(h.length-1)!=="\\"&&(f[1]=(f[1]||"").replace(p,""),g=v.find[i](f,b,c),g!=null)){a=a.replace(v.match[i],"");break}g||(g=typeof b.getElementsByTagName!=="undefined"?b.getElementsByTagName("*"):[]);return{set:g,expr:a}};m.filter=function(a,c,g,d){for(var e,f,i,h,l,k,p,n,z=a,j=[],M=c,G=c&&c[0]&&m.isXML(c[0]);a&&c.length;){for(i in v.filter)if((e=v.leftMatch[i].exec(a))!=
null&&e[2])if(k=v.filter[i],l=e[1],f=!1,e.splice(1,1),l.substr(l.length-1)!=="\\"){M===j&&(j=[]);if(v.preFilter[i])if(e=v.preFilter[i](e,M,g,j,d,G)){if(e===!0)continue}else f=h=!0;if(e)for(p=0;(l=M[p])!=null;p++)l&&(h=k(l,e,p,M),n=d^h,g&&h!=null?n?f=!0:M[p]=!1:n&&(j.push(l),f=!0));if(h!==b){g||(M=j);a=a.replace(v.match[i],"");if(!f)return[];break}}if(a===z)if(f==null)m.error(a);else break;z=a}return M};m.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};var q=m.getText=
function(a){var b,c;b=a.nodeType;var g="";if(b)if(b===1||b===9||b===11)if(typeof a.textContent==="string")return a.textContent;else if(typeof a.innerText==="string")return a.innerText.replace(n,"");else for(a=a.firstChild;a;a=a.nextSibling)g+=q(a);else{if(b===3||b===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(g+=q(c));return g},v=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,
ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},
type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b==="string",g=c&&!j.test(b),c=c&&!g;g&&(b=b.toLowerCase());for(var g=0,d=a.length,e;g<d;g++)if(e=a[g]){for(;(e=e.previousSibling)&&e.nodeType!==1;);a[g]=c||e&&e.nodeName.toLowerCase()===b?e||!1:e===b}c&&m.filter(b,a,!0)},">":function(a,b){var c,g=typeof b==="string",d=0,e=a.length;if(g&&!j.test(b))for(b=b.toLowerCase();d<e;d++){if(c=a[d])c=c.parentNode,a[d]=c.nodeName.toLowerCase()===b?c:!1}else{for(;d<e;d++)(c=
a[d])&&(a[d]=g?c.parentNode:c.parentNode===b);g&&m.filter(b,a,!0)}},"":function(a,b,e){var f,h=i++,l=d;typeof b==="string"&&!j.test(b)&&(f=b=b.toLowerCase(),l=c);l("parentNode",b,h,a,f,e)},"~":function(a,b,e){var f,h=i++,l=d;typeof b==="string"&&!j.test(b)&&(f=b=b.toLowerCase(),l=c);l("previousSibling",b,h,a,f,e)}},find:{ID:function(a,b,c){if(typeof b.getElementById!=="undefined"&&!c)return(a=b.getElementById(a[1]))&&a.parentNode?[a]:[]},NAME:function(a,b){if(typeof b.getElementsByName!=="undefined"){for(var c=
[],g=b.getElementsByName(a[1]),d=0,e=g.length;d<e;d++)g[d].getAttribute("name")===a[1]&&c.push(g[d]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!=="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,g,d,e){a=" "+a[1].replace(p,"")+" ";if(e)return a;for(var e=0,f;(f=b[e])!=null;e++)f&&(d^(f.className&&(" "+f.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||g.push(f):c&&(b[e]=!1));return!1},ID:function(a){return a[1].replace(p,
"")},TAG:function(a){return a[1].replace(p,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]);a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=i++;return a},ATTR:function(a,b,c,g,d,e){b=a[1]=a[1].replace(p,"");!e&&v.attrMap[b]&&(a[1]=v.attrMap[b]);a[4]=(a[4]||a[5]||"").replace(p,"");a[2]==="~="&&(a[4]=" "+a[4]+
" ");return a},PSEUDO:function(a,b,c,g,d){if(a[1]==="not")if((e.exec(a[3])||"").length>1||/^\w/.test(a[3]))a[3]=m(a[3],null,null,b);else return a=m.filter(a[3],b,c,1^d),c||g.push.apply(g,a),!1;else if(v.match.POS.test(a[0])||v.match.CHILD.test(a[0]))return!0;return a},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.selected===
!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()===
"input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},
focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,g){return b===g.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,g){var d=b[1],e=v.filters[d];if(e)return e(a,c,b,g);else if(d==="contains")return(a.textContent||a.innerText||
q([a])||"").indexOf(b[3])>=0;else if(d==="not"){b=b[3];c=0;for(g=b.length;c<g;c++)if(b[c]===a)return!1;return!0}else m.error(d)},CHILD:function(a,b){var c,g,d,e,i,h;c=b[1];h=a;switch(c){case "only":case "first":for(;h=h.previousSibling;)if(h.nodeType===1)return!1;if(c==="first")return!0;h=a;case "last":for(;h=h.nextSibling;)if(h.nodeType===1)return!1;return!0;case "nth":c=b[2];g=b[3];if(c===1&&g===0)return!0;d=b[0];if((e=a.parentNode)&&(e[f]!==d||!a.nodeIndex)){i=0;for(h=e.firstChild;h;h=h.nextSibling)if(h.nodeType===
1)h.nodeIndex=++i;e[f]=d}h=a.nodeIndex-g;return c===0?h===0:h%c===0&&h/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],c=m.attr?m.attr(a,c):v.attrHandle[c]?v.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),g=c+"",d=b[2],e=b[4];return c==null?d==="!=":!d&&m.attr?
c!=null:d==="="?g===e:d==="*="?g.indexOf(e)>=0:d==="~="?(" "+g+" ").indexOf(e)>=0:!e?g&&c!==!1:d==="!="?g!==e:d==="^="?g.indexOf(e)===0:d==="$="?g.substr(g.length-e.length)===e:d==="|="?g===e||g.substr(0,e.length+1)===e+"-":!1},POS:function(a,b,c,g){var d=v.setFilters[b[2]];if(d)return d(a,c,b,g)}}},t=v.match.POS,s=function(a,b){return"\\"+(b-0+1)},r;for(r in v.match)v.match[r]=RegExp(v.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),v.leftMatch[r]=RegExp(/(^(?:.|\r|\n)*?)/.source+v.match[r].source.replace(/\\(\d+)/g,
s));v.match.globalPOS=t;var F=function(a,b){a=Array.prototype.slice.call(a,0);return b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(u.documentElement.childNodes,0)}catch(C){F=function(a,b){var c=0,g=b||[];if(l.call(a)==="[object Array]")Array.prototype.push.apply(g,a);else if(typeof a.length==="number")for(var d=a.length;c<d;c++)g.push(a[c]);else for(;a[c];c++)g.push(a[c]);return g}}var x,A;u.documentElement.compareDocumentPosition?x=function(a,b){return a===b?(h=!0,0):!a.compareDocumentPosition||
!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(x=function(a,b){if(a===b)return h=!0,0;else if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,g,d=[],e=[];c=a.parentNode;g=b.parentNode;var f=c;if(c===g)return A(a,b);else if(c){if(!g)return 1}else return-1;for(;f;)d.unshift(f),f=f.parentNode;for(f=g;f;)e.unshift(f),f=f.parentNode;c=d.length;g=e.length;for(f=0;f<c&&f<g;f++)if(d[f]!==e[f])return A(d[f],e[f]);return f===c?A(a,e[f],
-1):A(d[f],b,1)},A=function(a,b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1});(function(){var a=u.createElement("div"),c="script"+(new Date).getTime(),g=u.documentElement;a.innerHTML="<a name='"+c+"'/>";g.insertBefore(a,g.firstChild);if(u.getElementById(c))v.find.ID=function(a,c,g){if(typeof c.getElementById!=="undefined"&&!g)return(c=c.getElementById(a[1]))?c.id===a[1]||typeof c.getAttributeNode!=="undefined"&&c.getAttributeNode("id").nodeValue===a[1]?
[c]:b:[]},v.filter.ID=function(a,b){var c=typeof a.getAttributeNode!=="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b};g.removeChild(a);g=a=null})();(function(){var a=u.createElement("div");a.appendChild(u.createComment(""));if(a.getElementsByTagName("*").length>0)v.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){for(var g=[],d=0;c[d];d++)c[d].nodeType===1&&g.push(c[d]);c=g}return c};a.innerHTML="<a href='#'></a>";if(a.firstChild&&typeof a.firstChild.getAttribute!==
"undefined"&&a.firstChild.getAttribute("href")!=="#")v.attrHandle.href=function(a){return a.getAttribute("href",2)};a=null})();u.querySelectorAll&&function(){var a=m,b=u.createElement("div");b.innerHTML="<p class='TEST'></p>";if(!(b.querySelectorAll&&b.querySelectorAll(".TEST").length===0)){m=function(b,c,g,d){c=c||u;if(!d&&!m.isXML(c)){var e=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(e&&(c.nodeType===1||c.nodeType===9))if(e[1])return F(c.getElementsByTagName(b),g);else if(e[2]&&v.find.CLASS&&
c.getElementsByClassName)return F(c.getElementsByClassName(e[2]),g);if(c.nodeType===9){if(b==="body"&&c.body)return F([c.body],g);else if(e&&e[3]){var f=c.getElementById(e[3]);if(f&&f.parentNode){if(f.id===e[3])return F([f],g)}else return F([],g)}try{return F(c.querySelectorAll(b),g)}catch(i){}}else if(c.nodeType===1&&c.nodeName.toLowerCase()!=="object"){var e=c,h=(f=c.getAttribute("id"))||"__sizzle__",l=c.parentNode,k=/^\s*[+~]/.test(b);f?h=h.replace(/'/g,"\\$&"):c.setAttribute("id",h);if(k&&l)c=
c.parentNode;try{if(!k||l)return F(c.querySelectorAll("[id='"+h+"'] "+b),g)}catch(p){}finally{f||e.removeAttribute("id")}}}return a(b,c,g,d)};for(var c in a)m[c]=a[c];b=null}}();(function(){var a=u.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(u.createElement("div"),"div"),g=!1;try{b.call(u.documentElement,"[test!='']:sizzle")}catch(d){g=!0}m.matchesSelector=function(a,d){d=d.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(g||
!v.match.PSEUDO.test(d)&&!/!=/.test(d)){var e=b.call(a,d);if(e||!c||a.document&&a.document.nodeType!==11)return e}}catch(f){}return m(d,null,null,[a]).length>0}}})();(function(){var a=u.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(a.getElementsByClassName&&a.getElementsByClassName("e").length!==0&&(a.lastChild.className="e",a.getElementsByClassName("e").length!==1))v.order.splice(1,0,"CLASS"),v.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!==
"undefined"&&!c)return b.getElementsByClassName(a[1])},a=null})();m.contains=u.documentElement.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:u.documentElement.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:function(){return!1};m.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":!1};var K=function(a,b,c){for(var g,d=[],e="",b=b.nodeType?[b]:b;g=v.match.PSEUDO.exec(a);)e+=g[0],a=a.replace(v.match.PSEUDO,"");
a=v.relative[a]?a+"*":a;g=0;for(var f=b.length;g<f;g++)m(a,b[g],d,c);return m.filter(e,d)};m.attr=a.attr;m.selectors.attrMap={};a.find=m;a.expr=m.selectors;a.expr[":"]=a.expr.filters;a.unique=m.uniqueSort;a.text=m.getText;a.isXMLDoc=m.isXML;a.contains=m.contains})();var ib=/Until$/,jb=/^(?:parents|prevUntil|prevAll)/,kb=/,/,lb=/^.[^:#\[\.,]*$/,mb=Array.prototype.slice,L=a.expr.match.globalPOS,db={children:!0,contents:!0,next:!0,prev:!0};a.fn.extend({find:function(b){var c=this,d,e;if(typeof b!=="string")return a(b).filter(function(){for(d=
0,e=c.length;d<e;d++)if(a.contains(c[d],this))return!0});var f=this.pushStack("","find",b),i,h,l;for(d=0,e=this.length;d<e;d++)if(i=f.length,a.find(b,this[d],f),d>0)for(h=i;h<f.length;h++)for(l=0;l<i;l++)if(f[l]===f[h]){f.splice(h--,1);break}return f},has:function(b){var c=a(b);return this.filter(function(){for(var b=0,g=c.length;b<g;b++)if(a.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(t(this,a,!1),"not",a)},filter:function(a){return this.pushStack(t(this,a,!0),"filter",
a)},is:function(b){return!!b&&(typeof b==="string"?L.test(b)?a(b,this.context).index(this[0])>=0:a.filter(b,this).length>0:this.filter(b).length>0)},closest:function(b,c){var d=[],e,f,i=this[0];if(a.isArray(b)){for(f=1;i&&i.ownerDocument&&i!==c;){for(e=0;e<b.length;e++)a(i).is(b[e])&&d.push({selector:b[e],elem:i,level:f});i=i.parentNode;f++}return d}var h=L.test(b)||typeof b!=="string"?a(b,c||this.context):0;for(e=0,f=this.length;e<f;e++)for(i=this[e];i;)if(h?h.index(i)>-1:a.find.matchesSelector(i,
b)){d.push(i);break}else if(i=i.parentNode,!i||!i.ownerDocument||i===c||i.nodeType===11)break;d=d.length>1?a.unique(d):d;return this.pushStack(d,"closest",b)},index:function(b){return!b?this[0]&&this[0].parentNode?this.prevAll().length:-1:typeof b==="string"?a.inArray(this[0],a(b)):a.inArray(b.jquery?b[0]:b,this)},add:function(b,c){var d=typeof b==="string"?a(b,c):a.makeArray(b&&b.nodeType?[b]:b),e=a.merge(this.get(),d);return this.pushStack(!d[0]||!d[0].parentNode||d[0].parentNode.nodeType===11||
!e[0]||!e[0].parentNode||e[0].parentNode.nodeType===11?e:a.unique(e))},andSelf:function(){return this.add(this.prevObject)}});a.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(b){return a.dir(b,"parentNode")},parentsUntil:function(b,c,d){return a.dir(b,"parentNode",d)},next:function(b){return a.nth(b,2,"nextSibling")},prev:function(b){return a.nth(b,2,"previousSibling")},nextAll:function(b){return a.dir(b,"nextSibling")},prevAll:function(b){return a.dir(b,
"previousSibling")},nextUntil:function(b,c,d){return a.dir(b,"nextSibling",d)},prevUntil:function(b,c,d){return a.dir(b,"previousSibling",d)},siblings:function(b){return a.sibling((b.parentNode||{}).firstChild,b)},children:function(b){return a.sibling(b.firstChild)},contents:function(b){return a.nodeName(b,"iframe")?b.contentDocument||b.contentWindow.document:a.makeArray(b.childNodes)}},function(b,c){a.fn[b]=function(d,e){var f=a.map(this,c,d);ib.test(b)||(e=d);e&&typeof e==="string"&&(f=a.filter(e,
f));f=this.length>1&&!db[b]?a.unique(f):f;if((this.length>1||kb.test(e))&&jb.test(b))f=f.reverse();return this.pushStack(f,b,mb.call(arguments).join(","))}});a.extend({filter:function(b,c,d){d&&(b=":not("+b+")");return c.length===1?a.find.matchesSelector(c[0],b)?[c[0]]:[]:a.find.matches(b,c)},dir:function(c,d,e){for(var f=[],c=c[d];c&&c.nodeType!==9&&(e===b||c.nodeType!==1||!a(c).is(e));)c.nodeType===1&&f.push(c),c=c[d];return f},nth:function(a,b,c){for(var b=b||1,d=0;a;a=a[c])if(a.nodeType===1&&
++d===b)break;return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var Ja="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ca=/ jQuery\d+="(?:\d+|null)"/g,V=/^\s+/,Ka=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,sa=/<([\w:]+)/,Ba=/<tbody/i,fa=/<|&#?\w+;/,pa=/<(?:script|style)/i,qa=/<(?:script|object|embed|option|style)/i,
I=RegExp("<(?:"+Ja+")[\\s/>]","i"),ga=/checked\s*(?:[^=]|=\s*.checked.)/i,la=/\/(java|ecma)script/i,Xa=/^\s*<!(?:\[CDATA\[|\-\-)/,Z={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},ya=r(u);Z.optgroup=Z.option;Z.tbody=Z.tfoot=
Z.colgroup=Z.caption=Z.thead;Z.th=Z.td;if(!a.support.htmlSerialize)Z._default=[1,"div<div>","</div>"];a.fn.extend({text:function(c){return a.access(this,function(c){return c===b?a.text(this):this.empty().append((this[0]&&this[0].ownerDocument||u).createTextNode(c))},null,c,arguments.length)},wrapAll:function(b){if(a.isFunction(b))return this.each(function(c){a(this).wrapAll(b.call(this,c))});if(this[0]){var c=a(b,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&c.insertBefore(this[0]);c.map(function(){for(var a=
this;a.firstChild&&a.firstChild.nodeType===1;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(b){return a.isFunction(b)?this.each(function(c){a(this).wrapInner(b.call(this,c))}):this.each(function(){var c=a(this),d=c.contents();d.length?d.wrapAll(b):c.append(b)})},wrap:function(b){var c=a.isFunction(b);return this.each(function(d){a(this).wrapAll(c?b.call(this,d):b)})},unwrap:function(){return this.parent().each(function(){a.nodeName(this,"body")||a(this).replaceWith(this.childNodes)}).end()},
append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});else if(arguments.length){var b=a.clean(arguments);b.push.apply(b,this.toArray());return this.pushStack(b,"before",arguments)}},after:function(){if(this[0]&&
this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});else if(arguments.length){var b=this.pushStack(this,"after",arguments);b.push.apply(b,a.clean(arguments));return b}},remove:function(b,c){for(var d=0,e;(e=this[d])!=null;d++)if(!b||a.filter(b,[e]).length)!c&&e.nodeType===1&&(a.cleanData(e.getElementsByTagName("*")),a.cleanData([e])),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var b=0,c;(c=this[b])!=null;b++)for(c.nodeType===
1&&a.cleanData(c.getElementsByTagName("*"));c.firstChild;)c.removeChild(c.firstChild);return this},clone:function(b,c){b=b==null?!1:b;c=c==null?b:c;return this.map(function(){return a.clone(this,b,c)})},html:function(c){return a.access(this,function(c){var d=this[0]||{},e=0,g=this.length;if(c===b)return d.nodeType===1?d.innerHTML.replace(ca,""):null;if(typeof c==="string"&&!pa.test(c)&&(a.support.leadingWhitespace||!V.test(c))&&!Z[(sa.exec(c)||["",""])[1].toLowerCase()]){c=c.replace(Ka,"<$1></$2>");
try{for(;e<g;e++)if(d=this[e]||{},d.nodeType===1)a.cleanData(d.getElementsByTagName("*")),d.innerHTML=c;d=0}catch(f){}}d&&this.empty().append(c)},null,c,arguments.length)},replaceWith:function(b){if(this[0]&&this[0].parentNode){if(a.isFunction(b))return this.each(function(c){var d=a(this),e=d.html();d.replaceWith(b.call(this,c,e))});typeof b!=="string"&&(b=a(b).detach());return this.each(function(){var c=this.nextSibling,d=this.parentNode;a(this).remove();c?a(c).before(b):a(d).append(b)})}else return this.length?
this.pushStack(a(a.isFunction(b)?b():b),"replaceWith",b):this},detach:function(a){return this.remove(a,!0)},domManip:function(c,d,e){var f,i,h,l=c[0],k=[];if(!a.support.checkClone&&arguments.length===3&&typeof l==="string"&&ga.test(l))return this.each(function(){a(this).domManip(c,d,e,!0)});if(a.isFunction(l))return this.each(function(f){var i=a(this);c[0]=l.call(this,f,d?i.html():b);i.domManip(c,d,e)});if(this[0]){f=l&&l.parentNode;f=a.support.parentNode&&f&&f.nodeType===11&&f.childNodes.length===
this.length?{fragment:f}:a.buildFragment(c,this,k);h=f.fragment;if(i=h.childNodes.length===1?h=h.firstChild:h.firstChild){d=d&&a.nodeName(i,"tr");i=0;for(var p=this.length,n=p-1;i<p;i++)e.call(d?a.nodeName(this[i],"table")?this[i].getElementsByTagName("tbody")[0]||this[i].appendChild(this[i].ownerDocument.createElement("tbody")):this[i]:this[i],f.cacheable||p>1&&i<n?a.clone(h,!0,!0):h)}k.length&&a.each(k,function(b,c){c.src?a.ajax({type:"GET",global:!1,url:c.src,async:!1,dataType:"script"}):a.globalEval((c.text||
c.textContent||c.innerHTML||"").replace(Xa,"/*$0*/"));c.parentNode&&c.parentNode.removeChild(c)})}return this}});a.buildFragment=function(b,c,d){var e,f,i,h,l=b[0];c&&c[0]&&(h=c[0].ownerDocument||c[0]);h.createDocumentFragment||(h=u);if(b.length===1&&typeof l==="string"&&l.length<512&&h===u&&l.charAt(0)==="<"&&!qa.test(l)&&(a.support.checkClone||!ga.test(l))&&(a.support.html5Clone||!I.test(l)))f=!0,(i=a.fragments[l])&&i!==1&&(e=i);e||(e=h.createDocumentFragment(),a.clean(b,h,e,d));f&&(a.fragments[l]=
i?e:1);return{fragment:e,cacheable:f}};a.fragments={};a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){a.fn[b]=function(d){var e=[],d=a(d),f=this.length===1&&this[0].parentNode;if(f&&f.nodeType===11&&f.childNodes.length===1&&d.length===1)return d[c](this[0]),this;else{for(var f=0,i=d.length;f<i;f++){var h=(f>0?this.clone(!0):this).get();a(d[f])[c](h);e=e.concat(h)}return this.pushStack(e,b,d.selector)}}});a.extend({clone:function(b,
c,d){var e,f,i;a.support.html5Clone||a.isXMLDoc(b)||!I.test("<"+b.nodeName+">")?e=b.cloneNode(!0):(e=u.createElement("div"),ya.appendChild(e),e.innerHTML=b.outerHTML,e=e.firstChild);var h=e;if((!a.support.noCloneEvent||!a.support.noCloneChecked)&&(b.nodeType===1||b.nodeType===11)&&!a.isXMLDoc(b)){m(b,h);e=p(b);f=p(h);for(i=0;e[i];++i)f[i]&&m(e[i],f[i])}if(c&&(q(b,h),d)){e=p(b);f=p(h);for(i=0;e[i];++i)q(e[i],f[i])}return h},clean:function(b,c,d,e){var f,i=[],c=c||u;typeof c.createElement==="undefined"&&
(c=c.ownerDocument||c[0]&&c[0].ownerDocument||u);for(var l=0,k;(k=b[l])!=null;l++)if(typeof k==="number"&&(k+=""),k){if(typeof k==="string")if(fa.test(k)){k=k.replace(Ka,"<$1></$2>");f=(sa.exec(k)||["",""])[1].toLowerCase();var p=Z[f]||Z._default,n=p[0],j=c.createElement("div"),m=ya.childNodes;c===u?ya.appendChild(j):r(c).appendChild(j);for(j.innerHTML=p[1]+k+p[2];n--;)j=j.lastChild;if(!a.support.tbody){n=Ba.test(k);p=f==="table"&&!n?j.firstChild&&j.firstChild.childNodes:p[1]==="<table>"&&!n?j.childNodes:
[];for(f=p.length-1;f>=0;--f)a.nodeName(p[f],"tbody")&&!p[f].childNodes.length&&p[f].parentNode.removeChild(p[f])}!a.support.leadingWhitespace&&V.test(k)&&j.insertBefore(c.createTextNode(V.exec(k)[0]),j.firstChild);k=j.childNodes;j&&(j.parentNode.removeChild(j),m.length>0&&(j=m[m.length-1])&&j.parentNode&&j.parentNode.removeChild(j))}else k=c.createTextNode(k);var q;if(!a.support.appendChecked)if(k[0]&&typeof(q=k.length)==="number")for(f=0;f<q;f++)h(k[f]);else h(k);k.nodeType?i.push(k):i=a.merge(i,
k)}if(d){b=function(a){return!a.type||la.test(a.type)};for(l=0;i[l];l++)c=i[l],e&&a.nodeName(c,"script")&&(!c.type||la.test(c.type))?e.push(c.parentNode?c.parentNode.removeChild(c):c):(c.nodeType===1&&(k=a.grep(c.getElementsByTagName("script"),b),i.splice.apply(i,[l+1,0].concat(k))),d.appendChild(c))}return i},cleanData:function(b){for(var c,d,e=a.cache,f=a.event.special,i=a.support.deleteExpando,h=0,l;(l=b[h])!=null;h++)if(!l.nodeName||!a.noData[l.nodeName.toLowerCase()])if(d=l[a.expando]){if((c=
e[d])&&c.events){for(var k in c.events)f[k]?a.event.remove(l,k):a.removeEvent(l,k,c.handle);if(c.handle)c.handle.elem=null}i?delete l[a.expando]:l.removeAttribute&&l.removeAttribute(a.expando);delete e[d]}}});var za=/alpha\([^)]*\)/i,Ya=/opacity=([^)]*)/,Za=/([A-Z]|^ms)/g,$a=/^[\-+]?(?:\d*\.)?\d+$/i,Aa=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,ab=/^([\-+])=([\-+.\de]+)/,bb=/^margin/,cb={position:"absolute",visibility:"hidden",display:"block"},ea=["Top","Right","Bottom","Left"],ka,Ma,Na;a.fn.css=function(c,
d){return a.access(this,function(c,d,e){return e!==b?a.style(c,d,e):a.css(c,d)},c,d,arguments.length>1)};a.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=ka(a,"opacity");return c===""?"1":c}else return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":a.support.cssFloat?"cssFloat":"styleFloat"},style:function(c,d,e,f){if(c&&!(c.nodeType===3||c.nodeType===8||!c.style)){var i,h=a.camelCase(d),l=c.style,
k=a.cssHooks[h],d=a.cssProps[h]||h;if(e!==b){f=typeof e;if(f==="string"&&(i=ab.exec(e)))e=+(i[1]+1)*+i[2]+parseFloat(a.css(c,d)),f="number";if(!(e==null||f==="number"&&isNaN(e)))if(f==="number"&&!a.cssNumber[h]&&(e+="px"),!k||!("set"in k)||(e=k.set(c,e))!==b)try{l[d]=e}catch(p){}}else return k&&"get"in k&&(i=k.get(c,!1,f))!==b?i:l[d]}},css:function(c,d,e){var f,i,d=a.camelCase(d);i=a.cssHooks[d];d=a.cssProps[d]||d;d==="cssFloat"&&(d="float");if(i&&"get"in i&&(f=i.get(c,!0,e))!==b)return f;else if(ka)return ka(c,
d)},swap:function(a,b,c){var d={},e;for(e in b)d[e]=a.style[e],a.style[e]=b[e];c=c.call(a);for(e in b)a.style[e]=d[e];return c}});a.curCSS=a.css;u.defaultView&&u.defaultView.getComputedStyle&&(Ma=function(b,c){var d,e,f,i=b.style,c=c.replace(Za,"-$1").toLowerCase();if((e=b.ownerDocument.defaultView)&&(f=e.getComputedStyle(b,null)))d=f.getPropertyValue(c),d===""&&!a.contains(b.ownerDocument.documentElement,b)&&(d=a.style(b,c));if(!a.support.pixelMargin&&f&&bb.test(c)&&Aa.test(d))e=i.width,i.width=
d,d=f.width,i.width=e;return d});u.documentElement.currentStyle&&(Na=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;if(e==null&&f&&(c=f[b]))e=c;if(Aa.test(e)){c=f.left;if(d=a.runtimeStyle&&a.runtimeStyle.left)a.runtimeStyle.left=a.currentStyle.left;f.left=b==="fontSize"?"1em":e;e=f.pixelLeft+"px";f.left=c;if(d)a.runtimeStyle.left=d}return e===""?"auto":e});ka=Ma||Na;a.each(["height","width"],function(b,c){a.cssHooks[c]={get:function(b,d,e){if(d)return b.offsetWidth!==0?l(b,c,
e):a.swap(b,cb,function(){return l(b,c,e)})},set:function(a,b){return $a.test(b)?b+"px":b}}});if(!a.support.opacity)a.cssHooks.opacity={get:function(a,b){return Ya.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(b,c){var d=b.style,e=b.currentStyle,f=a.isNumeric(c)?"alpha(opacity="+c*100+")":"",i=e&&e.filter||d.filter||"";d.zoom=1;if(c>=1&&a.trim(i.replace(za,""))===""&&(d.removeAttribute("filter"),e&&!e.filter))return;d.filter=
za.test(i)?i.replace(za,f):i+" "+f}};a(function(){if(!a.support.reliableMarginRight)a.cssHooks.marginRight={get:function(b,c){return a.swap(b,{display:"inline-block"},function(){return c?ka(b,"margin-right"):b.style.marginRight})}}});if(a.expr&&a.expr.filters)a.expr.filters.hidden=function(b){var c=b.offsetHeight;return b.offsetWidth===0&&c===0||!a.support.reliableHiddenOffsets&&(b.style&&b.style.display||a.css(b,"display"))==="none"},a.expr.filters.visible=function(b){return!a.expr.filters.hidden(b)};
a.each({margin:"",padding:"",border:"Width"},function(b,c){a.cssHooks[b+c]={expand:function(a){for(var d=typeof a==="string"?a.split(" "):[a],e={},a=0;a<4;a++)e[b+ea[a]+c]=d[a]||d[a-2]||d[0];return e}}});var pb=/%20/g,nb=/\[\]$/,Oa=/\r?\n/g,qb=/#.*$/,rb=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,sb=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,tb=/^(?:GET|HEAD)$/,ub=/^\/\//,Pa=/\?/,vb=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,wb=
/^(?:select|textarea)/i,La=/\s+/,xb=/([?&])_=[^&]*/,Qa=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Ra=a.fn.load,Ca={},Sa={},ha,ia,Ta=["*/"]+["*"];try{ha=P.href}catch(Db){ha=u.createElement("a"),ha.href="",ha=ha.href}ia=Qa.exec(ha.toLowerCase())||[];a.fn.extend({load:function(c,d,e){if(typeof c!=="string"&&Ra)return Ra.apply(this,arguments);else if(!this.length)return this;var f=c.indexOf(" ");if(f>=0)var i=c.slice(f,c.length),c=c.slice(0,f);f="GET";d&&(a.isFunction(d)?(e=d,d=b):typeof d==="object"&&
(d=a.param(d,a.ajaxSettings.traditional),f="POST"));var h=this;a.ajax({url:c,type:f,dataType:"html",data:d,complete:function(b,c,d){d=b.responseText;b.isResolved()&&(b.done(function(a){d=a}),h.html(i?a("<div>").append(d.replace(vb,"")).find(i):d));e&&h.each(e,[d,c,b])}});return this},serialize:function(){return a.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?a.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&
(this.checked||wb.test(this.nodeName)||sb.test(this.type))}).map(function(b,c){var d=a(this).val();return d==null?null:a.isArray(d)?a.map(d,function(a){return{name:c.name,value:a.replace(Oa,"\r\n")}}):{name:c.name,value:d.replace(Oa,"\r\n")}}).get()}});a.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b,c){a.fn[c]=function(a){return this.on(c,a)}});a.each(["get","post"],function(c,d){a[d]=function(c,e,g,f){a.isFunction(e)&&(f=f||g,g=e,e=b);return a.ajax({type:d,
url:c,data:e,success:g,dataType:f})}});a.extend({getScript:function(c,d){return a.get(c,b,d,"script")},getJSON:function(b,c,d){return a.get(b,c,d,"json")},ajaxSetup:function(b,c){c?K(b,a.ajaxSettings):(c=b,b=a.ajaxSettings);K(b,c);return b},ajaxSettings:{url:ha,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(ia[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",
text:"text/plain",json:"application/json, text/javascript","*":Ta},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":d.String,"text html":!0,"text json":a.parseJSON,"text xml":a.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:v(Ca),ajaxTransport:v(Sa),ajax:function(c,d){function e(c,d,g,n){if(F!==2){F=2;s&&clearTimeout(s);t=b;q=n||"";A.readyState=c>0?4:0;var m,v,r,n=d;if(g){var z=f,u=A,C=z.contents,G=z.dataTypes,K=z.responseFields,
B,w,J,ja;for(w in K)w in g&&(u[K[w]]=g[w]);for(;G[0]==="*";)G.shift(),B===b&&(B=z.mimeType||u.getResponseHeader("content-type"));if(B)for(w in C)if(C[w]&&C[w].test(B)){G.unshift(w);break}if(G[0]in g)J=G[0];else{for(w in g){if(!G[0]||z.converters[w+" "+G[0]]){J=w;break}ja||(ja=w)}J=J||ja}J?(J!==G[0]&&G.unshift(J),g=g[J]):g=void 0}else g=b;if(c>=200&&c<300||c===304){if(f.ifModified){if(B=A.getResponseHeader("Last-Modified"))a.lastModified[j]=B;if(B=A.getResponseHeader("Etag"))a.etag[j]=B}if(c===304)n=
"notmodified",m=!0;else try{B=f;B.dataFilter&&(g=B.dataFilter(g,B.dataType));var S=B.dataTypes;w={};var H,D,y=S.length,da,O=S[0],ba,T,R,N,E;for(H=1;H<y;H++){if(H===1)for(D in B.converters)typeof D==="string"&&(w[D.toLowerCase()]=B.converters[D]);ba=O;O=S[H];if(O==="*")O=ba;else if(ba!=="*"&&ba!==O){T=ba+" "+O;R=w[T]||w["* "+O];if(!R)for(N in E=b,w)if(da=N.split(" "),da[0]===ba||da[0]==="*")if(E=w[da[1]+" "+O]){N=w[N];N===!0?R=E:E===!0&&(R=N);break}!R&&!E&&a.error("No conversion from "+T.replace(" ",
" to "));R!==!0&&(g=R?R(g):E(N(g)))}}v=g;n="success";m=!0}catch(U){n="parsererror",r=U}}else if(r=n,!n||c)n="error",c<0&&(c=0);A.status=c;A.statusText=""+(d||n);m?l.resolveWith(i,[v,n,A]):l.rejectWith(i,[A,n,r]);A.statusCode(p);p=b;x&&h.trigger("ajax"+(m?"Success":"Error"),[A,f,m?v:r]);k.fireWith(i,[A,n]);x&&(h.trigger("ajaxComplete",[A,f]),--a.active||a.event.trigger("ajaxStop"))}}typeof c==="object"&&(d=c,c=b);var d=d||{},f=a.ajaxSetup({},d),i=f.context||f,h=i!==f&&(i.nodeType||i instanceof a)?
a(i):a.event,l=a.Deferred(),k=a.Callbacks("once memory"),p=f.statusCode||{},j,n={},m={},q,v,t,s,r,F=0,x,u,A={readyState:0,setRequestHeader:function(a,b){if(!F){var c=a.toLowerCase(),a=m[c]=m[c]||a;n[a]=b}return this},getAllResponseHeaders:function(){return F===2?q:null},getResponseHeader:function(a){var c;if(F===2){if(!v)for(v={};c=rb.exec(q);)v[c[1].toLowerCase()]=c[2];c=v[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){if(!F)f.mimeType=a;return this},abort:function(a){a=a||"abort";
t&&t.abort(a);e(0,a);return this}};l.promise(A);A.success=A.done;A.error=A.fail;A.complete=k.add;A.statusCode=function(a){if(a){var b;if(F<2)for(b in a)p[b]=[p[b],a[b]];else b=a[A.status],A.then(b,b)}return this};f.url=((c||f.url)+"").replace(qb,"").replace(ub,ia[1]+"//");f.dataTypes=a.trim(f.dataType||"*").toLowerCase().split(La);if(f.crossDomain==null)r=Qa.exec(f.url.toLowerCase()),f.crossDomain=!(!r||!(r[1]!=ia[1]||r[2]!=ia[2]||(r[3]||(r[1]==="http:"?80:443))!=(ia[3]||(ia[1]==="http:"?80:443))));
if(f.data&&f.processData&&typeof f.data!=="string")f.data=a.param(f.data,f.traditional);C(Ca,f,d,A);if(F===2)return!1;x=f.global;f.type=f.type.toUpperCase();f.hasContent=!tb.test(f.type);x&&a.active++===0&&a.event.trigger("ajaxStart");if(!f.hasContent&&(f.data&&(f.url+=(Pa.test(f.url)?"&":"?")+f.data,delete f.data),j=f.url,f.cache===!1)){r=a.now();var K=f.url.replace(xb,"$1_="+r);f.url=K+(K===f.url?(Pa.test(f.url)?"&":"?")+"_="+r:"")}(f.data&&f.hasContent&&f.contentType!==!1||d.contentType)&&A.setRequestHeader("Content-Type",
f.contentType);f.ifModified&&(j=j||f.url,a.lastModified[j]&&A.setRequestHeader("If-Modified-Since",a.lastModified[j]),a.etag[j]&&A.setRequestHeader("If-None-Match",a.etag[j]));A.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+(f.dataTypes[0]!=="*"?", "+Ta+"; q=0.01":""):f.accepts["*"]);for(u in f.headers)A.setRequestHeader(u,f.headers[u]);if(f.beforeSend&&(f.beforeSend.call(i,A,f)===!1||F===2))return A.abort(),!1;for(u in{success:1,error:1,complete:1})A[u](f[u]);
if(t=C(Sa,f,d,A)){A.readyState=1;x&&h.trigger("ajaxSend",[A,f]);f.async&&f.timeout>0&&(s=setTimeout(function(){A.abort("timeout")},f.timeout));try{F=1,t.send(n,e)}catch(B){if(F<2)e(-1,B);else throw B;}}else e(-1,"No Transport");return A},param:function(c,d){var e=[],f=function(b,c){c=a.isFunction(c)?c():c;e[e.length]=encodeURIComponent(b)+"="+encodeURIComponent(c)};if(d===b)d=a.ajaxSettings.traditional;if(a.isArray(c)||c.jquery&&!a.isPlainObject(c))a.each(c,function(){f(this.name,this.value)});else for(var i in c)x(i,
c[i],d,f);return e.join("&").replace(pb,"+")}});a.extend({active:0,lastModified:{},etag:{}});var yb=a.now(),wa=/(\=)\?(&|$)|\?\?/i;a.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return a.expando+"_"+yb++}});a.ajaxPrefilter("json jsonp",function(b,c,e){c=typeof b.data==="string"&&/^application\/x\-www\-form\-urlencoded/.test(b.contentType);if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(wa.test(b.url)||c&&wa.test(b.data))){var f,i=b.jsonpCallback=a.isFunction(b.jsonpCallback)?b.jsonpCallback():
b.jsonpCallback,h=d[i],l=b.url,k=b.data,p="$1"+i+"$2";b.jsonp!==!1&&(l=l.replace(wa,p),b.url===l&&(c&&(k=k.replace(wa,p)),b.data===k&&(l+=(/\?/.test(l)?"&":"?")+b.jsonp+"="+i)));b.url=l;b.data=k;d[i]=function(a){f=[a]};e.always(function(){d[i]=h;if(f&&a.isFunction(h))d[i](f[0])});b.converters["script json"]=function(){f||a.error(i+" was not called");return f[0]};b.dataTypes[0]="json";return"script"}});a.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(b){a.globalEval(b);return b}}});a.ajaxPrefilter("script",function(a){if(a.cache===b)a.cache=!1;if(a.crossDomain)a.type="GET",a.global=!1});a.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=u.head||u.getElementsByTagName("head")[0]||u.documentElement;return{send:function(e,f){c=u.createElement("script");c.async="async";if(a.scriptCharset)c.charset=a.scriptCharset;c.src=a.url;c.onload=c.onreadystatechange=function(a,
e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success")};d.insertBefore(c,d.firstChild)},abort:function(){if(c)c.onload(0,1)}}}});var Ga=d.ActiveXObject?function(){for(var a in oa)oa[a](0,1)}:!1,zb=0,oa;a.ajaxSettings.xhr=d.ActiveXObject?function(){var a;if(!(a=!this.isLocal&&s()))a:{try{a=new d.ActiveXObject("Microsoft.XMLHTTP");break a}catch(b){}a=void 0}return a}:s;(function(b){a.extend(a.support,
{ajax:!!b,cors:!!b&&"withCredentials"in b})})(a.ajaxSettings.xhr());a.support.ajax&&a.ajaxTransport(function(c){if(!c.crossDomain||a.support.cors){var e;return{send:function(f,i){var h=c.xhr(),l,k;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(k in c.xhrFields)h[k]=c.xhrFields[k];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType);!c.crossDomain&&!f["X-Requested-With"]&&(f["X-Requested-With"]="XMLHttpRequest");try{for(k in f)h.setRequestHeader(k,
f[k])}catch(p){}h.send(c.hasContent&&c.data||null);e=function(d,f){var k,p,j,n,m;try{if(e&&(f||h.readyState===4)){e=b;if(l)h.onreadystatechange=a.noop,Ga&&delete oa[l];if(f)h.readyState!==4&&h.abort();else{k=h.status;j=h.getAllResponseHeaders();n={};if((m=h.responseXML)&&m.documentElement)n.xml=m;try{n.text=h.responseText}catch(q){}try{p=h.statusText}catch(v){p=""}!k&&c.isLocal&&!c.crossDomain?k=n.text?200:404:k===1223&&(k=204)}}}catch(t){f||i(-1,t)}n&&i(k,p,n,j)};!c.async||h.readyState===4?e():(l=
++zb,Ga&&(oa||(oa={},a(d).unload(Ga)),oa[l]=e),h.onreadystatechange=e)},abort:function(){e&&e(0,1)}}}});var Da={},aa,ma,Ab=/^(?:toggle|show|hide)$/,Bb=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,xa,ua=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],ta;a.fn.extend({show:function(b,c,d){if(b||b===0)return this.animate(D("show",3),b,c,d);else{for(var d=0,e=this.length;d<e;d++)if(b=this[d],b.style){c=b.style.display;
if(!a._data(b,"olddisplay")&&c==="none")c=b.style.display="";(c===""&&a.css(b,"display")==="none"||!a.contains(b.ownerDocument.documentElement,b))&&a._data(b,"olddisplay",w(b.nodeName))}for(d=0;d<e;d++)if(b=this[d],b.style&&(c=b.style.display,c===""||c==="none"))b.style.display=a._data(b,"olddisplay")||"";return this}},hide:function(b,c,d){if(b||b===0)return this.animate(D("hide",3),b,c,d);else{for(var d=0,e=this.length;d<e;d++)b=this[d],b.style&&(c=a.css(b,"display"),c!=="none"&&!a._data(b,"olddisplay")&&
a._data(b,"olddisplay",c));for(d=0;d<e;d++)if(this[d].style)this[d].style.display="none";return this}},_toggle:a.fn.toggle,toggle:function(b,c,d){var e=typeof b==="boolean";a.isFunction(b)&&a.isFunction(c)?this._toggle.apply(this,arguments):b==null||e?this.each(function(){var c=e?b:a(this).is(":hidden");a(this)[c?"show":"hide"]()}):this.animate(D("toggle",3),b,c,d);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(b,
c,d,e){function f(){var g;i.queue===!1&&a._mark(this);var c=a.extend({},i),d=this.nodeType===1,e=d&&a(this).is(":hidden"),h,l,k,p,j;c.animatedProperties={};for(k in b)if(h=a.camelCase(k),k!==h&&(b[h]=b[k],delete b[k]),(l=a.cssHooks[h])&&"expand"in l)for(k in p=l.expand(b[h]),delete b[h],p)k in b||(b[k]=p[k]);for(h in b){l=b[h];a.isArray(l)?(c.animatedProperties[h]=l[1],g=b[h]=l[0],l=g):c.animatedProperties[h]=c.specialEasing&&c.specialEasing[h]||c.easing||"swing";if(l==="hide"&&e||l==="show"&&!e)return c.complete.call(this);
if(d&&(h==="height"||h==="width"))if(c.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],a.css(this,"display")==="inline"&&a.css(this,"float")==="none")!a.support.inlineBlockNeedsLayout||w(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1}if(c.overflow!=null)this.style.overflow="hidden";for(k in b)if(d=new a.fx(this,c,k),l=b[k],Ab.test(l))if(h=a._data(this,"toggle"+k)||(l==="toggle"?e?"show":"hide":0))a._data(this,"toggle"+k,h==="show"?"hide":"show"),
d[h]();else d[l]();else h=Bb.exec(l),p=d.cur(),h?(l=parseFloat(h[2]),j=h[3]||(a.cssNumber[k]?"":"px"),j!=="px"&&(a.style(this,k,(l||1)+j),p*=(l||1)/d.cur(),a.style(this,k,p+j)),h[1]&&(l=(h[1]==="-="?-1:1)*l+p),d.custom(p,l,j)):d.custom(p,l,"");return!0}var i=a.speed(c,d,e);if(a.isEmptyObject(b))return this.each(i.complete,[!1]);b=a.extend({},b);return i.queue===!1?this.each(f):this.queue(i.queue,f)},stop:function(c,d,e){typeof c!=="string"&&(e=d,d=c,c=b);d&&c!==!1&&this.queue(c||"fx",[]);return this.each(function(){function b(c,
d,f){d=d[f];a.removeData(c,f,!0);d.stop(e)}var d,f=!1,i=a.timers,h=a._data(this);e||a._unmark(!0,this);if(c==null)for(d in h)h[d]&&h[d].stop&&d.indexOf(".run")===d.length-4&&b(this,h,d);else h[d=c+".run"]&&h[d].stop&&b(this,h,d);for(d=i.length;d--;)if(i[d].elem===this&&(c==null||i[d].queue===c)){if(e)i[d](!0);else i[d].saveState();f=!0;i.splice(d,1)}(!e||!f)&&a.dequeue(this,c)})}});a.each({slideDown:D("show",1),slideUp:D("hide",1),slideToggle:D("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},
fadeToggle:{opacity:"toggle"}},function(b,c){a.fn[b]=function(a,b,d){return this.animate(c,a,b,d)}});a.extend({speed:function(b,c,d){var e=b&&typeof b==="object"?a.extend({},b):{complete:d||!d&&c||a.isFunction(b)&&b,duration:b,easing:d&&c||c&&!a.isFunction(c)&&c};e.duration=a.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in a.fx.speeds?a.fx.speeds[e.duration]:a.fx.speeds._default;if(e.queue==null||e.queue===!0)e.queue="fx";e.old=e.complete;e.complete=function(b){a.isFunction(e.old)&&
e.old.call(this);e.queue?a.dequeue(this,e.queue):b!==!1&&a._unmark(this)};return e},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+0.5}},timers:[],fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;b.orig=b.orig||{}}});a.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(a.fx.step[this.prop]||a.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==
null))return this.elem[this.prop];var b,c=a.css(this.elem,this.prop);return isNaN(b=parseFloat(c))?!c||c==="auto"?0:c:b},custom:function(c,d,e){function f(a){return i.step(a)}var i=this,h=a.fx;this.startTime=ta||S();this.end=d;this.now=this.start=c;this.pos=this.state=0;this.unit=e||this.unit||(a.cssNumber[this.prop]?"":"px");f.queue=this.options.queue;f.elem=this.elem;f.saveState=function(){a._data(i.elem,"fxshow"+i.prop)===b&&(i.options.hide?a._data(i.elem,"fxshow"+i.prop,i.start):i.options.show&&
a._data(i.elem,"fxshow"+i.prop,i.end))};f()&&a.timers.push(f)&&!xa&&(xa=setInterval(h.tick,h.interval))},show:function(){var c=a._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=c||a.style(this.elem,this.prop);this.options.show=!0;c!==b?this.custom(this.cur(),c):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());a(this.elem).show()},hide:function(){this.options.orig[this.prop]=a._data(this.elem,"fxshow"+this.prop)||a.style(this.elem,this.prop);this.options.hide=
!0;this.custom(this.cur(),0)},step:function(b){var c,d=ta||S(),e=!0,f=this.elem,i=this.options;if(b||d>=i.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();i.animatedProperties[this.prop]=!0;for(c in i.animatedProperties)i.animatedProperties[c]!==!0&&(e=!1);if(e){i.overflow!=null&&!a.support.shrinkWrapBlocks&&a.each(["","X","Y"],function(a,b){f.style["overflow"+b]=i.overflow[a]});i.hide&&a(f).hide();if(i.hide||i.show)for(c in i.animatedProperties)a.style(f,c,i.orig[c]),
a.removeData(f,"fxshow"+c,!0),a.removeData(f,"toggle"+c,!0);if(b=i.complete)i.complete=!1,b.call(f)}return!1}else i.duration==Infinity?this.now=d:(b=d-this.startTime,this.state=b/i.duration,this.pos=a.easing[i.animatedProperties[this.prop]](this.state,b,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}};a.extend(a.fx,{tick:function(){for(var b,c=a.timers,d=0;d<c.length;d++)b=c[d],!b()&&c[d]===b&&c.splice(d--,1);c.length||a.fx.stop()},interval:13,stop:function(){clearInterval(xa);
xa=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(b){a.style(b.elem,"opacity",b.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}});a.each(ua.concat.apply([],ua),function(b,c){c.indexOf("margin")&&(a.fx.step[c]=function(b){a.style(b.elem,c,Math.max(0,b.now)+b.unit)})});if(a.expr&&a.expr.filters)a.expr.filters.animated=function(b){return a.grep(a.timers,function(a){return b===a.elem}).length};var Ua,Cb=
/^t(?:able|d|h)$/i,Va=/^(?:body|html)$/i;Ua="getBoundingClientRect"in u.documentElement?function(b,c,d,e){try{e=b.getBoundingClientRect()}catch(f){}if(!e||!a.contains(d,b))return e?{top:e.top,left:e.left}:{top:0,left:0};b=c.body;c=B(c);return{top:e.top+(c.pageYOffset||a.support.boxModel&&d.scrollTop||b.scrollTop)-(d.clientTop||b.clientTop||0),left:e.left+(c.pageXOffset||a.support.boxModel&&d.scrollLeft||b.scrollLeft)-(d.clientLeft||b.clientLeft||0)}}:function(b,c,d){var e,f=b.offsetParent,i=c.body;
e=(c=c.defaultView)?c.getComputedStyle(b,null):b.currentStyle;for(var h=b.offsetTop,l=b.offsetLeft;(b=b.parentNode)&&b!==i&&b!==d;){if(a.support.fixedPosition&&e.position==="fixed")break;e=c?c.getComputedStyle(b,null):b.currentStyle;h-=b.scrollTop;l-=b.scrollLeft;if(b===f){h+=b.offsetTop;l+=b.offsetLeft;if(a.support.doesNotAddBorder&&(!a.support.doesAddBorderForTableAndCells||!Cb.test(b.nodeName)))h+=parseFloat(e.borderTopWidth)||0,l+=parseFloat(e.borderLeftWidth)||0;f=b.offsetParent}a.support.subtractsBorderForOverflowNotVisible&&
e.overflow!=="visible"&&(h+=parseFloat(e.borderTopWidth)||0,l+=parseFloat(e.borderLeftWidth)||0)}if(e.position==="relative"||e.position==="static")h+=i.offsetTop,l+=i.offsetLeft;a.support.fixedPosition&&e.position==="fixed"&&(h+=Math.max(d.scrollTop,i.scrollTop),l+=Math.max(d.scrollLeft,i.scrollLeft));return{top:h,left:l}};a.fn.offset=function(c){if(arguments.length)return c===b?this:this.each(function(b){a.offset.setOffset(this,c,b)});var d=this[0],e=d&&d.ownerDocument;return!e?null:d===e.body?a.offset.bodyOffset(d):
Ua(d,e,e.documentElement)};a.offset={bodyOffset:function(b){var c=b.offsetTop,d=b.offsetLeft;a.support.doesNotIncludeMarginInBodyOffset&&(c+=parseFloat(a.css(b,"marginTop"))||0,d+=parseFloat(a.css(b,"marginLeft"))||0);return{top:c,left:d}},setOffset:function(b,c,d){var e=a.css(b,"position");if(e==="static")b.style.position="relative";var f=a(b),i=f.offset(),h=a.css(b,"top"),l=a.css(b,"left"),k={},p={};(e==="absolute"||e==="fixed")&&a.inArray("auto",[h,l])>-1?(p=f.position(),e=p.top,l=p.left):(e=parseFloat(h)||
0,l=parseFloat(l)||0);a.isFunction(c)&&(c=c.call(b,d,i));if(c.top!=null)k.top=c.top-i.top+e;if(c.left!=null)k.left=c.left-i.left+l;"using"in c?c.using.call(b,k):f.css(k)}};a.fn.extend({position:function(){if(!this[0])return null;var b=this[0],c=this.offsetParent(),d=this.offset(),e=Va.test(c[0].nodeName)?{top:0,left:0}:c.offset();d.top-=parseFloat(a.css(b,"marginTop"))||0;d.left-=parseFloat(a.css(b,"marginLeft"))||0;e.top+=parseFloat(a.css(c[0],"borderTopWidth"))||0;e.left+=parseFloat(a.css(c[0],
"borderLeftWidth"))||0;return{top:d.top-e.top,left:d.left-e.left}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent||u.body;b&&!Va.test(b.nodeName)&&a.css(b,"position")==="static";)b=b.offsetParent;return b})}});a.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(c,d){var e=/Y/.test(d);a.fn[c]=function(f){return a.access(this,function(c,f,i){var h=B(c);if(i===b)return h?d in h?h[d]:a.support.boxModel&&h.document.documentElement[f]||h.document.body[f]:c[f];
h?h.scrollTo(!e?i:a(h).scrollLeft(),e?i:a(h).scrollTop()):c[f]=i},c,f,arguments.length,null)}});a.each({Height:"height",Width:"width"},function(c,d){var e="client"+c,f="scroll"+c,i="offset"+c;a.fn["inner"+c]=function(){var b=this[0];return b?b.style?parseFloat(a.css(b,d,"padding")):this[d]():null};a.fn["outer"+c]=function(b){var c=this[0];return c?c.style?parseFloat(a.css(c,d,b?"margin":"border")):this[d]():null};a.fn[d]=function(c){return a.access(this,function(c,d,h){if(a.isWindow(c))return d=c.document,
c=d.documentElement[e],a.support.boxModel&&c||d.body&&d.body[e]||c;if(c.nodeType===9)return d=c.documentElement,d[e]>=d[f]?d[e]:Math.max(c.body[f],d[f],c.body[i],d[i]);if(h===b)return c=a.css(c,d),d=parseFloat(c),a.isNumeric(d)?d:c;a(c).css(d,h)},d,c,arguments.length,null)}})})(window);return a});
redhelper.define("common/extensions/jquery.getvisible",["common/extensions/jquery"],function(a){a.fn.getVisible=function(){if(this.length<=1)return this;var d=a(window).scrollLeft(),b=a(window).scrollTop(),e=a(window).width(),j=a(window).height(),f=null;a.each(this,function(c,k){var n;if(a(k).is(":visible")){n={left:parseInt(a(k).css("padding-left")),right:parseInt(a(k).css("padding-right")),top:parseInt(a(k).css("padding-top")),bottom:parseInt(a(k).css("padding-bottom"))};for(var t in n)n[t]!=n[t]&&
(n[t]=0);var r={left:parseInt(a(k).css("border-left-width")),right:parseInt(a(k).css("border-right-width")),top:parseInt(a(k).css("border-top-width")),bottom:parseInt(a(k).css("border-bottom-width"))};for(t in r)r[t]!=r[t]&&(r[t]=0);t=a(k).offset();t.width=a(k).width()+n.left+n.right+r.left+r.right;t.height=a(k).height()+n.top+n.bottom+r.top+r.bottom;n=t}else n={top:0,left:0,width:0,height:0};if(d+e>n.left&&n.left+n.width>d&&b+j>n.top&&n.top+n.height>b)return f=k,!1});return a(f)};return a});
redhelper.require(["common/extensions/jquery"],function(a){a.fn.oldIs=a.fn.oldIs||a.fn.is;a.fn.is=function(a){return a==":visible"?this.css("display")!="none"&&this.oldIs(":visible"):this.oldIs(a)};a.acceptData=function(d){if(typeof d.nodeName=="string"){var b=a.noData[d.nodeName.toLowerCase()];if(b)return!(b===!0||d.getAttribute("classid")!==b)}return!0}});redhelper.define("common/extensions/jquery.fix",function(){});
redhelper.require(["common/extensions/jquery"],function(a,d){function b(a,b,c){var d=t[b.type]||{};if((b.empty||c)&&a==null)return null;if(b.def&&a==null)return b.def;a=d.floor?~~a:parseFloat(a);if(a==null||isNaN(a))return b.def;return d.mod?(a%=d.mod,a<0?d.mod+a:a):d.min>a?d.min:d.max<a?d.max:a}function e(a,b,c){c=(c+1)%1;return c*6<1?a+(b-a)*6*c:c*2<1?b:c*3<2?a+(b-a)*(2/3-c)*6:a}var j="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),
f=/^([\-+])=\s*(\d+\.?\d*)/,c=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,
parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],k=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},n={rgba:{cache:"_rgba",props:{red:{idx:0,type:"byte",empty:!0},green:{idx:1,type:"byte",empty:!0},blue:{idx:2,type:"byte",empty:!0},alpha:{idx:3,type:"percent",
def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:!0},saturation:{idx:1,type:"percent",empty:!0},lightness:{idx:2,type:"percent",empty:!0}}}},t={"byte":{floor:!0,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:!0}},r=n.rgba.props,q=k.support={},m,p=a.each;n.hsla.props.alpha=r.alpha;k.fn=k.prototype={constructor:k,parse:function(e,f,l,j){if(e===d)return this._rgba=[null,null,null,null],this;if(e instanceof a||e.nodeType)e=e instanceof a?e.css(f):a(e).css(f),f=d;var q=
this,t=a.type(e),x=this._rgba=[];f!==d&&(e=[e,f,l,j],t="array");if(t==="string"){e=e.toLowerCase();p(c,function(a,b){var c=b.re.exec(e),d=c&&b.parse(c),f=b.space||"rgba",c=n[f].cache;if(d)return d=q[f](d),q[c]=d[c],x=q._rgba=d._rgba,!1});if(x.length!==0)return Math.max.apply(Math,x)===0&&a.extend(x,m.transparent),this;e=m[e]||m._default;return this.parse(e)}if(t==="array")return p(r,function(a,c){x[c.idx]=b(e[c.idx],c)}),this;if(t==="object")return e instanceof k?p(n,function(a,b){e[b.cache]&&(q[b.cache]=
e[b.cache].slice())}):p(n,function(a,c){p(c.props,function(a,d){var f=c.cache;if(!q[f]&&c.to){if(e[a]==null||a==="alpha")return;q[f]=c.to(q._rgba)}q[f][d.idx]=b(e[a],d,!0)})}),this},is:function(a){var b=k(a),c=!0,d=this;p(n,function(a,e){var f=b[e.cache],i;f&&(i=d[e.cache]||e.to&&e.to(d._rgba)||[],p(e.props,function(a,b){if(f[b.idx]!=null)return c=f[b.idx]==i[b.idx]}));return c});return c},_space:function(){var a=[],b=this;p(n,function(c,d){b[d.cache]&&a.push(c)});return a.pop()},transition:function(a,
c){var d=k(a),e=d._space(),f=n[e],j=this[f.cache]||f.to(this._rgba),m=j.slice(),d=d[f.cache];p(f.props,function(a,e){var f=e.idx,i=j[f],k=d[f],p=t[e.type]||{};k!==null&&(i===null?m[f]=k:(p.mod&&(k-i>p.mod/2?i+=p.mod:i-k>p.mod/2&&(i-=p.mod)),m[e.idx]=b((k-i)*c+i,e)))});return this[e](m)},blend:function(b){if(this._rgba[3]===1)return this;var c=this._rgba.slice(),d=c.pop(),e=k(b)._rgba;return k(a.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,
b){return a==null?b>2?1:0:a});c[3]===1&&(c.pop(),b="rgb(");return b+c.join(",")+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){a==null&&(a=b>2?1:0);b&&b<3&&(a=Math.round(a*100)+"%");return a});c[3]==1&&(c.pop(),b="hsl(");return b+c.join(",")+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();b&&c.push(~~(d*255));return"#"+a.map(c,function(a){a=(a||0).toString(16);return a.length==1?"0"+a:a}).join("")},toString:function(){return this._rgba[3]===0?"transparent":
this.toRgbaString()}};k.fn.parse.prototype=k.fn;n.hsla.to=function(a){if(a[0]==null||a[1]==null||a[2]==null)return[null,null,null,a[3]];var b=a[0]/255,c=a[1]/255,d=a[2]/255,a=a[3],e=Math.max(b,c,d),f=Math.min(b,c,d),k=e-f,p=e+f,j=p*0.5;return[Math.round(f===e?0:b===e?60*(c-d)/k+360:c===e?60*(d-b)/k+120:60*(b-c)/k+240)%360,j===0||j===1?j:j<=0.5?k/p:k/(2-p),j,a==null?1:a]};n.hsla.from=function(a){if(a[0]==null||a[1]==null||a[2]==null)return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],a=a[3],c=
d<=0.5?d*(1+c):d+c-d*c,d=2*d-c;return[Math.round(e(d,c,b+1/3)*255),Math.round(e(d,c,b)*255),Math.round(e(d,c,b-1/3)*255),a]};p(n,function(c,e){var l=e.props,j=e.cache,n=e.to,m=e.from;k.fn[c]=function(c){n&&!this[j]&&(this[j]=n(this._rgba));if(c===d)return this[j].slice();var e=a.type(c),f=e==="array"||e==="object"?c:arguments,i=this[j].slice(),h;p(l,function(a,c){var d=f[e==="object"?a:c.idx];d==null&&(d=i[c.idx]);i[c.idx]=b(d,c)});return m?(h=k(m(i)),h[j]=i,h):k(i)};p(l,function(b,d){k.fn[b]||(k.fn[b]=
function(e){var h=a.type(e),k=b==="alpha"?this._hsla?"hsla":"rgba":c,l=this[k](),p=l[d.idx];if(h==="undefined")return p;h==="function"&&(e=e.call(this,p),h=a.type(e));if(e==null&&d.empty)return this;h==="string"&&(h=f.exec(e))&&(e=p+parseFloat(h[2])*(h[1]==="+"?1:-1));l[d.idx]=e;return this[k](l)})})});p(j,function(b,c){a.cssHooks[c]={set:function(b,d){d=k(d);if(!q.rgba&&d._rgba[3]!==1){var e,f=c==="backgroundColor"?b.parentNode:b;do e=a.curCSS(f,"backgroundColor");while((e===""||e==="transparent")&&
(f=f.parentNode)&&f.style);d=d.blend(e&&e!=="transparent"?e:"_default")}d=d.toRgbaString();b.style[c]=d}};a.fx.step[c]=function(b){if(!b.colorInit)b.start=k(b.elem,c),b.end=k(b.end),b.colorInit=!0;a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}});a(function(){var a=document.createElement("div").style;a.cssText="background-color:rgba(1,1,1,.5)";q.rgba=a.backgroundColor.indexOf("rgba")>-1});m=a.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",
cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",
navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}});redhelper.define("common/extensions/jquery.color",function(){});
redhelper.require(["common/extensions/jquery"],function(a){if(window.postMessage)a.postMessage=function(a,b,e){a.postMessage(b,e)},a.receiveMessage=function(a){window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent&&window.attachEvent("onmessage",a)}});redhelper.define("common/extensions/jquery.postMessage",function(){});
redhelper.require(["common/extensions/jquery"],function(a){a.easing.rh_expIn=function(a,b,e,j){return b==0?e:e+j*Math.pow(2,10*(a-1))};a.easing.rh_expOut=function(a,b,e,j){return a==1?e+j:e+j*(1-Math.pow(2,-10*a))};a.easing.rh_in=function(a,b,e,j){return e+j*a*a*(3*a-2)};a.easing.rh_out=function(a,b,e,j){return e+j*((a-1)*(a-1)*(3*(a-1)+2)+1)};a.easing.rh_bounce=function(a,b,e,j){b=1/2.75;return a<b?e+j*7.5625*a*a:a<2*b?e+j*(7.5625*(a-1.5*b)*(a-1.5*b)+0.75):a<2.5*b?e+j*(7.5625*(a-2.25*b)*(a-2.25*
b)+0.9375):e+j*(7.5625*(a-2.625*b)*(a-2.625*b)+0.984375)}});redhelper.define("common/extensions/jquery.easing",function(){});
redhelper.require(["common/extensions/jquery"],function(a){a.browser.mozilla?(a.fn.disableTextSelect=function(){return this.each(function(){a(this).css("MozUserSelect","none")})},a.fn.enableTextSelect=function(){return this.each(function(){a(this).css("MozUserSelect","")})}):a.browser.webkit?(a.fn.disableTextSelect=function(){return this.each(function(){a(this).css("-webkit-user-select","none")})},a.fn.enableTextSelect=function(){return this.each(function(){a(this).css("-webkit-user-select","")})}):
a.browser.msie?(a.fn.disableTextSelect=function(){return this.each(function(){a(this).bind("selectstart.disableTextSelect",function(){return!1})})},a.fn.enableTextSelect=function(){return this.each(function(){a(this).unbind("selectstart.disableTextSelect")})}):(a.fn.disableTextSelect=function(){return this.each(function(){a(this).bind("mousedown.disableTextSelect",function(){return!1})})},a.fn.enableTextSelect=function(){return this.each(function(){a(this).unbind("mousedown.disableTextSelect")})})});
redhelper.define("common/extensions/jquery.disableSelection",function(){});
redhelper.require(["common/extensions/jquery"],function(a){a.fn.getPath=function(){if(this.length!=1)throw"Requires one element.";for(var a,b=this;b.length;){var e=b[0],j=e.localName||e.tagName||e.nodeName;if(!j||j=="#document")break;j=j.toLowerCase();if(e.id)return j+"#"+e.id+(a?">"+a:"");else e.className&&(j+="."+e.className.split(/\s+/).join("."));var e=b.parent(),f=e.children(j);f.length>1&&(j+=":eq("+f.index(b)+")");a=j+(a?">"+a:"");b=e}return a}});
redhelper.define("common/extensions/jquery.getpath",function(){});
redhelper.require(["common/extensions/jquery"],function(a){a.fn.pulse=function(d){var b=a(this).css("opacity");a(this).animate({opacity:0},{duration:100,queue:!0}).animate({opacity:b},{duration:120,queue:!0}).animate({opacity:0},{duration:150,queue:!0}).animate({opacity:b},{duration:170,queue:!0}).animate({opacity:0},{duration:200,queue:!0}).animate({opacity:b},{duration:300,queue:!0}).animate({opacity:0},{duration:600,queue:!0,complete:function(){a(this).hide().css("opacity",b);d()}})}});
redhelper.define("common/extensions/jquery.pulse",function(){});redhelper.define("common/extensions/jquery.plugins","common/extensions/jquery,common/extensions/jquery.getvisible,common/extensions/jquery.fix,common/extensions/jquery.color,common/extensions/jquery.postMessage,common/extensions/jquery.easing,common/extensions/jquery.disableSelection,common/extensions/jquery.getpath,common/extensions/jquery.pulse".split(","),function(a){return a});
redhelper.define("common/constants/type",{STRING:0,BOOLEAN:1,INTEGER:2,OBJECT:3});redhelper.define("common/constants/scope",{SESSION:0,CACHE:1,STORAGE:2});
redhelper.define("common/application/session","common/extensions/jquery.plugins,common/application/eventTarget,common/constants/type,common/extensions/debug,common/extensions/base64,common/constants/scope".split(","),function(a,d,b,e,j,f){function c(a,b,c){var d=new Date;if(!(i[a]&&i[a]==b+""))i[a]=b+"",b=j.encode(b),b=encodeURIComponent(b)+"; path=/; domain="+n+(c==f.CACHE&&(d.setMinutes(d.getMinutes()+5),!0)||c==f.STORAGE&&(d.setMonth(d.getMonth()+1),!0)?"; expires="+d.toUTCString():""),document.cookie=
a+"="+b}function k(a){if(i[a])return i[a];var b="";document.cookie.split(";").forEach(function(c){c.substr(0,c.indexOf("=")).replace(/^\s+|\s$/g,"")==a&&(b=c.substr(c.indexOf("=")+1))});b=j.decode(decodeURIComponent(b));return i[a]=b}var n="",t="",r=[],q=null,m=null,p={},i=[],h=a.extend(new Image,{dispatcher:new d("Session"),set:function(a,b,d){if(h.get(a)!==""+b){var i="rhlp."+t+"."+(d==f.CACHE?"cache":d==f.STORAGE?"storage":"session"),p=!1,b=(b+"").replace(/;/g,"_.,"),j=k(i).split(";").map(function(c){return c.split("=")[0]==
a?(p=!0,a+"="+b):c}).join(";");p||(j=k(i)+a+"="+b+";");c(i,j,d);h.dispatcher.fire("on"+a.charAt(0).toUpperCase()+a.substr(1)+"Changed");e.sessionLog("COOKIES | "+a+" = "+b)}},get:function(a){var b="";["session","cache","storage"].forEach(function(c){k("rhlp."+t+"."+c).split(";").forEach(function(c){c.substr(0,c.indexOf("="))==a&&(b=c.substr(c.indexOf("=")+1))})});return b.replace(/_\.,/g,";")},init:function(a,c,d,i){t=a;typeof c=="undefined"&&(c="/");n=c;!i&&window.sessionStorage&&window.localStorage&&
h.storageInit(d,a);h._obj=d;h.fields=[];for(var k in d)(function(a){var c=function(){var c=h.get(a);!c&&d[a].fallback&&(c=h.get(d[a].fallback));var e;switch(typeof d[a].type!="undefined"?d[a].type:b.STRING){case b.BOOLEAN:e=c.toLowerCase();e=e=="true"||e=="yes"||e=="ok"||e=="1";break;case b.INTEGER:e=+c;break;case b.OBJECT:try{e=JSON.parse(c)}catch(f){e={}}break;default:e=c}return d[a].value&&c==""?d[a].value:e},e=function(c){var e=d[a].scope;d[a].type==b.OBJECT&&(c=JSON.stringify(c));if(typeof e==
"undefined")e=f.SESSION;h.set(a,c,e)};if(!Object.__defineGetter__&&Object.defineProperty)Object.defineProperty(h,a,{get:c,set:e});else if(h.__defineGetter__)h.__defineGetter__(a,c),h.__defineSetter__(a,e);else{h[a]=c();var i=c();setInterval(function(){h[a]!=i&&(e(h[a]),i=h[a])},100)}h.fields.push(a)})(k);e.sessionLog(["INIT | ",a,c,"isAsync =",!!i+""].join(" "))},addClient:function(a){m=a;m.addHandler("readCookie",function(a){var a=JSON.parse(a.value)||h._obj,b={},c;for(c in a)b[c]=h[c];m.send("cookie",
JSON.stringify(b))});m.addHandler("updateCookie",function(a){h[a.name]=h._obj[a.name].type==b.OBJECT?JSON.parse(a.value):a.value});r.push(m)},asyncInit:function(a,b,c,d){p=d;m=a;h.get=function(a){return""+h["_"+a]};h.set=function(a,b,c){h.get(a)!=""+b&&(h["_"+a]=b,m.send("updateCookie",{name:a,value:b,scope:c}),h.dispatcher.fire("on"+a.charAt(0).toUpperCase()+a.substr(1)+"Changed"),e.sessionLog("ASYNC | "+a+" = "+b))};m.addHandler("cookie",function(a){var a=JSON.parse(a.value),b;for(b in a)h["_"+
b]=a[b]||h["_"+b]||"";q&&q()});h.init(b,c,d,!0)},onLoad:function(a){typeof a=="function"&&(q=a);m?m.send("readCookie",JSON.stringify(p)):q()},storageInit:function(a){h.get=function(b){var c=b,b="rhlp."+t+"."+b;return a[c].scope==f.STORAGE?localStorage.getItem(b)?localStorage.getItem(b):"":sessionStorage.getItem(b)?sessionStorage.getItem(b):""};h.set=function(a,b,c){var d=a,a="rhlp."+t+"."+a,i=null,i=c==f.STORAGE?localStorage:sessionStorage;i.getItem(a)!=b&&(e.sessionLog("STORAGE | "+a+" = "+b),i.setItem(a,
b),h.dispatcher.fire("on"+d.charAt(0).toUpperCase()+d.substr(1)+"Changed"))}},asyncStorageInit:function(a,b,c,d){p=d;m=a;h.get=function(a){if(!d[a])return"";var b=a,a="rhlp."+t+"."+a;return d[b].scope==f.STORAGE?localStorage.getItem(a)?localStorage.getItem(a):"":sessionStorage.getItem(a)?sessionStorage.getItem(a):""};h.set=function(a,b,c){if(h.get(a)!=""+b){m.send("updateCookie",{name:a,value:b,scope:c});var d=a,a="rhlp."+t+"."+a;c==f.STORAGE?localStorage.setItem(a,b):sessionStorage.setItem(a,b);
h.dispatcher.fire("on"+d.charAt(0).toUpperCase()+d.substr(1)+"Changed");e.sessionLog("ASYNC | "+a+" = "+b)}};m.addHandler("cookie",function(a){var a=JSON.parse(a.value),b,c;for(c in a)h.get(c)&&d[c].priority=="internal"?m.send("updateCookie",{name:c,value:h.get(c),scope:d[c].scope}):(b="rhlp."+t+"."+c,d[c].scope&&d[c].scope==f.STORAGE?localStorage.setItem(b,a[c]):sessionStorage.setItem(b,a[c]));q&&q()});h.init(b,c,d,!0)},clear:function(){for(var a in null)a!="vid"&&(h[a]=null[a].value||"")}});return h});
redhelper.define("common/constants/chatState",{MINIMIZED:0,INVITATION:1,MAXIMIZED:2,WINDOW:3});
redhelper.define("common/communication/messageTarget",["common/extensions/jquery.plugins","common/application/eventTarget","common/communication/encoder","common/extensions/debug"],function(a,d,b,e){function j(){this._dispatcher=new d("MessageTarget");var a=[],b=!1;this.queueMessage=function(b,c){a.push({type:b,obj:c})};this.startMessaging=function(){b=!0;for(var d=0,e=a.length;d<e;d++)this.send(a[d].type,a[d].obj)};this.isAllowed=function(){return b}}j.prototype={init:function(b,c,d,j){this._targetUri=
d;this._targetWindow=b;this._origin=c;j&&(messagesAllowed=!0);var t=this;try{a.receiveMessage(function(a){t._handle(a)})}catch(r){e.error(r)}},_handle:function(a){try{if(a.data.indexOf("__rh__")===-1)return}catch(c){e.log(c)}a=b.parse(a.data.replace("__rh__",""));if(a._messageType)a.isMessageTarget=!0,this._dispatcher.fire({type:a._messageType,obj:a})},setOrigin:function(a){this._origin=a},addHandler:function(a,b){this._dispatcher.addEventListener(a,function(a){b(a.obj)})},removeHandler:function(a,
b){this._dispatcher.removeEventListener(a,b)},removeHandlers:function(a){this.dispatcher.removeAllEventListeners(a)},send:function(d,c){if(this.isAllowed()){typeof c==="undefined"?c={}:typeof c!=="object"&&(c={value:c});c._messageType=d;var e="__rh__"+b.serialize(c);a.postMessage(this._targetWindow,e,this._origin,this._targetUri)}else this.queueMessage(d,c)}};return j});
redhelper.define("application/parent",["common/communication/messageTarget","config/setup"],function(a,d){var b=new a;d.STANDALONE||(b.init(parent,d.PARENT_URL,d.PARENT_URI,!0),b.startMessaging());return b});
redhelper.define("application/session.objects","common/application/session,config/setup,common/constants/scope,common/constants/type,common/constants/chatState,common/extensions/jquery.plugins,application/parent".split(","),function(a,d,b,e,j,f,c){b={vid:{scope:b.STORAGE,type:e.INTEGER,priority:"internal"},locale:{scope:b.STORAGE},ip:{scope:b.STORAGE},badge:{value:"badge1.png",scope:b.STORAGE},badgePosition:{value:"left",scope:b.STORAGE},chatColor:{scope:b.STORAGE},chatIntensity:{scope:b.STORAGE},
defaultFace:{scope:b.STORAGE},skin:{scope:b.STORAGE},inviteTime:{scope:b.STORAGE},currentInviteTime:{type:e.INTEGER},firstMessage:{scope:b.STORAGE},currentFirstMessage:{},defaultWelcome:{scope:b.STORAGE},currentWelcome:{},defaultText:{scope:b.STORAGE},currentTopText:{},defaultHeader:{scope:b.STORAGE},currentHeader:{},offlineEnabled:{type:e.BOOLEAN,value:!0,scope:b.STORAGE},offlineText:{},offlineHeader:{},isOnline:{type:e.BOOLEAN},currentOperator:{scope:b.STORAGE,priority:"internal"},currentOperAvatar:{scope:b.SESSION},
operDisplayName:{scope:b.STORAGE},operAvatar:{scope:b.STORAGE,fallback:"defaultFace"},reconnects:{type:e.INTEGER,value:0},referrer:{scope:b.STORAGE},isSendMouseActive:{type:e.BOOLEAN,value:!1,scope:b.STORAGE},currentTypedText:{},chatX:{type:e.INTEGER},chatY:{type:e.INTEGER},chatWidth:{type:e.INTEGER},chatHeight:{type:e.INTEGER},currentChatX:{type:e.INTEGER},currentChatY:{type:e.INTEGER},lastVisit:{value:"1/1/2000",scope:b.STORAGE},currentChatWidth:{type:e.INTEGER},currentChatHeight:{type:e.INTEGER},
chatState:{type:e.INTEGER,value:j.MINIMIZED},stringChatState:{scope:b.STORAGE,priority:"internal",value:"browse"},mouseOperators:{scope:b.STORAGE},previousDay:{value:"1/1/2000",scope:b.STORAGE},badgeColor:{},badgeText:{},badgeFontSize:{type:e.INTEGER,value:0},badgePadding:{type:e.INTEGER,value:0},badgeX:{type:e.INTEGER,value:"70%"},badgeY:{type:e.INTEGER,value:"40%"},cachedEvent:{},region:{scope:b.SESSION},city:{scope:b.SESSION},country:{scope:b.SESSION},time:{type:e.INTEGER,value:0},lastVisitTime:{type:e.INTEGER,
value:0,scope:b.STORAGE},visits:{type:e.INTEGER,value:0,scope:b.STORAGE},viewedPages:{type:e.INTEGER,value:0,scope:b.STORAGE},trigger:{},inviteState:{value:"none",priority:"internal"},rid:{value:0,type:e.INTEGER},sid:{value:""},reconnecting:{value:!1,type:e.BOOLEAN},chatStarted:{value:!1,type:e.BOOLEAN,scope:b.STORAGE,priority:"internal"},customFields:{scope:b.STORAGE},preferredOperator:{value:""},requiredOperator:{value:""},preferredOperatorError:{value:""},lastMessageTime:{scope:b.STORAGE},lastMessageFrom:{scope:b.STORAGE},
audioEnabled:{value:!0,type:e.BOOLEAN,scope:b.STORAGE,priority:"internal"},free:{value:!1,type:e.BOOLEAN},offlineFields:{value:'["name", "email", "message"]',type:e.OBJECT},userLocale:{value:""},onlineOperators:{type:e.OBJECT}};d.STANDALONE?a.init(d.CLIENT_NAME,".redhelper.ru",b):a.asyncStorageInit(c,d.CLIENT_NAME,".redhelper.ru",b,function(){});for(var k in b)(function(b){a.dispatcher.addEventListener("on"+b.charAt(0).toUpperCase()+b.substr(1)+"Changed",function(){f("span.redhlp_"+b).html(a[b])})})(k);
return a});redhelper.define("config/api",["common/communication/encoder","application/dispatcher","application/parent"],function(a,d){try{var b=a.decompress(location.hash.split("#")[1]).settings}catch(e){b={}}var j=[],f=!1,c,k;b.waitForTemplate=function(a){f?a():typeof a==="function"&&j.push(a)};d.addEventListener("templateProcessed",function(){for(c=0,k=j.length;c<k;c++)j[c]()});d.addEventListener("templateReceived",function(){f=!0});return b});
redhelper.define("config/lang",["application/session.objects","config/api"],function(a,d){var b={CHAT_LABEL:"",YOU_LABEL:"",EMAIL_INCORRECT:"",FAILED_TO_SEND:"",INCORRECT_EMAIL:"",NOT_ALL_FIELDS:"",MAIL_SUCCESS:"",MAIL_SENT:"",SEND_BUTTON:"",THROBBER:"",MESSAGE_LABEL:"",EMAIL_LABEL:"",NAME_LABEL:"",OFFLINE_HEADER:"",OFFLINE_TEXT:"",PAGE_TITLE:"",URL_NEW_TAB:"",TITLE_NEW_TAB:"",WEBSITE:"",TYPING_LABEL:"",PROMPT_LABEL:"",PROMPT_BUTTON_YES:"",PROMPT_BUTTON_NO:"",NOTIFICATION_HEADER:"",OPERATOR_REDIRECT:"",
OPERATOR_REDIRECT_OK:"",OPERATOR_CONNECTING:"",NO_PREFERRED_OPERATOR:"",TOO_LONG:"",PHONE_MESSAGE:"",PHONE_LABEL:"",INCORRECT_PHONE:"",ALL_OFFLINE:"",LEAVE_MESSAGE:"",DEFAULT_FIRST_MESSAGE:""};b.initLanguage=function(){var e,j=["en","ru","lv","dk"];j=a.userLocale?a.userLocale:a&&a.locale&&j.indexOf(a.locale)>-1?a.locale:"";if(j&&j==="dk")b.CHAT_LABEL="Skriv venligst din meddelelse her",b.YOU_LABEL="Dig",b.EMAIL_INCORRECT="Fejl i den indtastede e-mail adresse",b.FAILED_TO_SEND="Meddelelsen blev ikke sendt",
b.INCORRECT_EMAIL="The email is incorrect",b.NOT_ALL_FIELDS="Udfyld venligst alle felter",b.MAIL_SUCCESS="Din meddelelse er blevet sendt",b.MAIL_SENT="Din meddelelse er blevet sendt",b.SEND_BUTTON="Send",b.THROBBER="Vent venligst",b.MESSAGE_LABEL="Meddelelse:",b.EMAIL_LABEL="Din e-mail:",b.NAME_LABEL="Dit navn:",b.OFFLINE_HEADER="Feedback form",b.OFFLINE_TEXT="Vi er desv?rre ikke online i ojeblikket. Efterlad en besked og vi svarer tilbage pa e-mail",b.PAGE_TITLE="Live Chat",b.URL_NEW_TAB="in a separate tab",
b.TITLE_NEW_TAB="in a separate tab",b.WEBSITE="http://cekura.dk/",b.TYPING_LABEL=" skriver",b.PROMPT_LABEL="Du bliver nu stillet videre til en ny side. Tillad",b.PROMPT_BUTTON_YES="Ja",b.PROMPT_BUTTON_NO="Nej",b.NOTIFICATION_HEADER="Besked fra operator",b.OPERATOR_REDIRECT="Operator wants to switch you",b.OPERATOR_REDIRECT_OK="Du chatter nu med ",b.OPERATOR_CONNECTING="Operator logger pa, vent venligst",b.NO_PREFERRED_OPERATOR="Denne operator er desv?rre optaget. Stiller om til anden",b.TOO_LONG=
"Maxl?ngde pa beskeden er overskredet",b.LEAVE_MESSAGE="Efterlade en besked";if(j&&j==="lv")b.CHAT_LABEL="Ievadiet savu zi\u0146u \u0161eit",b.EMAIL_INCORRECT="Neder\u012bgs e-pasts",b.EMAIL_LABEL="J\u016bsu e-pasts",b.FAILED_TO_SEND="K\u013c\u016bda s\u016btot zi\u0146ojumus",b.INCORRECT_EMAIL="Neder\u012bga e-pasta adrese",b.MAIL_SENT="Offline-Zi\u0146ojums ir nos\u016bt\u012bts",b.MAIL_SUCCESS="Offline-Zi\u0146a tika nos\u016bt\u012bta veiksm\u012bgi",b.MESSAGE_LABEL="Ievadiet savu Offline-zi\u0146u \u0161eit",
b.NAME_LABEL="J\u016bsu v\u0101rds",b.NO_PREFERRED_OPERATOR="Pa\u0161reiz\u0113jais operators nav uz vietas, Jums ir saist\u012bts ar citu operatoru",b.NOT_ALL_FIELDS="Jums vajag aizpild\u012bt visus laukus",b.NOTIFICATION_HEADER="Zi\u0146ojums no operatora",b.OFFLINE_HEADER="Atsauksmes forma",b.OFFLINE_TEXT="Visi m\u016bsu operatori ir atvienoju\u0161ies. Atst\u0101t zi\u0146u un m\u0113s atbild\u0113sim uz to tuv\u0101kaj\u0101 laik\u0101.",b.OPERATOR_CONNECTING="Savieno j\u016bs ar operatoru, uzgaidiet",
b.OPERATOR_REDIRECT="Operators s\u016bta t\u0113rz\u0113\u0161anu citam operatoram",b.OPERATOR_REDIRECT_OK="Ir savienots ar jums ",b.PAGE_TITLE="Online konsultants",b.PROMPT_BUTTON_NO="N\u0113",b.PROMPT_BUTTON_YES="J\u0101",b.PROMPT_LABEL="Operators pied\u0101v\u0101 p\u0101rcelties uz citu lapu. Iet?",b.SEND_BUTTON="Nos\u016bt\u012bt",b.THROBBER="S\u016bt\u012b\u0161ana...",b.TITLE_NEW_TAB="Atsevi\u0161\u0137\u0101 ciln\u0113",b.TOO_LONG="P\u0101rsniegta maksim\u0101la garuma nos\u016bt\u012b\u0161anai",
b.TYPING_LABEL="atbild",b.URL_NEW_TAB="atsevi\u0161\u0137\u0101 ciln\u0113",b.YOU_LABEL="J\u016bs",b.YES_LABEL="J\u0101",b.NO_LABEL="N\u0113",b.MINIMIZE_CHAT="nosl\u0113pt \u010datu",b.MAXIMIZE_CHAT="atv\u0113rt atsevi\u0161\u0137\u0101 ciln\u0113",b.NEW_MESSAGE="Jauns zi\u0146ojums no operatora",b.BADGE_LABEL="Uzdot jaut\u0101jumu",b.SOUND_ONOFF="Iesl\u0113gt / izsl\u0113gt ska\u0146u",b.HIGHLIGHT_LABEL="Piev\u0113rstet uzman\u012bbu",b.HIGHLIGHT_LINK="P\u0101riet",b.HINT_CLOSE="Spiediet, lai aizv\u0113rt",
b.DEFAULT_LABEL="Uzdot jaut\u0101jumu",b.LEAVE_MESSAGE="Atst\u0101t zi\u0146u";if(j&&j==="en")b.CHAT_LABEL="Type your message here",b.YOU_LABEL="You",b.EMAIL_INCORRECT="The email you specified is incorrect",b.FAILED_TO_SEND="Failed to send message",b.INCORRECT_EMAIL="The email is incorrect",b.NOT_ALL_FIELDS="Not all fields filled",b.MAIL_SUCCESS="Your message has been sent successfully",b.MAIL_SENT="The message has been sent",b.SEND_BUTTON="Send",b.THROBBER="Wait please...",b.MESSAGE_LABEL="Message:",
b.EMAIL_LABEL="Your e-mail:",b.NAME_LABEL="Your name:",b.OFFLINE_HEADER="Feedback form",b.OFFLINE_TEXT="We are offline at the moment. Please leave a message and we will answer it by email.",b.PAGE_TITLE="Live Chat",b.URL_NEW_TAB="in a separate tab",b.TITLE_NEW_TAB="in a separate tab",b.WEBSITE="http://redhelper.net",b.TYPING_LABEL=" is typing",b.PROMPT_LABEL="Operator wants to redirect you to another page. Allow?",b.PROMPT_BUTTON_YES="Yes",b.PROMPT_BUTTON_NO="No",b.NOTIFICATION_HEADER="Message from operator",
b.OPERATOR_REDIRECT="Operator wants to switch you",b.OPERATOR_REDIRECT_OK="You are now chatting with ",b.OPERATOR_CONNECTING="Operator is connecting, please wait",b.NO_PREFERRED_OPERATOR="Current operator is unavailable, connected to another",b.TOO_LONG="Maximum message length exceed",b.PHONE_LABEL="Your phone:",b.PHONE_MESSAGE="Phone",b.INCORRECT_PHONE="The phone is incorrect",b.ALL_OFFLINE="Operators offline",b.LEAVE_MESSAGE="Leave message",b.DEFAULT_FIRST_MESSAGE="Hello! How can I help you?";if(j&&
j==="ru")b.CHAT_LABEL="\u0412\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",b.YOU_LABEL="\u0412\u044b",b.EMAIL_INCORRECT="\u0412\u044b \u0432\u0432\u0435\u043b\u0438 \u043d\u0435\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 e-mail",b.FAILED_TO_SEND="\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",b.INCORRECT_EMAIL=
"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 email \u0430\u0434\u0440\u0435\u0441\u0430",b.NOT_ALL_FIELDS="\u0412\u044b \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u043b\u0438 \u043d\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f",b.MAIL_SUCCESS="\u0412\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e",b.MAIL_SENT="\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0431\u044b\u043b\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e",
b.SEND_BUTTON="\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",b.THROBBER="\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430...",b.MESSAGE_LABEL="\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435:",b.EMAIL_LABEL="\u0412\u0430\u0448 e-mail:",b.NAME_LABEL="\u0412\u0430\u0448\u0435 \u0438\u043c\u044f:",b.OFFLINE_HEADER="\u0424\u043e\u0440\u043c\u0430 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0441\u0432\u044f\u0437\u0438",b.OFFLINE_TEXT="\u0412\u0441\u0435 \u043d\u0430\u0448\u0438 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u0441\u0435\u0439\u0447\u0430\u0441 \u043e\u0444\u043b\u0430\u0439\u043d. \u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0438 \u043c\u044b \u043e\u0442\u0432\u0435\u0442\u0438\u043c \u043d\u0430 \u043d\u0435\u0433\u043e \u0432 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f.",
b.PAGE_TITLE="\u041e\u043d\u043b\u0430\u0439\u043d \u043a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u043d\u0442",b.URL_NEW_TAB="\u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0439 \u0432\u043a\u043b\u0430\u0434\u043a\u0435",b.TITLE_NEW_TAB="\u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0439 \u0432\u043a\u043b\u0430\u0434\u043a\u0435",b.WEBSITE="http://redhelper.ru",b.TYPING_LABEL=" \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442",b.PROMPT_LABEL="\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0435\u0442 \u0412\u0430\u043c \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443. \u041f\u0435\u0440\u0435\u0439\u0442\u0438?",
b.PROMPT_BUTTON_YES="\u0414\u0430",b.PROMPT_BUTTON_NO="\u041d\u0435\u0442",b.NOTIFICATION_HEADER="\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0442 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430",b.OPERATOR_REDIRECT="\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442 \u0447\u0430\u0442 \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0443",b.OPERATOR_REDIRECT_OK="\u041a \u0432\u0430\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u043b\u0441\u044f \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 ",
b.OPERATOR_CONNECTING="\u041a \u0432\u0430\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435",b.NO_PREFERRED_OPERATOR="\u0422\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430 \u043d\u0435\u0442 \u043d\u0430 \u043c\u0435\u0441\u0442\u0435, \u0432\u044b \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u043a \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0443",
b.TOO_LONG="\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",b.PHONE_LABEL="\u0412\u0430\u0448 \u0442\u0435\u043b\u0435\u0444\u043e\u043d:",b.PHONE_MESSAGE="\u0422\u0435\u043b\u0435\u0444\u043e\u043d",b.INCORRECT_PHONE="\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",
b.ALL_OFFLINE="\u0412\u0441\u0435 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u043e\u0444\u043b\u0430\u0439\u043d",b.LEAVE_MESSAGE="\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",b.DEFAULT_FIRST_MESSAGE="\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435, \u043c\u043e\u0433\u0443 \u043b\u0438 \u044f \u0412\u0430\u043c \u0447\u0435\u043c-\u0442\u043e \u043f\u043e\u043c\u043e\u0447\u044c?";if(!a.free&&d&&d.Lang)for(e in b)b.hasOwnProperty(e)&&
d.Lang.hasOwnProperty(e)&&(b[e]=d.Lang[e])};b.initLanguage();return b});redhelper.define("common/constants/sender",{VISITOR:0,OPERATOR:1});
redhelper.define("common/application/time",[],function(){var a=null,d=null,b={now:function(){a=new Date;return b},parse:function(e){a=new Date(Date.parse(e));if(!d)return this;a.setHours(a.getHours()+d[0]);a.setMinutes(a.getMinutes()+d[1]);a.setSeconds(a.getSeconds()+d[2]);return b},setTimeDifference:function(a){var j=a.split(" ")[1]=="PM"?12:0,a=a.split(" ")[0].split(":");a[0]=+a[0]+j;var j=new Date,f=[j.getHours(),j.getMinutes(),j.getSeconds()];d=a.map(function(a,b){return f[b]-a});return b},toString:function(){if(!a)return"";
var b=[a.getHours(),a.getMinutes(),a.getSeconds()];b.forEach(function(a,d){a<10&&(b[d]="0"+a)});return b.join(":")},getTime:function(){return a.getTime()}};return b});
redhelper.define("view/template",["application/session.objects","common/extensions/jquery.plugins","config/setup"],function(a,d,b){return{processTemplate:function(e,j){e=d(e).clone();e.removeAttr("id");var e=d("<div></div>").append(e).html(),f=/%(\w+)%/g,c;for(c=f.exec(e);c;c=f.exec(e)){j&&j.hasOwnProperty(c[1])&&(e=e.replace(RegExp("%"+c[1]+"%","g"),j[c[1]]));try{a&&Object.prototype.hasOwnProperty.call(a,c[1])&&(e=c[1]==="operAvatar"?e.replace(RegExp("%"+c[1]+"%","g"),b.DATA_URL+"/images/"+a[c[1]]):
e.replace(RegExp("%"+c[1]+"%","g"),a[c[1]]))}catch(k){}}f=/#(\w+)#/g;for(c=f.exec(e);c;c=f.exec(e))a&&Object.prototype.hasOwnProperty.call(a,c[1])&&(e=e.replace(RegExp("#"+c[1]+"#","g"),'<span class="redhlp_'+c[1]+'">'+a[c[1]]+"</span>"));return e}}});
redhelper.define("common/extensions/browserDetect",[],function(){var a={init:function(){this.browser=this.searchString(this.dataBrowser)||"-";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"";this.OS=this.searchString(this.dataOS)||"-";if(this.browser=="Opera"&&navigator.userAgent.split("Version/")[1])this.version=navigator.userAgent.split("Version/")[1];this.isMobile=navigator.userAgent.indexOf("Mobile")>-1},searchString:function(a){for(var b=0;b<
a.length;b++){var e=a[b].string,j=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(e){if(e.indexOf(a[b].subString)!=-1)return a[b].identity}else if(j)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);return b==-1?void 0:parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},
{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},
{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"Android",
identity:"Android"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],isMobile:!1};a.init();return a});
redhelper.define("view/chat","common/extensions/jquery.plugins,application/dispatcher,common/constants/sender,application/session.objects,config/lang,common/constants/chatState,application/parent,common/application/time,view/template,common/extensions/browserDetect".split(","),function(a,d,b,e,j,f,c,k,n,t){a.valHooks.textarea={get:function(a){return a.value.replace(/\r?\n/g,"\r\n")}};var r=!1,q=null,m={_displayElem:null,_lastMessageFrom:null,_typingTimer:0,_isTyping:!1,_messages:[],_highlightLinks:function(a){return a.replace(/(((http|https|ftp)[:][\/][\/])?([\w\d_\-\.]*@)?(([\w\d_\-]+)\.)+\w{2,4}([\/]\S*)*)(\s|$)/g,
function(a,b){return'<a target="_blank" href="'+(b.indexOf("@")>-1?"mailto:":b.indexOf("://")>-1?"":"http://")+b+'">'+b+"</a>"})},_escapeHtml:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\n/g,"<br>")},_decorate:function(c,d,e,f){var k=e!==void 0;d===void 0&&(d=!1);var j=c.text,m={},q;for(q in c)c.hasOwnProperty(q)&&(m[q]=c[q]);d||(j=!f?this._highlightLinks(this._escapeHtml(c.text)):c.text);m.text=j;f=c.sender===b.OPERATOR?"fromOperator":
"fromVisitor";j=n.processTemplate("#"+f,m);m=n.processTemplate("#"+f+"Header",m);j=a(j);(this._lastMessageFrom!==c.sender||d)&&j.prepend(m);m=a("<div></div>").append(j).html();k&&(this._lastMessageFrom!==c.sender?a(".msgBlock").length?a(".msgBlock:last",e).after('<div class="msgBlock '+f+'">'+m+"</div>"):a("#invitation",e).after('<div class="msgBlock '+f+'">'+m+"</div>"):a(".msgBlock:last",e).append(m));if(!d)this._lastMessageFrom=c.sender;return m},setOutput:function(c){this._displayElem=typeof c===
"string"?a(c):c;this._displayElem.on("click",".promptButton",function(){if(a(this).hasClass("yes"))return d.fire("redirectOK",{link:a(this).data("link")}),!1;a(this).parents(".msg").fadeOut("slow",function(){if(!a(this).siblings().length)m._lastMessageFrom=b.VISITOR,a(this).parents(".msgBlock").remove();d.fire("redirectCancel")});return!0});q&&(m.showLabel(q.text,q.loading),q=null)},append:function(c){if(!c.hide&&!(c.text.indexOf(":g")===0||c.text.indexOf(":\u0433")===0)){for(var d=this._messages.length-
1;d>0&&this._messages[d].id&&this._messages[d].id>c.id;)d+=1;c.pushAfter=d>0?this._messages[d].id:0;if(!c.pushAfter||!(c.pushAfter===c.id&&this._messages[d].text===c.text))if(this._messages.push(c),this._messages.sort(function(a,b){return a.id&&b.id?a.id-b.id:(a.time<b.time)*-1+(a.time>b.time)}),this._displayElem){if(c.sender===b.VISITOR)c.displayName=j.YOU_LABEL;if(!c.time)c.time=k.now().toString();this._decorate(c,!1,this._displayElem);t.OS==="Android"&&navigator.userAgent.indexOf("Android 2")>
-1&&this._displayElem.css("height",a("body").height()/parseFloat(a("body").css("fontSize"))-16+"em");this.scrollBottom()}}},showTyping:function(){if(this._displayElem&&!this._isTyping){this._isTyping=!0;a("#typingLabel .text").html(e.operDisplayName+j.TYPING_LABEL+"...");a("#typingLabel").show();var b=3,c=a("#typingLabel .text",this._displayElem);this._typingTimer=setInterval(function(){b>2?(c.html(e.operDisplayName+j.TYPING_LABEL),b=0):(c.html(c.html()+"."),b+=1)},800);this.scrollBottom()}},showLabel:function(b,
c){this._displayElem?(c&&a("#chatLabel").addClass("loading"),a("#chatLabel").find(".text").html(b),a("#chatLabel").show(),this.scrollBottom()):q={text:b,loading:c}},hideLabel:function(){this._displayElem?(a("#chatLabel").removeClass("loading"),a("#chatLabel").hide(),this.scrollBottom()):q=null},hideTyping:function(){if(this._displayElem&&this._isTyping)a("#typingLabel").hide(),clearInterval(this._typingTimer),this._isTyping=!1},showFirstMessage:function(a){if(this._displayElem&&!r){if(a.sender===
b.VISITOR)a.displayName=j.YOU_LABEL;a.time=k.now().toString();this._displayElem.prepend(this._decorate(a,!0));r=!0;this.scrollBottom()}},scrollBottom:function(){var b=this._displayElem[0];b.scrollTop=b.scrollHeight;a(".time").disableTextSelect()},clear:function(){this._displayElem.html("");this._lastMessageFrom=null},showRedirectPrompt:function(a){this._displayElem&&(a.indexOf("://")<0&&(a="http://"+a),a='<div class="promptButtonWrapper"><div class="promptButton no">'+j.PROMPT_BUTTON_NO+'</div><div class="promptButton yes" data-link="'+
a+'">'+j.PROMPT_BUTTON_YES+'</div><div style="clear: both"></div></div>',this._decorate({displayName:e.operDisplayName,sender:b.OPERATOR,time:k.now().toString(),text:j.PROMPT_LABEL+a},!1,this._displayElem,!0,"prompt"),this.scrollBottom(),this.hideTyping(),e.chatState===f.MINIMIZED&&c.send("openChat"))},switchOperator:function(){if(m._lastMessageFrom===b.OPERATOR)m._lastMessageFrom=null}};d.addEventListener("showLabel",function(a){m.showLabel(a.text,a.loading)});d.addEventListener("hideLabel",function(){m.hideLabel()});
c.addHandler("resizeFont",function(b){a("body").css("font-size",b.size)});navigator.userAgent.indexOf("Android 2")>-1&&c.addHandler("chatOpened",function(){setTimeout(function(){m._displayElem.css("height",a("body").height()/parseFloat(a("body").css("fontSize"))-16+"em")},500)});return m});
redhelper.define("view/view","application/session.objects,config/lang,config/setup,common/extensions/jquery.plugins,view/chat,common/constants/sender,application/dispatcher,config/api,view/template,common/extensions/browserDetect".split(","),function(a,d,b,e,j,f,c,k,n,t){k.replaceCSS&&e("#rh-css").attr("href",k.replaceCSS);var r=function(a){j.hideLabel();j.switchOperator();a=d.OPERATOR_REDIRECT_OK+a.displayName;j.hideTyping();c.fire("showLabel",{text:a})},q={_firstMessageAppended:!1,_shown:!1,initLanguage:function(){if(a.locale){if(d.initLanguage(),
e("#offline .header").html(d.OFFLINE_HEADER),e("#offline .description").html(d.OFFLINE_TEXT),e(".name label").html(d.NAME_LABEL),e(".email label").html(d.EMAIL_LABEL),e(".message label").html(d.MESSAGE_LABEL),e(".phone label").html(d.PHONE_LABEL),e("#sendButton").text(d.SEND_BUTTON),e("#throbber").text(d.THROBBER),e("#offlineSuccess div").text(d.MAIL_SUCCESS),e("#footer a").attr("href",d.WEBSITE),e("#typingLabel .text").html(d.TYPING_LABEL),!e("#online textarea").is(":focus")){var b=a.currentTypedText;
b&&e("#online textarea").val(b);!b&&!t.isMobile&&e("#online textarea").val(d.CHAT_LABEL)}}else setTimeout(function(){q.initLanguage()},100)},show:function(){if(!b.empty(a.skin)&&!b.empty(a.isOnline)){q.initLanguage();a.free?(e("body").addClass("free"),e("#rh-copy").find("a").attr("href","http://redhelper.ru/?copy=limited")):e("#rh-copy").find("a").attr("href","http://redhelper.ru/?copy=pale");(function(){var b=0,c=e("#offline"),d=3.434;c.find(".inputField").hide();a.offlineFields.indexOf("name")>
-1&&(b+=d,d+=0.334,c.find(".name").show());a.offlineFields.indexOf("email")>-1&&(b+=d,d+=0.334,c.find(".email").show());a.offlineFields.indexOf("phone")>-1&&(b+=d,c.find(".phone").show());a.offlineFields.indexOf("message")>-1&&c.find(".message").css("top",b+"em").show()})();document.title=b.PAGE_TITLE;a.offlineText&&e("#offline .description").html(a.offlineText);a.offlineHeader&&e("#offline .header").html(a.offlineHeader);a.currentHeader?e("#topHeader").html(a.currentHeader):e("#topHeader").html(a.defaultHeader);
a.currentTopText?e("#topText").html(a.currentTopText):e("#topText").html(a.defaultText);if(!a.free){a.chatColor&&e(".colorifier").css("background","#"+a.chatColor);a.dispatcher.addEventListener("onChatColorChanged",function(){a.chatColor?e(".colorifier").css("background","#"+a.chatColor):e(".colorifier").css("background","none")});a.chatIntensity&&e(".colorifier").css({opacity:a.chatIntensity/600});a.dispatcher.addEventListener("onChatIntensityChanged",function(){a.chatIntensity?e(".colorifier").css({opacity:a.chatIntensity/
600}):e(".colorifier").css({opacity:0.6})});var k=function(){if((a.defaultFace||a.operAvatar)&&b.DATA_URL)e("#face, .face").attr("src",a.currentOperAvatar||b.DATA_URL+"/images/"+(a.operAvatar||a.defaultFace))};k();a.dispatcher.addEventListener("onOperAvatarChanged",k);a.dispatcher.addEventListener("onFaceChanged",k)}e(".topPanel, #footer, #sendButton, label").disableTextSelect();e(".topPanel").mousedown(function(a){a.stopPropagation()});e(a.isOnline?"#offline":"#online").hide();e(a.isOnline?"#online":
"#offline").show();c.addEventListener("changeState",function(b){a.isOnline=b.online;a.isOnline?(e("#offline").hide(),e("#online").show(),c.fire("enableChat")):a.chatStarted?c.fire("disableChat",{reason:d.ALL_OFFLINE+(a.offlineEnabled?"<br><a href='#offline'>"+d.LEAVE_MESSAGE+"</a>":"")}):(e("#online").hide(),e("#offline").show())});c.addEventListener("typing",function(){j.showTyping();j.hideLabel()});c.addEventListener("message",function(a){a.sender===f.OPERATOR&&j.hideTyping()});c.addEventListener("operatorRedirect",
function(){c.fire("showLabel",{text:d.OPERATOR_REDIRECT})});c.removeEventListener("operatorRedirectOk",r);c.addEventListener("operatorRedirectOk",r);c.addEventListener("operatorRedirectFail",function(){j.hideLabel()})}},hide:function(){e("#online, #offline").hide()},setTemplate:function(a){var b=[],a=a.replace(/<template/i,"<div"),a=a.replace(/\/template/i,"/div");e(a).each(function(a){a!==0&&(e(this).attr("src")?b.push({src:e(this).attr("src")}):b.push({code:e(this).html()}))});var a=e(a),d=a.find("#fromOperator, #fromOperatorHeader, #fromVisitor, #fromVisitorHeader").detach(),
a=n.processTemplate(a);e("#container").html(e(a).html()+e("<div/>").append(d).html());if(b.length){var f=-1,k=function(){f++;b[f].src?e.getScript(b[f].src,k):(eval(b[f].code),k())};c.addEventListener("ready",function(){k()})}c.fire("templateProcessed")}},m=function(a){c.removeEventListener(m);q.setTemplate(a.template)};c.addEventListener("templateReceived",m);return q});
var Base64=function(){return{encode:function(a){var d="",b,e,j,f,c,k,n=0;do b=a.charCodeAt(n++),e=a.charCodeAt(n++),j=a.charCodeAt(n++),f=b>>2,b=(b&3)<<4|e>>4,c=(e&15)<<2|j>>6,k=j&63,isNaN(e)?c=k=64:isNaN(j)&&(k=64),d=d+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k);
while(n<a.length);return d},decode:function(a){var d="",b,e,j,f,c,k=0,a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(k++)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(k++)),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(k++)),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(k++)),b=b<<2|e>>4,e=(e&15)<<
4|f>>2,j=(f&3)<<6|c,d+=String.fromCharCode(b),f!=64&&(d+=String.fromCharCode(e)),c!=64&&(d+=String.fromCharCode(j));while(k<a.length);return d}}}(),MD5=function(){var a=function(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535},d=function(a){for(var b=[],c=0;c<a.length*8;c+=8)b[c>>5]|=(a.charCodeAt(c/8)&255)<<c%32;return b},b=function(a){for(var b="",c=0;c<a.length*32;c+=8)b+=String.fromCharCode(a[c>>5]>>>c%32&255);return b},e=function(a){for(var b="",c=0;c<a.length*4;c++)b+=
"0123456789abcdef".charAt(a[c>>2]>>c%4*8+4&15)+"0123456789abcdef".charAt(a[c>>2]>>c%4*8&15);return b},j=function(a){for(var b="",c,d,e=0;e<a.length*4;e+=3){c=(a[e>>2]>>8*(e%4)&255)<<16|(a[e+1>>2]>>8*((e+1)%4)&255)<<8|a[e+2>>2]>>8*((e+2)%4)&255;for(d=0;d<4;d++)b+=e*8+d*6>a.length*32?"":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c>>6*(3-d)&63)}return b},f=function(b,c,d,e,f,k){b=a(a(c,b),a(e,k));return a(b<<f|b>>>32-f,d)},c=function(a,b,c,d,e,k,j){return f(b&c|~b&d,a,
b,e,k,j)},k=function(a,b,c,d,e,k,j){return f(b&d|c&~d,a,b,e,k,j)},n=function(a,b,c,d,e,k,j){return f(c^(b|~d),a,b,e,k,j)},t=function(b,d){b[d>>5]|=128<<d%32;b[(d+64>>>9<<4)+14]=d;for(var e=1732584193,i=-271733879,h=-1732584194,l=271733878,j,t,r,x,s=0;s<b.length;s+=16)j=e,t=i,r=h,x=l,e=c(e,i,h,l,b[s+0],7,-680876936),l=c(l,e,i,h,b[s+1],12,-389564586),h=c(h,l,e,i,b[s+2],17,606105819),i=c(i,h,l,e,b[s+3],22,-1044525330),e=c(e,i,h,l,b[s+4],7,-176418897),l=c(l,e,i,h,b[s+5],12,1200080426),h=c(h,l,e,i,b[s+
6],17,-1473231341),i=c(i,h,l,e,b[s+7],22,-45705983),e=c(e,i,h,l,b[s+8],7,1770035416),l=c(l,e,i,h,b[s+9],12,-1958414417),h=c(h,l,e,i,b[s+10],17,-42063),i=c(i,h,l,e,b[s+11],22,-1990404162),e=c(e,i,h,l,b[s+12],7,1804603682),l=c(l,e,i,h,b[s+13],12,-40341101),h=c(h,l,e,i,b[s+14],17,-1502002290),i=c(i,h,l,e,b[s+15],22,1236535329),e=k(e,i,h,l,b[s+1],5,-165796510),l=k(l,e,i,h,b[s+6],9,-1069501632),h=k(h,l,e,i,b[s+11],14,643717713),i=k(i,h,l,e,b[s+0],20,-373897302),e=k(e,i,h,l,b[s+5],5,-701558691),l=k(l,e,
i,h,b[s+10],9,38016083),h=k(h,l,e,i,b[s+15],14,-660478335),i=k(i,h,l,e,b[s+4],20,-405537848),e=k(e,i,h,l,b[s+9],5,568446438),l=k(l,e,i,h,b[s+14],9,-1019803690),h=k(h,l,e,i,b[s+3],14,-187363961),i=k(i,h,l,e,b[s+8],20,1163531501),e=k(e,i,h,l,b[s+13],5,-1444681467),l=k(l,e,i,h,b[s+2],9,-51403784),h=k(h,l,e,i,b[s+7],14,1735328473),i=k(i,h,l,e,b[s+12],20,-1926607734),e=f(i^h^l,e,i,b[s+5],4,-378558),l=f(e^i^h,l,e,b[s+8],11,-2022574463),h=f(l^e^i,h,l,b[s+11],16,1839030562),i=f(h^l^e,i,h,b[s+14],23,-35309556),
e=f(i^h^l,e,i,b[s+1],4,-1530992060),l=f(e^i^h,l,e,b[s+4],11,1272893353),h=f(l^e^i,h,l,b[s+7],16,-155497632),i=f(h^l^e,i,h,b[s+10],23,-1094730640),e=f(i^h^l,e,i,b[s+13],4,681279174),l=f(e^i^h,l,e,b[s+0],11,-358537222),h=f(l^e^i,h,l,b[s+3],16,-722521979),i=f(h^l^e,i,h,b[s+6],23,76029189),e=f(i^h^l,e,i,b[s+9],4,-640364487),l=f(e^i^h,l,e,b[s+12],11,-421815835),h=f(l^e^i,h,l,b[s+15],16,530742520),i=f(h^l^e,i,h,b[s+2],23,-995338651),e=n(e,i,h,l,b[s+0],6,-198630844),l=n(l,e,i,h,b[s+7],10,1126891415),h=n(h,
l,e,i,b[s+14],15,-1416354905),i=n(i,h,l,e,b[s+5],21,-57434055),e=n(e,i,h,l,b[s+12],6,1700485571),l=n(l,e,i,h,b[s+3],10,-1894986606),h=n(h,l,e,i,b[s+10],15,-1051523),i=n(i,h,l,e,b[s+1],21,-2054922799),e=n(e,i,h,l,b[s+8],6,1873313359),l=n(l,e,i,h,b[s+15],10,-30611744),h=n(h,l,e,i,b[s+6],15,-1560198380),i=n(i,h,l,e,b[s+13],21,1309151649),e=n(e,i,h,l,b[s+4],6,-145523070),l=n(l,e,i,h,b[s+11],10,-1120210379),h=n(h,l,e,i,b[s+2],15,718787259),i=n(i,h,l,e,b[s+9],21,-343485551),e=a(e,j),i=a(i,t),h=a(h,r),l=
a(l,x);return[e,i,h,l]},r=function(a,b){var c=d(a);c.length>16&&(c=t(c,a.length*8));for(var e=Array(16),f=Array(16),k=0;k<16;k++)e[k]=c[k]^909522486,f[k]=c[k]^1549556828;c=t(e.concat(d(b)),512+b.length*8);return t(f.concat(c),640)};return{hexdigest:function(a){return e(t(d(a),a.length*8))},b64digest:function(a){return j(t(d(a),a.length*8))},hash:function(a){return b(t(d(a),a.length*8))},hmac_hexdigest:function(a,b){return e(r(a,b))},hmac_b64digest:function(a,b){return j(r(a,b))},hmac_hash:function(a,
c){return b(r(a,c))},test:function(){return MD5.hexdigest("abc")==="900150983cd24fb0d6963f7d28e17f72"}}}();if(!Function.prototype.bind)Function.prototype.bind=function(a){var d=this,b=Array.prototype.slice,e=Array.prototype.concat,j=b.call(arguments,1);return function(){return d.apply(a?a:this,e.call(j,b.call(arguments,0)))}};
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a,d){var b=this.length,e=Number(d)||0,e=e<0?Math.ceil(e):Math.floor(e);for(e<0&&(e+=b);e<b;e++)if(e in this&&this[e]===a)return e;return-1};
(function(a){function d(a,b){return new f.Builder(a,b)}function b(a){return new f.Builder("message",a)}function e(a){return new f.Builder("iq",a)}function j(a){return new f.Builder("presence",a)}var f;f={VERSION:"1.0.2",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",
SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas"},addNamespace:function(a,b){f.NS[a]=b},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4},TIMEOUT:1.1,
SECONDARY_TIMEOUT:0.1,forEachChild:function(a,b,d){var e,j;for(e=0;e<a.childNodes.length;e++)j=a.childNodes[e],j.nodeType==f.ElementType.NORMAL&&(!b||this.isTagEqual(j,b))&&d(j)},isTagEqual:function(a,b){return a.tagName.toLowerCase()==b.toLowerCase()},_xmlGenerator:null,_makeGenerator:function(){var a;document.implementation.createDocument===void 0?(a=this._getIEXmlDom(),a.appendChild(a.createElement("strophe"))):a=document.implementation.createDocument("jabber:client","strophe",null);return a},
xmlGenerator:function(){if(!f._xmlGenerator)f._xmlGenerator=f._makeGenerator();return f._xmlGenerator},_getIEXmlDom:function(){for(var a=null,b="Msxml2.DOMDocument.6.0,Msxml2.DOMDocument.5.0,Msxml2.DOMDocument.4.0,MSXML2.DOMDocument.3.0,MSXML2.DOMDocument,MSXML.DOMDocument,Microsoft.XMLDOM".split(","),d=0;d<b.length;d++)if(a===null)try{a=new ActiveXObject(b[d])}catch(e){a=null}else break;return a},xmlElement:function(a){if(!a)return null;var b=f.xmlGenerator().createElement(a),d,e,j;for(d=1;d<arguments.length;d++)if(arguments[d])if(typeof arguments[d]==
"string"||typeof arguments[d]=="number")b.appendChild(f.xmlTextNode(arguments[d]));else if(typeof arguments[d]=="object"&&typeof arguments[d].sort=="function")for(e=0;e<arguments[d].length;e++)typeof arguments[d][e]=="object"&&typeof arguments[d][e].sort=="function"&&b.setAttribute(arguments[d][e][0],arguments[d][e][1]);else if(typeof arguments[d]=="object")for(j in arguments[d])arguments[d].hasOwnProperty(j)&&b.setAttribute(j,arguments[d][j]);return b},xmlescape:function(a){a=a.replace(/\&/g,"&amp;");
a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/'/g,"&apos;");return a=a.replace(/"/g,"&quot;")},xmlTextNode:function(a){a=f.xmlescape(a);return f.xmlGenerator().createTextNode(a)},getText:function(a){if(!a)return null;var b="";a.childNodes.length===0&&a.nodeType==f.ElementType.TEXT&&(b+=a.nodeValue);for(var d=0;d<a.childNodes.length;d++)a.childNodes[d].nodeType==f.ElementType.TEXT&&(b+=a.childNodes[d].nodeValue);return b},copyElement:function(a){var b,d;if(a.nodeType==f.ElementType.NORMAL){d=
f.xmlElement(a.tagName);for(b=0;b<a.attributes.length;b++)d.setAttribute(a.attributes[b].nodeName.toLowerCase(),a.attributes[b].value);for(b=0;b<a.childNodes.length;b++)d.appendChild(f.copyElement(a.childNodes[b]))}else a.nodeType==f.ElementType.TEXT&&(d=f.xmlGenerator().createTextNode(a.nodeValue));return d},escapeNode:function(a){return a.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,
"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(a){return a.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(a){return a.indexOf("@")<0?null:a.split("@")[0]},getDomainFromJid:function(a){a=f.getBareJidFromJid(a);return a.indexOf("@")<0?a:(a=a.split("@"),a.splice(0,1),
a.join("@"))},getResourceFromJid:function(a){a=a.split("/");if(a.length<2)return null;a.splice(0,1);return a.join("/")},getBareJidFromJid:function(a){return a?a.split("/")[0]:null},log:function(){},debug:function(a){this.log(this.LogLevel.DEBUG,a)},info:function(a){this.log(this.LogLevel.INFO,a)},warn:function(a){this.log(this.LogLevel.WARN,a)},error:function(a){this.log(this.LogLevel.ERROR,a)},fatal:function(a){this.log(this.LogLevel.FATAL,a)},serialize:function(a){var b;if(!a)return null;typeof a.tree===
"function"&&(a=a.tree());var d=a.nodeName,e,j;a.getAttribute("_realname")&&(d=a.getAttribute("_realname"));b="<"+d;for(e=0;e<a.attributes.length;e++)a.attributes[e].nodeName!="_realname"&&(b+=" "+a.attributes[e].nodeName.toLowerCase()+"='"+a.attributes[e].value.replace(/&/g,"&amp;").replace(/\'/g,"&apos;").replace(/</g,"&lt;")+"'");if(a.childNodes.length>0){b+=">";for(e=0;e<a.childNodes.length;e++)switch(j=a.childNodes[e],j.nodeType){case f.ElementType.NORMAL:b+=f.serialize(j);break;case f.ElementType.TEXT:b+=
f.xmlescape(j.nodeValue);break;case f.ElementType.CDATA:b+="<![CDATA["+j.nodeValue+"]]\>"}b+="</"+d+">"}else b+="/>";return b},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(a,b){f._connectionPlugins[a]=b}};f.Builder=function(a,b){if(a=="presence"||a=="message"||a=="iq")b&&!b.xmlns?b.xmlns=f.NS.CLIENT:b||(b={xmlns:f.NS.CLIENT});this.node=this.nodeTree=f.xmlElement(a,b)};f.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return f.serialize(this.nodeTree)},
up:function(){this.node=this.node.parentNode;return this},attrs:function(a){for(var b in a)a.hasOwnProperty(b)&&this.node.setAttribute(b,a[b]);return this},c:function(a,b,d){a=f.xmlElement(a,b,d);this.node.appendChild(a);if(!d)this.node=a;return this},cnode:function(a){var b=f.xmlGenerator();try{var d=b.importNode!==void 0}catch(e){d=!1}a=d?b.importNode(a,!0):f.copyElement(a);this.node.appendChild(a);this.node=a;return this},t:function(a){this.node.appendChild(f.xmlTextNode(a));return this}};f.Handler=
function(a,b,d,e,j,q,m){this.handler=a;this.ns=b;this.name=d;this.type=e;this.id=j;this.options=m||{matchbare:!1};if(!this.options.matchBare)this.options.matchBare=!1;this.from=this.options.matchBare?q?f.getBareJidFromJid(q):null:q;this.user=!0};f.Handler.prototype={isMatch:function(a){var b,d=null,d=this.options.matchBare?f.getBareJidFromJid(a.getAttribute("from")):a.getAttribute("from");b=!1;if(this.ns){var e=this;f.forEachChild(a,null,function(a){a.getAttribute("xmlns")==e.ns&&(b=!0)});b=b||a.getAttribute("xmlns")==
this.ns}else b=!0;return b&&(!this.name||f.isTagEqual(a,this.name))&&(!this.type||a.getAttribute("type")==this.type)&&(!this.id||a.getAttribute("id")==this.id)&&(!this.from||d==this.from)?!0:!1},run:function(a){var b=null;try{b=this.handler(a)}catch(d){throw d.sourceURL?f.fatal("error: "+this.handler+" "+d.sourceURL+":"+d.line+" - "+d.name+": "+d.message):d.fileName?(typeof console!="undefined"&&(console.trace(),console.error(this.handler," - error - ",d,d.message)),f.fatal("error: "+this.handler+
" "+d.fileName+":"+d.lineNumber+" - "+d.name+": "+d.message)):f.fatal("error: "+this.handler),d;}return b},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}};f.TimedHandler=function(a,b){this.period=a;this.handler=b;this.lastCalled=(new Date).getTime();this.user=!0};f.TimedHandler.prototype={run:function(){this.lastCalled=(new Date).getTime();return this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+
this.handler+"("+this.period+")}"}};f.Request=function(a,b,d,e){this.id=++f._requestId;this.xmlData=a;this.data=f.serialize(a);this.func=this.origFunc=b;this.rid=d;this.date=NaN;this.sends=e||0;this.abort=!1;this.dead=null;this.age=function(){return!this.date?0:(new Date-this.date)/1E3};this.timeDead=function(){return!this.dead?0:(new Date-this.dead)/1E3};this.xhr=this._newXHR()};f.Request.prototype={getResponse:function(){var a=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if(a=
this.xhr.responseXML.documentElement,a.tagName=="parsererror")throw f.error("invalid response received"),f.error("responseText: "+this.xhr.responseText),f.error("responseXML: "+f.serialize(this.xhr.responseXML)),"parsererror";}else this.xhr.responseText&&(f.error("invalid response received"),f.error("responseText: "+this.xhr.responseText),f.error("responseXML: "+f.serialize(this.xhr.responseXML)));return a},_newXHR:function(){var a=null;window.XMLHttpRequest?(a=new XMLHttpRequest,a.overrideMimeType&&
a.overrideMimeType("text/xml")):window.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP"));a.onreadystatechange=this.func.bind(null,this);return a}};f.Connection=function(a){this.service=a;this.jid="";this.rid=Math.floor(Math.random()*4294967295);this.features=this.streamId=this.sid=null;this.do_bind=this.do_session=!1;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this._disconnectTimeout=this._idleTimeout=null;this.connected=
this.disconnecting=this.authenticated=!1;this.errors=0;this.paused=!1;this.hold=1;this.wait=60;this.window=5;this._data=[];this._requests=[];this._uniqueId=Math.round(Math.random()*1E4);this._sasl_challenge_handler=this._sasl_failure_handler=this._sasl_success_handler=null;this._idleTimeout=setTimeout(this._onIdle.bind(this),100);for(var b in f._connectionPlugins)if(f._connectionPlugins.hasOwnProperty(b))a=function(){},a.prototype=f._connectionPlugins[b],this[b]=new a,this[b].init(this)};f.Connection.prototype=
{reset:function(){this.rid=Math.floor(Math.random()*4294967295);this.streamId=this.sid=null;this.do_bind=this.do_session=!1;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this.connected=this.disconnecting=this.authenticated=!1;this.errors=0;this._requests=[];this._uniqueId=Math.round(Math.random()*1E4)},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(a){return typeof a=="string"||typeof a==
"number"?++this._uniqueId+":"+a:++this._uniqueId+""},connect:function(a,b,d,e,j){this.jid=a;this.pass=b;this.connect_callback=d;this.authenticated=this.connected=this.disconnecting=!1;this.errors=0;this.wait=e||this.wait;this.hold=j||this.hold;this.domain=f.getDomainFromJid(this.jid);a=this._buildBody().attrs({to:this.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":f.NS.BOSH});this._changeConnectStatus(f.Status.CONNECTING,
null);this._requests.push(new f.Request(a.tree(),this._onRequestStateChange.bind(this,this._connect_cb.bind(this)),a.tree().getAttribute("rid")));this._throttledRequestHandler()},attach:function(a,b,d,e,j,q,m){this.jid=a;this.sid=b;this.rid=d;this.connect_callback=e;this.domain=f.getDomainFromJid(this.jid);this.connected=this.authenticated=!0;this.wait=j||this.wait;this.hold=q||this.hold;this.window=m||this.window;this._changeConnectStatus(f.Status.ATTACHED,null)},xmlInput:function(){},xmlOutput:function(){},
rawInput:function(){},rawOutput:function(){},send:function(a){if(a!==null){if(typeof a.sort==="function")for(var b=0;b<a.length;b++)this._queueData(a[b]);else typeof a.tree==="function"?this._queueData(a.tree()):this._queueData(a);this._throttledRequestHandler();clearTimeout(this._idleTimeout);this._idleTimeout=setTimeout(this._onIdle.bind(this),100)}},flush:function(){clearTimeout(this._idleTimeout);this._onIdle()},sendIQ:function(a,b,d,e){var f=null,j=this;typeof a.tree==="function"&&(a=a.tree());
var m=a.getAttribute("id");m||(m=this.getUniqueId("sendIQ"),a.setAttribute("id",m));var p=this.addHandler(function(a){f&&j.deleteTimedHandler(f);var c=a.getAttribute("type");if(c=="result")b&&b(a);else if(c=="error")d&&d(a);else throw{name:"StropheError",message:"Got bad IQ type of "+c};},null,"iq",null,m);e&&(f=this.addTimedHandler(e,function(){j.deleteHandler(p);d&&d(null);return!1}));this.send(a);return m},_queueData:function(a){if(a===null||!a.tagName||!a.childNodes)throw{name:"StropheError",
message:"Cannot queue non-DOMElement."};this._data.push(a)},_sendRestart:function(){this._data.push("restart");this._throttledRequestHandler();clearTimeout(this._idleTimeout);this._idleTimeout=setTimeout(this._onIdle.bind(this),100)},addTimedHandler:function(a,b){var d=new f.TimedHandler(a,b);this.addTimeds.push(d);return d},deleteTimedHandler:function(a){this.removeTimeds.push(a)},addHandler:function(a,b,d,e,j,q,m){a=new f.Handler(a,b,d,e,j,q,m);this.addHandlers.push(a);return a},deleteHandler:function(a){this.removeHandlers.push(a)},
disconnect:function(a){this._changeConnectStatus(f.Status.DISCONNECTING,a);f.info("Disconnect was called because: "+a);if(this.connected)this._disconnectTimeout=this._addSysTimedHandler(3E3,this._onDisconnectTimeout.bind(this)),this._sendTerminate()},_changeConnectStatus:function(a,b){for(var d in f._connectionPlugins)if(f._connectionPlugins.hasOwnProperty(d)){var e=this[d];if(e.statusChanged)try{e.statusChanged(a,b)}catch(j){f.error(""+d+" plugin caused an exception changing status: "+j)}}if(this.connect_callback)try{this.connect_callback(a,
b)}catch(q){f.error("User connection callback caused an exception: "+q)}},_buildBody:function(){var a=d("body",{rid:this.rid++,xmlns:f.NS.HTTPBIND});this.sid!==null&&a.attrs({sid:this.sid});return a},_removeRequest:function(a){f.debug("removing request");var b;for(b=this._requests.length-1;b>=0;b--)a==this._requests[b]&&this._requests.splice(b,1);a.xhr.onreadystatechange=function(){};this._throttledRequestHandler()},_restartRequest:function(a){var b=this._requests[a];if(b.dead===null)b.dead=new Date;
this._processRequest(a)},_processRequest:function(a){var b=this._requests[a],d=-1;try{if(b.xhr.readyState==4)d=b.xhr.status}catch(e){f.error("caught an error in _requests["+a+"], reqStatus: "+d)}typeof d=="undefined"&&(d=-1);if(b.sends>5)this._onDisconnectTimeout();else{var j=b.age(),j=!isNaN(j)&&j>Math.floor(f.TIMEOUT*this.wait),q=b.dead!==null&&b.timeDead()>Math.floor(f.SECONDARY_TIMEOUT*this.wait),d=b.xhr.readyState==4&&(d<1||d>=500);if(j||q||d)q&&f.error("Request "+this._requests[a].id+" timed out (secondary), restarting"),
b.abort=!0,b.xhr.abort(),b.xhr.onreadystatechange=function(){},this._requests[a]=new f.Request(b.xmlData,b.origFunc,b.rid,b.sends),b=this._requests[a];if(b.xhr.readyState===0){f.debug("request id "+b.id+"."+b.sends+" posting");try{b.xhr.open("POST",this.service,!0)}catch(m){f.error("XHR open failed.");this.connected||this._changeConnectStatus(f.Status.CONNFAIL,"bad-service");this.disconnect();return}a=function(){b.date=new Date;b.xhr.send(b.data)};b.sends>1?(d=Math.min(Math.floor(f.TIMEOUT*this.wait),
Math.pow(b.sends,3))*1E3,setTimeout(a,d)):a();b.sends++;this.xmlOutput!==f.Connection.prototype.xmlOutput&&this.xmlOutput(b.xmlData);this.rawOutput!==f.Connection.prototype.rawOutput&&this.rawOutput(b.data)}else f.debug("_processRequest: "+(a===0?"first":"second")+" request has readyState of "+b.xhr.readyState)}},_throttledRequestHandler:function(){this._requests?f.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):f.debug("_throttledRequestHandler called with undefined requests");
this._requests&&this._requests.length!==0&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))},_onRequestStateChange:function(a,b){f.debug("request id "+b.id+"."+b.sends+" state changed to "+b.xhr.readyState);if(b.abort)b.abort=!1;else{var d;if(b.xhr.readyState==4){d=0;try{d=b.xhr.status}catch(e){}typeof d=="undefined"&&(d=0);if(this.disconnecting&&d>=400)this._hitError(d);else{var j=
this._requests[0]==b,q=this._requests[1]==b;if(d>0&&d<500||b.sends>5)this._removeRequest(b),f.debug("request id "+b.id+" should now be removed");if(d==200)(q||j&&this._requests.length>0&&this._requests[0].age()>Math.floor(f.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),f.debug("request id "+b.id+"."+b.sends+" got 200"),a(b),this.errors=0;else if(f.error("request id "+b.id+"."+b.sends+" error "+d+" happened"),d===0||d>=400&&d<600||d>=12E3)this._hitError(d),d>=400&&d<500&&(this._changeConnectStatus(f.Status.DISCONNECTING,
null),this._doDisconnect());d>0&&d<500||b.sends>5||this._throttledRequestHandler()}}}},_hitError:function(a){this.errors++;f.warn("request errored, status: "+a+", number of errors: "+this.errors);this.errors>4&&this._onDisconnectTimeout()},_doDisconnect:function(){f.info("_doDisconnect was called");this.disconnecting=this.authenticated=!1;this.streamId=this.sid=null;this.rid=Math.floor(Math.random()*4294967295);if(this.connected)this._changeConnectStatus(f.Status.DISCONNECTED,null),this.connected=
!1;this.handlers=[];this.timedHandlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[]},_dataRecv:function(a){try{var b=a.getResponse()}catch(d){if(d!="parsererror")throw d;this.disconnect("strophe-parsererror")}if(b!==null){this.xmlInput!==f.Connection.prototype.xmlInput&&this.xmlInput(b);for(this.rawInput!==f.Connection.prototype.rawInput&&this.rawInput(f.serialize(b));this.removeHandlers.length>0;)a=this.removeHandlers.pop(),a=this.handlers.indexOf(a),a>=0&&
this.handlers.splice(a,1);for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._requests.length===0)this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null,this._doDisconnect();else if(a=b.getAttribute("type"),a!==null&&a=="terminate")this.disconnecting||(a=b.getAttribute("condition"),b=b.getElementsByTagName("conflict"),a!==null?(a=="remote-stream-error"&&b.length>0&&(a="conflict"),this._changeConnectStatus(f.Status.CONNFAIL,
a)):this._changeConnectStatus(f.Status.CONNFAIL,"unknown"),this.disconnect());else{var e=this;f.forEachChild(b,null,function(a){var b,c;c=e.handlers;e.handlers=[];for(b=0;b<c.length;b++){var d=c[b];try{d.isMatch(a)&&(e.authenticated||!d.user)?d.run(a)&&e.handlers.push(d):e.handlers.push(d)}catch(f){}}})}}},_sendTerminate:function(){f.info("_sendTerminate was called");var a=this._buildBody().attrs({type:"terminate"});this.authenticated&&a.c("presence",{xmlns:f.NS.CLIENT,type:"unavailable"});this.disconnecting=
!0;this._requests.push(new f.Request(a.tree(),this._onRequestStateChange.bind(this,this._dataRecv.bind(this)),a.tree().getAttribute("rid")));this._throttledRequestHandler()},_connect_cb:function(a){f.info("_connect_cb was called");this.connected=!0;if(a=a.getResponse()){this.xmlInput!==f.Connection.prototype.xmlInput&&this.xmlInput(a);this.rawInput!==f.Connection.prototype.rawInput&&this.rawInput(f.serialize(a));var b=a.getAttribute("type");if(b!==null&&b=="terminate")b=a.getAttribute("condition"),
a=a.getElementsByTagName("conflict"),b!==null?(b=="remote-stream-error"&&a.length>0&&(b="conflict"),this._changeConnectStatus(f.Status.CONNFAIL,b)):this._changeConnectStatus(f.Status.CONNFAIL,"unknown");else{if(!this.sid)this.sid=a.getAttribute("sid");if(!this.stream_id)this.stream_id=a.getAttribute("authid");if(b=a.getAttribute("requests"))this.window=parseInt(b,10);if(b=a.getAttribute("hold"))this.hold=parseInt(b,10);if(b=a.getAttribute("wait"))this.wait=parseInt(b,10);var j=b=!1,t=!1,a=a.getElementsByTagName("mechanism"),
r,q;if(a.length>0){for(r=0;r<a.length;r++)q=f.getText(a[r]),q=="DIGEST-MD5"?j=!0:q=="PLAIN"?b=!0:q=="ANONYMOUS"&&(t=!0);f.getNodeFromJid(this.jid)===null&&t?(this._changeConnectStatus(f.Status.AUTHENTICATING,null),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(d("auth",{xmlns:f.NS.SASL,mechanism:"ANONYMOUS"}).tree())):f.getNodeFromJid(this.jid)===
null?(this._changeConnectStatus(f.Status.CONNFAIL,"x-strophe-bad-non-anon-jid"),this.disconnect()):j?(this._changeConnectStatus(f.Status.AUTHENTICATING,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge1_cb.bind(this),null,"challenge",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(d("auth",{xmlns:f.NS.SASL,mechanism:"DIGEST-MD5"}).tree())):b?(a=f.getBareJidFromJid(this.jid),a+="\x00",a+=f.getNodeFromJid(this.jid),
a+="\x00",a+=this.pass,this._changeConnectStatus(f.Status.AUTHENTICATING,null),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),a=Base64.encode(a),this.send(d("auth",{xmlns:f.NS.SASL,mechanism:"PLAIN"}).t(a).tree())):(this._changeConnectStatus(f.Status.AUTHENTICATING,null),this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1"),
this.send(e({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:f.NS.AUTH}).c("username",{}).t(f.getNodeFromJid(this.jid)).tree()))}else a=this._buildBody(),this._requests.push(new f.Request(a.tree(),this._onRequestStateChange.bind(this,this._connect_cb.bind(this)),a.tree().getAttribute("rid"))),this._throttledRequestHandler()}}},_sasl_challenge1_cb:function(a){var b=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,e=Base64.decode(f.getText(a)),a=MD5.hexdigest(""+Math.random()*1234567890),j="",r=null,q=
"",m;for(this.deleteHandler(this._sasl_failure_handler);e.match(b);)switch(m=e.match(b),e=e.replace(m[0],""),m[2]=m[2].replace(/^"(.+)"$/,"$1"),m[1]){case "realm":j=m[2];break;case "nonce":q=m[2];break;case "host":r=m[2]}b="xmpp/"+this.domain;r!==null&&(b=b+"/"+r);r=MD5.hash(f.getNodeFromJid(this.jid)+":"+j+":"+this.pass)+":"+q+":"+a;e="AUTHENTICATE:"+b;m="";m+="username="+this._quote(f.getNodeFromJid(this.jid))+",";m+="realm="+this._quote(j)+",";m+="nonce="+this._quote(q)+",";m+="cnonce="+this._quote(a)+
",";m+='nc="00000001",';m+='qop="auth",';m+="digest-uri="+this._quote(b)+",";m+="response="+this._quote(MD5.hexdigest(MD5.hexdigest(r)+":"+q+":00000001:"+a+":auth:"+MD5.hexdigest(e)))+",";m+='charset="utf-8"';this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge2_cb.bind(this),null,"challenge",null,null);this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null);this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),
null,"failure",null,null);this.send(d("response",{xmlns:f.NS.SASL}).t(Base64.encode(m)).tree());return!1},_quote:function(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},_sasl_challenge2_cb:function(){this.deleteHandler(this._sasl_success_handler);this.deleteHandler(this._sasl_failure_handler);this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null);this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",
null,null);this.send(d("response",{xmlns:f.NS.SASL}).tree());return!1},_auth1_cb:function(){var a=e({type:"set",id:"_auth_2"}).c("query",{xmlns:f.NS.AUTH}).c("username",{}).t(f.getNodeFromJid(this.jid)).up().c("password").t(this.pass);if(!f.getResourceFromJid(this.jid))this.jid=f.getBareJidFromJid(this.jid)+"/strophe";a.up().c("resource",{}).t(f.getResourceFromJid(this.jid));this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2");this.send(a.tree());return!1},_sasl_success_cb:function(){f.info("SASL authentication succeeded.");
this.deleteHandler(this._sasl_failure_handler);this._sasl_failure_handler=null;if(this._sasl_challenge_handler)this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null;this._addSysHandler(this._sasl_auth1_cb.bind(this),null,"stream:features",null,null);this._sendRestart();return!1},_sasl_auth1_cb:function(a){this.features=a;var b,d;for(b=0;b<a.childNodes.length;b++){d=a.childNodes[b];if(d.nodeName=="bind")this.do_bind=!0;if(d.nodeName=="session")this.do_session=!0}this.do_bind?
(this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2"),(a=f.getResourceFromJid(this.jid))?this.send(e({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:f.NS.BIND}).c("resource",{}).t(a).tree()):this.send(e({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:f.NS.BIND}).tree())):this._changeConnectStatus(f.Status.AUTHFAIL,null);return!1},_sasl_bind_cb:function(a){if(a.getAttribute("type")=="error")return f.info("SASL binding failed."),this._changeConnectStatus(f.Status.AUTHFAIL,
null),!1;a=a.getElementsByTagName("bind");if(a.length>0){if(a=a[0].getElementsByTagName("jid"),a.length>0)this.jid=f.getText(a[0]),this.do_session?(this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2"),this.send(e({type:"set",id:"_session_auth_2"}).c("session",{xmlns:f.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(f.Status.CONNECTED,null))}else return f.info("SASL binding failed."),this._changeConnectStatus(f.Status.AUTHFAIL,null),!1},_sasl_session_cb:function(a){a.getAttribute("type")==
"result"?(this.authenticated=!0,this._changeConnectStatus(f.Status.CONNECTED,null)):a.getAttribute("type")=="error"&&(f.info("Session creation failed."),this._changeConnectStatus(f.Status.AUTHFAIL,null));return!1},_sasl_failure_cb:function(){if(this._sasl_success_handler)this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null;if(this._sasl_challenge_handler)this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null;this._changeConnectStatus(f.Status.AUTHFAIL,
null);return!1},_auth2_cb:function(a){a.getAttribute("type")=="result"?(this.authenticated=!0,this._changeConnectStatus(f.Status.CONNECTED,null)):a.getAttribute("type")=="error"&&(this._changeConnectStatus(f.Status.AUTHFAIL,null),this.disconnect());return!1},_addSysTimedHandler:function(a,b){var d=new f.TimedHandler(a,b);d.user=!1;this.addTimeds.push(d);return d},_addSysHandler:function(a,b,d,e,j){a=new f.Handler(a,b,d,e,j);a.user=!1;this.addHandlers.push(a);return a},_onDisconnectTimeout:function(){f.info("_onDisconnectTimeout was called");
for(var a;this._requests.length>0;)a=this._requests.pop(),a.abort=!0,a.xhr.abort(),a.xhr.onreadystatechange=function(){};this._doDisconnect();return!1},_onIdle:function(){for(var a,b,d,e;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;)b=this.removeTimeds.pop(),a=this.timedHandlers.indexOf(b),a>=0&&this.timedHandlers.splice(a,1);var j=(new Date).getTime();e=[];for(a=0;a<this.timedHandlers.length;a++)if(b=this.timedHandlers[a],this.authenticated||
!b.user)d=b.lastCalled+b.period,d-j<=0?b.run()&&e.push(b):e.push(b);this.timedHandlers=e;this.authenticated&&this._requests.length===0&&this._data.length===0&&!this.disconnecting&&(f.info("no requests during idle cycle, sending blank request"),this._data.push(null));if(this._requests.length<2&&this._data.length>0&&!this.paused){b=this._buildBody();for(a=0;a<this._data.length;a++)this._data[a]!==null&&(this._data[a]==="restart"?b.attrs({to:this.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":f.NS.BOSH}):
b.cnode(this._data[a]).up());delete this._data;this._data=[];this._requests.push(new f.Request(b.tree(),this._onRequestStateChange.bind(this,this._dataRecv.bind(this)),b.tree().getAttribute("rid")));this._processRequest(this._requests.length-1)}this._requests.length>0&&(a=this._requests[0].age(),this._requests[0].dead!==null&&this._requests[0].timeDead()>Math.floor(f.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),a>Math.floor(f.TIMEOUT*this.wait)&&(f.warn("Request "+this._requests[0].id+
" timed out, over "+Math.floor(f.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler()));clearTimeout(this._idleTimeout);if(this.connected)this._idleTimeout=setTimeout(this._onIdle.bind(this),100)}};a&&a(f,d,b,e,j)})(function(a,d,b,e,j){window.Strophe=a;window.$build=d;window.$msg=b;window.$iq=e;window.$pres=j});redhelper.define("common/extensions/strophe.base",function(){});
redhelper.require(["common/extensions/strophe.base"],function(){Strophe.xmlTextNode=function(a){return Strophe.xmlGenerator().createTextNode(a)};Strophe.addConnectionPlugin("receipts",{_conn:null,_msgQueue:{},_retries:{},_resendCount:0,_resendTime:9E3,init:function(a){this._conn=a;Strophe.addNamespace("RECEIPTS","urn:xmpp:receipts")},statusChanged:function(a){if(a===Strophe.Status.CONNECTED||a===Strophe.Status.ATTACHED){this._conn.addHandler(this._onRequestReceived.bind(this),Strophe.NS.RECEIPTS,
"message");var d=this;setTimeout(function(){d.resendQueue()},5E3)}},_onRequestReceived:function(a){this._processReceipt(a);return!0},sendMessage:function(a){var d=this._conn.getUniqueId();a.tree().setAttribute("id",d);var b=Strophe.xmlElement("request",{xmlns:Strophe.NS.RECEIPTS});a.tree().appendChild(b);this._msgQueue[d]=a;this._retries[d]=0;this._conn.send(a.tree());this.resendMessage(d);return d},resendMessage:function(a){var d=this;setTimeout(function(){d._msgQueue[a]&&(d._conn.connected?(d._retries[a]++,
d._retries[a]>d._resendCount||(d._msgQueue[a].tree().setAttribute("from",d._conn.jid),d._conn.send(d._msgQueue[a].tree()),d.resendMessage(a))):d.resendMessage(a))},this._resendTime)},addReceiptHandler:function(a,d,b,e){var j=this;this._conn.addHandler(function(b){j._processReceipt(b);return a(b)},Strophe.NS.RECEIPTS,"message",d,null,b,e)},_processReceipt:function(a){var d=a.getAttribute("id"),b=a.getAttribute("from"),e=a.getElementsByTagName("request"),a=a.getElementsByTagName("received");e.length>
0&&(b=$msg({to:b,from:this._conn.jid,id:this._conn.getUniqueId()}),d=Strophe.xmlElement("received",{xmlns:Strophe.NS.RECEIPTS,id:d}),b.tree().appendChild(d),this._conn.send(b));if(a.length>0&&(d=a[0].getAttribute("id")))delete this._msgQueue[d],delete this._retries[d]},resendQueue:function(){if(this._conn.connected)for(var a in this._msgQueue)this._msgQueue.hasOwnProperty(a)&&(this._retries[a]++,this._retries[a]<=this._resendCount&&this._conn.send(this._msgQueue[a].tree()));else{var d=this;setTimeout(function(){d.resendQueue()},
5E3)}},getUnreceivedMsgs:function(){var a=[],d;for(d in this._msgQueue)this._msgQueue.hasOwnProperty(d)&&a.push(this._msgQueue[d]);return a},clearMessages:function(){this._msgQueue={}}})});redhelper.define("common/extensions/strophe",function(){});
redhelper.require(["common/extensions/strophe.base"],function(){Strophe.WebSocket=function(a){this.service=a;this.ws=null;this.connect_timeout=300;this.jid="";this.streamId=null;this.do_bind=this.do_session=!1;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this._disconnectTimeout=this._idleTimeout=null;this.connected=this.disconnecting=this.authenticated=!1;this._keep_alive_timer=2E4;this.errors=0;this._data=[];this._requests=
[];this._uniqueId=Math.round(Math.random()*1E4);this._rebind_failure_handler=this._rebind_success_handler=this._sasl_challenge_handler=this._sasl_failure_handler=this._sasl_success_handler=null;this._idleTimeout=setTimeout(this._onIdle.bind(this),100);for(var d in Strophe._connectionPlugins)if(Strophe._connectionPlugins.hasOwnProperty(d))a=function(){},a.prototype=Strophe._connectionPlugins[d],this[d]=new a,this[d].init(this)};Strophe.WebSocket.prototype={reset:function(){this.streamId=this.sid=null;
this.do_bind=this.do_session=!1;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this.connected=this.disconnecting=this.authenticated=!1;this.errors=0},pause:function(){},resume:function(){},getUniqueId:function(a){return typeof a=="string"||typeof a=="number"?++this._uniqueId+":"+a:++this._uniqueId+""},connect:function(a,d,b){this.jid=a;this.pass=d;this.connect_callback=b;this.authenticated=this.connected=this.disconnecting=
!1;this.errors=0;this.domain=Strophe.getDomainFromJid(this.jid);if(window.WebSocket)try{this.ws=new WebSocket(this.service),this.ws.onopen=this._send_initial_stream.bind(this),this._addSysTimedHandler(this._keep_alive_timer,this._keep_alive_handler.bind(this)),this.ws.onmessage=this._get_stream_id.bind(this).prependArg(this._connect_cb.bind(this)),this.ws.onerror=function(a){console.log("error : "+a)},this.ws.onclose=this._ws_on_close.bind(this)}catch(e){}else throw"no websocket support";},attach:function(){},
rebind:function(a,d,b){this.jid=a;this.connect_callback=b;this.domain=Strophe.getDomainFromJid(this.jid);this._addSysTimedHandler(this._keep_alive_timer,this._keep_alive_handler.bind(this));this.ws=new WebSocket(this.service);this.ws.onopen=this._send_initial_stream.bind(this);this.ws.onmessage=this._get_stream_id.bind(this).prependArg(this._rebind_cb.bind(this).prependArg(a).prependArg(d));this.ws.onclose=this._ws_on_close.bind(this)},save:function(a,d){this.sendIQ($iq({type:"set"}).c("push",{xmlns:"p1:push"}).c("keepalive",
{max:"30"}).up().c("session",{duration:"1"}),a,d)},xmlInput:function(){},xmlOutput:function(){},rawInput:function(){},rawOutput:function(){},send:function(a){var d="";if(a!==null){if(typeof a.sort==="function")for(var b=0;b<a.length;b++)d+=Strophe.serialize(a[b]),this.xmlOutput(a);else typeof a.tree==="function"?(d=Strophe.serialize(a.tree()),this.xmlOutput(a.tree())):(d=Strophe.serialize(a),this.xmlOutput(a));this.rawOutput(d);this.ws.send(d)}},flush:function(){},sendIQ:function(a,d,b,e){var j=null,
f=this;typeof a.tree==="function"&&(a=a.tree());var c=a.getAttribute("id");c||(c=this.getUniqueId("sendIQ"),a.setAttribute("id",c));var k=this.addHandler(function(a){j&&f.deleteTimedHandler(j);var c=a.getAttribute("type");if(c=="result")d&&d(a);else if(c=="error")b&&b(a);else throw{name:"StropheError",message:"Got bad IQ type of "+c};},null,"iq",null,c);e&&(j=this.addTimedHandler(e,function(){f.deleteHandler(k);b&&b(null);return!1}));this.send(a);return c},addTimedHandler:function(a,d){var b=new Strophe.TimedHandler(a,
d);this.addTimeds.push(b);return b},deleteTimedHandler:function(a){this.removeTimeds.push(a)},addHandler:function(a,d,b,e,j,f,c){a=new Strophe.Handler(a,d,b,e,j,f,c);this.addHandlers.push(a);return a},deleteHandler:function(a){this.removeHandlers.push(a)},disconnect:function(a){this._changeConnectStatus(Strophe.Status.DISCONNECTING,a);Strophe.info("Disconnect was called because: "+a);if(this.connected)this._disconnectTimeout=this._addSysTimedHandler(3E3,this._onDisconnectTimeout.bind(this)),this._sendTerminate()},
_changeConnectStatus:function(a,d){for(var b in Strophe._connectionPlugins)if(Strophe._connectionPlugins.hasOwnProperty(b)){var e=this[b];if(e.statusChanged)try{e.statusChanged(a,d)}catch(j){Strophe.error(""+b+" plugin caused an exception changing status: "+j)}}if(this.connect_callback)try{this.connect_callback(a,d)}catch(f){Strophe.error("User connection callback caused an exception: "+f)}},_doDisconnect:function(){Strophe.info("_doDisconnect was called");this.disconnecting=this.authenticated=!1;
this.streamId=this.sid=null;if(this.connected)this._changeConnectStatus(Strophe.Status.DISCONNECTED,null),this.connected=!1;this.handlers=[];this.timedHandlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this.ws.readyState!=this.ws.CLOSED&&this.ws.close()},_ws_on_close:function(){Strophe.info("websocket closed");this._doDisconnect()},_keep_alive_handler:function(){this.ws.send("\n");return!0},_send_initial_stream:function(){this._changeConnectStatus(Strophe.Status.CONNECTING,
null);var a='<?xml version="1.0"?><stream:stream xmlns:stream="http://etherx.jabber.org/streams" version="1.0" xmlns="jabber:client" to="'+this.domain+'" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace" >';this.rawOutput(a);this.ws.send(a)},_get_stream_id:function(a,d){elem=d.data;this.rawInput(elem);if(d.data.match(/id=[\'\"]([^\'\"]+)[\'\"]/))this.streamId=RegExp.$1;this.ws.onmessage=a},_parseTree:function(a){try{if(this._parser==void 0)this._parser=new DOMParser;return this._parser.parseFromString("<body xmlns:stream='foo' >"+
a+"</body>","text/xml").documentElement.firstChild}catch(d){Strophe.error("Error : "+d)}return null},_dataRecv:function(a){var d;try{d=this._parseTree(a.data)}catch(b){if(b!="parsererror")throw b;this.disconnect("strophe-parsererror")}if(d!==null){this.xmlInput(d);this.rawInput(a.data);for(var e;this.removeHandlers.length>0;)e=this.removeHandlers.pop(),a=this.handlers.indexOf(e),a>=0&&this.handlers.splice(a,1);for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting)this.deleteTimedHandler(this._disconnectTimeout),
this._disconnectTimeout=null,this._doDisconnect();else if(a=d.getAttribute("type"),a!==null&&a=="terminate")a=d.getAttribute("condition"),d=d.getElementsByTagName("conflict"),a!==null?(a=="remote-stream-error"&&d.length>0&&(a="conflict"),this._changeConnectStatus(Strophe.Status.CONNFAIL,a)):this._changeConnectStatus(Strophe.Status.CONNFAIL,"unknown"),this.disconnect();else{var j;j=this.handlers;this.handlers=[];for(a=0;a<j.length;a++)e=j[a],e.isMatch(d)&&(this.authenticated||!e.user)?e.run(d)&&this.handlers.push(e):
this.handlers.push(e)}}},_sendTerminate:function(){Strophe.info("_sendTerminate was called");var a={};this.authenticated&&(a=$pres({xmlns:Strophe.NS.CLIENT,type:"unavailable"}));this.disconnecting=!0;this.send(a)},_connect_cb:function(a){Strophe.info("_connect_cb was called");this.connected=!0;this.ws.onmessage=this._dataRecv.bind(this);if(a=a.data){stanza=this._parseTree(a);this.xmlInput(stanza);this.rawInput(Strophe.serialize(stanza));var d=a=!1,b=!1,e=stanza.getElementsByTagName("mechanism"),j,
f;if(e.length>0)for(j=0;j<e.length;j++)f=Strophe.getText(e[j]),f=="DIGEST-MD5"?d=!0:f=="PLAIN"?a=!0:f=="ANONYMOUS"&&(b=!0);Strophe.getNodeFromJid(this.jid)===null&&b?(this._changeConnectStatus(Strophe.Status.AUTHENTICATING,null),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send($build("auth",{xmlns:Strophe.NS.SASL,mechanism:"ANONYMOUS"}).tree())):
Strophe.getNodeFromJid(this.jid)===null?(this._changeConnectStatus(Strophe.Status.CONNFAIL,"x-strophe-bad-non-anon-jid"),this.disconnect()):d?(this._changeConnectStatus(Strophe.Status.AUTHENTICATING,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge1_cb.bind(this),null,"challenge",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send($build("auth",{xmlns:Strophe.NS.SASL,mechanism:"DIGEST-MD5"}).tree())):
a?(a=Strophe.getBareJidFromJid(this.jid),a+="\x00",a+=Strophe.getNodeFromJid(this.jid),a+="\x00",a+=this.pass,this._changeConnectStatus(Strophe.Status.AUTHENTICATING,null),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),a=Base64.encode(a),this.send($build("auth",{xmlns:Strophe.NS.SASL,mechanism:"PLAIN"}).t(a).tree())):(this._changeConnectStatus(Strophe.Status.AUTHENTICATING,
null),this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1"),this.send($iq({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:Strophe.NS.AUTH}).c("username",{}).t(Strophe.getNodeFromJid(this.jid)).tree()))}},_rebind_cb:function(a,d,b){this.connected=!0;this.ws.onmessage=this._dataRecv.bind(this);if(b=b.data)stanza=this._parseTree(b),this.xmlInput(stanza),this.rawInput(Strophe.serialize(stanza)),stanza.getElementsByTagName("rebind").length>0?(this._changeConnectStatus(Strophe.Status.ATTACHED,
null),this.send($build("rebind",{xmlns:"p1:rebind"}).c("jid",{}).t(a).up().c("sid",{}).t(d).tree()),this._rebind_success_handler=this._addSysHandler(this._rebind_success_cb.bind(this),null,"rebind",null,null),this._rebind_failure_handler=this._addSysHandler(this._rebind_failure_cb.bind(this),null,"failure",null,null)):this._changeConnectStatus(Strophe.Status.CONNFAIL,"x-strophe-rebind-not-supported")},_rebind_success_cb:function(){Strophe.info("Rebinding  succeeded.");this.connected=this.authenticated=
!0;this.deleteHandler(this._rebind_failure_handler);this._rebind_failure_handler=null;this._changeConnectStatus(Strophe.Status.ATTACHED,null);return!1},_rebind_failure_cb:function(){Strophe.info("Rebinding failed.");if(this._rebind_success_handler)this.deleteHandler(this._rebind_success_handler),this._rebind_success_handler=null;this._changeConnectStatus(Strophe.Status.CONNFAIL,null);return!1},_sasl_challenge1_cb:function(a){var d=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,b=Base64.decode(Strophe.getText(a)),
a=MD5.hexdigest(Math.random()*1234567890),e="",j=null,f="",c;for(this.deleteHandler(this._sasl_failure_handler);b.match(d);)switch(c=b.match(d),b=b.replace(c[0],""),c[2]=c[2].replace(/^"(.+)"$/,"$1"),c[1]){case "realm":e=c[2];break;case "nonce":f=c[2];break;case "host":j=c[2]}d="xmpp/"+this.domain;j!==null&&(d=d+"/"+j);j=MD5.hash(Strophe.getNodeFromJid(this.jid)+":"+e+":"+this.pass)+":"+f+":"+a;b="AUTHENTICATE:"+d;c="";c+="username="+this._quote(Strophe.getNodeFromJid(this.jid))+",";c+="realm="+this._quote(e)+
",";c+="nonce="+this._quote(f)+",";c+="cnonce="+this._quote(a)+",";c+='nc="00000001",';c+='qop="auth",';c+="digest-uri="+this._quote(d)+",";c+="response="+this._quote(MD5.hexdigest(MD5.hexdigest(j)+":"+f+":00000001:"+a+":auth:"+MD5.hexdigest(b)))+",";c+='charset="utf-8"';this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge2_cb.bind(this),null,"challenge",null,null);this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null);this._sasl_failure_handler=
this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null);this.send($build("response",{xmlns:Strophe.NS.SASL}).t(Base64.encode(c)).tree());return!1},_quote:function(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},_sasl_challenge2_cb:function(){this.deleteHandler(this._sasl_success_handler);this.deleteHandler(this._sasl_failure_handler);this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null);this._sasl_failure_handler=
this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null);this.send($build("response",{xmlns:Strophe.NS.SASL}).tree());return!1},_auth1_cb:function(){var a=$iq({type:"set",id:"_auth_2"}).c("query",{xmlns:Strophe.NS.AUTH}).c("username",{}).t(Strophe.getNodeFromJid(this.jid)).up().c("password").t(this.pass);if(!Strophe.getResourceFromJid(this.jid))this.jid=Strophe.getBareJidFromJid(this.jid)+"/strophe";a.up().c("resource",{}).t(Strophe.getResourceFromJid(this.jid));this._addSysHandler(this._auth2_cb.bind(this),
null,null,null,"_auth_2");this.send(a.tree());return!1},_sasl_success_cb:function(){Strophe.info("SASL authentication succeeded.");this.deleteHandler(this._sasl_failure_handler);this._sasl_failure_handler=null;if(this._sasl_challenge_handler)this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null;this._addSysHandler(this._sasl_auth1_cb.bind(this),null,"stream:features",null,null);this.ws.onmessage=this._get_stream_id.bind(this).prependArg(this._dataRecv.bind(this));this._send_initial_stream();
return!1},_sasl_auth1_cb:function(a){var d,b;for(d=0;d<a.childNodes.length;d++){b=a.childNodes[d];if(b.nodeName=="bind")this.do_bind=!0;if(b.nodeName=="session")this.do_session=!0}this.do_bind?(this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2"),(a=Strophe.getResourceFromJid(this.jid))?this.send($iq({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:Strophe.NS.BIND}).c("resource",{}).t(a).tree()):this.send($iq({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:Strophe.NS.BIND}).tree())):
this._changeConnectStatus(Strophe.Status.AUTHFAIL,null);return!1},_sasl_bind_cb:function(a){if(a.getAttribute("type")=="error")return Strophe.info("SASL binding failed."),this._changeConnectStatus(Strophe.Status.AUTHFAIL,null),!1;a=a.getElementsByTagName("bind");if(a.length>0){if(a=a[0].getElementsByTagName("jid"),a.length>0)this.jid=Strophe.getText(a[0]),this.do_session?(this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2"),this.send($iq({type:"set",id:"_session_auth_2"}).c("session",
{xmlns:Strophe.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(Strophe.Status.CONNECTED,null))}else return Strophe.info("SASL binding failed."),this._changeConnectStatus(Strophe.Status.AUTHFAIL,null),!1},_sasl_session_cb:function(a){a.getAttribute("type")=="result"?(this.authenticated=!0,this._changeConnectStatus(Strophe.Status.CONNECTED,null)):a.getAttribute("type")=="error"&&(Strophe.info("Session creation failed."),this._changeConnectStatus(Strophe.Status.AUTHFAIL,null));
return!1},_sasl_failure_cb:function(){if(this._sasl_success_handler)this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null;if(this._sasl_challenge_handler)this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null;this._changeConnectStatus(Strophe.Status.AUTHFAIL,null);return!1},_auth2_cb:function(a){a.getAttribute("type")=="result"?(this.authenticated=!0,this._changeConnectStatus(Strophe.Status.CONNECTED,null)):a.getAttribute("type")=="error"&&(this._changeConnectStatus(Strophe.Status.AUTHFAIL,
null),this.disconnect());return!1},_addSysTimedHandler:function(a,d){var b=new Strophe.TimedHandler(a,d);b.user=!1;this.addTimeds.push(b);return b},_addSysHandler:function(a,d,b,e,j){a=new Strophe.Handler(a,d,b,e,j);a.user=!1;this.addHandlers.push(a);return a},_onDisconnectTimeout:function(){Strophe.info("_onDisconnectTimeout was called");this._doDisconnect();return!1},_onIdle:function(){for(var a,d,b,e;this.removeTimeds.length>0;)d=this.removeTimeds.pop(),a=this.timedHandlers.indexOf(d),a>=0&&this.timedHandlers.splice(a,
1);for(;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());var j=(new Date).getTime();e=[];for(a=0;a<this.timedHandlers.length;a++)if(d=this.timedHandlers[a],this.authenticated||!d.user)b=d.lastCalled+d.period,b-j<=0?d.run()&&e.push(d):e.push(d);this.timedHandlers=e;clearTimeout(this._idleTimeout);this._idleTimeout=setTimeout(this._onIdle.bind(this),100)}}});redhelper.define("common/extensions/strophe.websocket",function(){});
redhelper.define("xmpp/connection","application/dispatcher,common/extensions/debug,config/setup,application/session.objects,common/extensions/strophe,common/extensions/strophe.websocket".split(","),function(a,d,b,e){var j={disconnecting:!1,_errorHandlers:[],_reconId:null,_connection:null,_messageHandler:null,_reconnecting:!1,_attached:!1,_reconnectTimeout:4E3,_maxTimeout:3E4,_timeoutStep:1500,setMessageHandler:function(a){this._messageHandler=a},init:function(){this._connection=b.DEBUG?new Strophe.WebSocket("ws://ej-testing2.redhelper.ru:5288/ws-xmpp"):
new Strophe.Connection(b.BOSH_SERVICE);this._connection.rawInput=function(a){d.log("RECV: "+a);try{e.rid=j._connection.rid,e.sid=j._connection.sid}catch(b){d.error(b)}};this._connection.rawOutput=function(a){d.log("SEND: "+a);try{e.rid=j._connection.rid,e.sid=j._connection.sid}catch(b){d.error(b)}};this._connection.connect(b.XMPP_DOMAIN,"",j.onStatusChanged,50);this._connection.addHandler(j._messageHandler,null,"message",null,null,null);this._connection._hitError=function(a){var b;j._connection.errors++;
j._connection.errors>4&&j._connection._onDisconnectTimeout();for(b in j._errorHandlers)if(j._errorHandlers.hasOwnProperty(b)&&typeof j._errorHandlers[b]==="function")j._errorHandlers[b](a,j._connection.errors)}},addErrorHandler:function(a){typeof a==="function"&&this._errorHandlers.push(a)},checkPresence:function(){this._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:presence",from:b.XMPP_DOMAIN,to:b.CLIENT_NAME.toOperatorJid()}).tree(),this.onPresence,j.reconnect,7E3)},disconnect:function(){j.disconnecting=
!0;this._connection.disconnect()},reconnect:function(){j.disconnecting=!1;e.reconnecting=!0;this._connection.disconnect()},onStatusChanged:function(d){if(d===Strophe.Status.CONNECTED||d===Strophe.Status.ATTACHED){a.fire("connected");if(e.reconnecting)a.fire("refreshHistory"),e.reconnecting=!1;if(d===Strophe.Status.ATTACHED)a.fire("attached"),j._attached=!0}else if(d===Strophe.Status.DISCONNECTING||d===Strophe.Status.ERROR||d===Strophe.Status.CONNFAIL||d===Strophe.Status.AUTHFAIL)if(j._isAuthenticated=
!1,!j.disconnecting){if(j._reconId===null)j._reconId=setTimeout(function(){j._connection.reset();e.reconnecting=!0;j._connection.connect(b.XMPP_DOMAIN,"",j.onStatusChanged,50);j._connection.addHandler(j._messageHandler,null,"message",null,null,null);j._reconId=null},j._reconnectTimeout);j._reconnectTimeout+=Math.random()*j._timeoutStep+j._timeoutStep;if(j._reconnectTimeout>j._maxTimeout)j._reconnectTimeout=j._maxTimeout}return!0},onPresence:function(){a.fire("connected")},isAuthenticated:function(){return this._isAuthenticated}};
return j});
redhelper.define("common/application/basicActivity",["application/dispatcher"],function(a){function d(a,b){this._prefix=b||"";this._dispatcher=null;this._CHECK_INTERVAL=a;this._intervalId=null;this._flag=this._isUserAway=!1;this._children=[]}d.prototype={check:function(){!this._flag&&!this._isUserAway?(this._dispatcher.fire(this._prefix+"userAway"),this._isUserAway=!0):this._flag=!1},isActive:function(){return!this._isUserAway},update:function(){var a;this._flag=!0;if(this._isUserAway)this._dispatcher.fire(this._prefix+"userBack"),
this._isUserAway=!1;for(a=0;a<this._children.length;a++)this._children[a].update()},start:function(){if(!this._intervalId){var a=this;this._intervalId=setInterval(function(){a.check()},this._CHECK_INTERVAL)}},stop:function(){if(this._intervalId)clearInterval(this._intervalId),this._intervalId=null},init:function(a,b){if(b)this._CHECK_INTERVAL=b;this._dispatcher=a},getChild:function(a,b){var f=new d(a,b);f.init(this._dispatcher);this._children.push(f);return f}};var b=new d(3E5);b.init(a);return b});
redhelper.define("application/timer",["application/session.objects","common/application/basicActivity"],function(a,d){var b=function(){var b=null,j=0,f=d.getChild(3E4,"timer_");f.start();return{start:function(){b||(b=setInterval(function(){a.time++;j++},1E3))},stop:function(){clearInterval(b);b=null},getActivity:function(){return f},flush:function(){var a=j;j=0;return a}}}();b.start();return b});redhelper.define("xmpp/xmppException",[],function(){});
redhelper.define("xmpp/update","application/session.objects,xmpp/connection,config/setup,application/timer,xmpp/xmppException,common/extensions/strophe".split(","),function(a,d,b,e,j){var f={_firstUpdateSent:!1,simple:function(){if(a.vid){var c=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("clientName").t(b.CLIENT_NAME.toString()).up().c("time").t(e.flush().toString()).up();if(!f._firstUpdateSent)f._firstUpdateSent=!0;d._connection.sendIQ(c,null,null,
5E3)}},state:function(c){if(a.vid){var e=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("clientName").t(b.CLIENT_NAME.toString()).up();c===void 0&&(c="browse");e.c("chatState").t(c);d._connection.sendIQ(e,null,null,5E3)}},invite:function(c,e,f){if(a.vid){a.inviteState=e;a.trigger=f;a.stringChatState=c;var j=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("clientName").t(b.CLIENT_NAME.toString()).up();f===void 0&&
(f="");j.c("trigger").t(f).up().c("inviteState").t(e).up().c("chatState").t(c).up();d._connection.sendIQ(j,null,null,5E3)}},currentOperator:function(){if(a.vid&&a.currentOperator){var c=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("currentOperator").t(a.currentOperator).up().c("clientName").t(b.CLIENT_NAME.toString()).up();d._connection.sendIQ(c,null,null,5E3)}else throw new j("currentOperator or vid not specified");},inviteSniff:function(c,e){if(a.vid){var f=
$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("clientName").t(b.CLIENT_NAME.toString()).up();c===void 0||c===""||(e===void 0&&(e=""),f.c("trigger").t(c).up().c("operator").t(e).up(),d._connection.sendIQ(f,null,null,2E3))}},customFields:function(b){if(!a.free)if(a.vid){var e=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("keys"),j;for(j in b)b.hasOwnProperty(j)&&e.c("key").c("name").t(b[j].name).up().c("value").t(b[j].value).up().up();
e.up();d._connection.sendIQ(e,null,null,5E3)}else setTimeout(function(){f.customFields(b)},2E3)}};return f});
redhelper.define("xmpp/queue","xmpp/connection,application/session.objects,config/setup,common/extensions/jquery.plugins,xmpp/update,application/dispatcher,common/extensions/strophe,common/constants/sender,config/lang".split(","),function(a,d,b,e,j,f,c,k,n){var t={getOperator:function(){var c=$iq({type:"get"}).c("query",{xmlns:"consultant:queue"}).c("client").t(b.CLIENT_NAME).up().c("vid").t(d.vid.toString()).up();typeof b.REQUIRE_OPERATOR==="string"&&b.REQUIRE_OPERATOR!==""&&c.c("require").t(b.REQUIRE_OPERATOR).up();
d.currentOperator&&d.chatStarted?c.c("operator").t(d.currentOperator):d.requiredOperator?c.c("operator").t(d.requiredOperator):d.preferredOperator&&c.c("operator").t(d.preferredOperator);a._connection.sendIQ(c,this.onGetOperator,this.onGetOperatorFail,5E3)},checkOperator:function(){function c(a){(d.isOnline&&!e("operator",a).text()||!d.isOnline&&e("operator",a).text())&&f.fire("changeState",{online:!!e("operator",a).text()})}var j=$iq({type:"get"}).c("query",{xmlns:"consultant:queue"}).c("client").t(b.CLIENT_NAME).up().c("vid").t(d.vid.toString()).up();
typeof b.REQUIRE_OPERATOR==="string"&&b.REQUIRE_OPERATOR!==""&&j.c("require").t(b.REQUIRE_OPERATOR).up();d.currentOperator&&j.c("operator").t(d.currentOperator);a._connection.sendIQ(j,c,c,1E4)},onGetOperator:function(a){if(e("operator",a).text()){d.operDisplayName=e("displayName",a).text();d.operAvatar=e("avatar",a).text();if(d.currentOperator!==e("operator",a).text()){f.fire("showLabel",{text:n.OPERATOR_REDIRECT_OK+d.operDisplayName});var b=function(a){a.sender===k.OPERATOR&&(f.fire("hideLabel"),
f.removeEventListener("message",b))};f.addEventListener("message",b)}d.currentOperator=e("operator",a).text();if(d.requiredOperator&&d.currentOperator!==d.requiredOperator)f.fire("changeState",{online:!1});else{j.currentOperator();f.fire("operator");if(d.preferredOperator&&d.currentOperator!==d.preferredOperator){f.fire("showLabel",{text:d.preferredOperatorError||n.NO_PREFERRED_OPERATOR,loading:!1});var c=function(){f.removeEventListener("message",c);f.fire("hideLabel")};f.addEventListener("message",
c)}f.fire("changeState",{online:!0})}}else f.fire("changeState",{online:!1})},onGetOperatorFail:function(){f.fire("changeState",{online:!1});b.QUEUE_DELAY_COUNT++;setTimeout(function(){t.getOperator()},3E3)}};f.addEventListener("message",function(){d.chatStarted=!0});return t});
redhelper.define("common/extensions/mouse",["common/extensions/jquery.plugins"],function(a){function d(a){return{x:a.x||0,y:a.y||0,width:a.width,height:a.height,scrollX:a.scrollX,scrollY:a.scrollY}}function b(){if(i){for(var a=0,a=0;a<f.length;a+=1)f[a].send("getMouse");for(a=0;a<c.length;a+=1)c[a].send("getMouse");t()}}var e={},j=!1,f=[],c=[],k={},n={},t=function(){},r=function(){},q=!1,m=!1,p=!1,i=!1;return{init:function(){a("body").hover(function(){j=!0},function(){j=!1}).mouseleave(function(){j=
!1}).mouseenter(function(){j=!0});e.width=Math.max(a("html").width(),a(window).width());e.height=Math.max(a("html").height(),a(window).height());e.scrollX=a(window).scrollLeft();e.scrollY=a(window).scrollTop();a(window).mousemove(function(b){j=!0;e={x:b.clientX,y:b.clientY,width:Math.max(a(document).width(),a(window).width()),height:Math.max(a(document).height(),a(window).height()),scrollX:a(window).scrollLeft(),scrollY:a(window).scrollTop()}});a(window).bind("scroll",function(){e.scrollX=a(window).scrollLeft();
e.scrollY=a(window).scrollTop();j=!0});a("html").bind("click",function(b){q=!0;p=m=!1;j=!0;e={x:b.clientX,y:b.clientY,width:Math.max(a(document).width(),a(window).width()),height:Math.max(a(document).height(),a(window).height()),scrollX:a(window).scrollLeft(),scrollY:a(window).scrollTop()}});a("html").bind("mouseup",function(b){p=!0;m=!1;e={x:b.clientX,y:b.clientY,width:Math.max(a("html").width(),a(window).width()),height:Math.max(a(document).height(),a(window).height()),scrollX:a(window).scrollLeft(),
scrollY:a(window).scrollTop()}});a("html").bind("mousedown",function(b){m=!0;p=!1;e={x:b.clientX,y:b.clientY,width:Math.max(a("html").width(),a(window).width()),height:Math.max(a(document).height(),a(document).height()),scrollX:a(window).scrollLeft(),scrollY:a(window).scrollTop()}});return this},enable:function(){i=!0},disable:function(){i=!1},setAsSlave:function(b){b.addHandler("getMouse",function(){var a=d(e);a.isInside=j;a.clicked=q;a.mouseDown=m;a.mouseUp=p;p=m=q=!1;typeof r==="function"&&r(a);
b.send("mouseData",a)});var c=function(){b.send("forceLeave");a("html").unbind("mousemove",c);setTimeout(function(){a("html").mousemove(c)},1500)};a("html").mousemove(c);return this},setAsMaster:function(){setInterval(b,100);return this},addParentSlave:function(a){typeof a.send==="function"&&(f.push(a),a.addHandler("mouseData",function(a){j||(k=a)}),a.addHandler("forceLeave",function(){j=!1}));return this},addChildSlave:function(a){typeof a.send==="function"&&(c.push(a),a.addHandler("mouseData",function(a){a.isInside&&
(n=a)}));return this},setHandler:function(a){t=a;return this},setOffsetFunction:function(a){r=a;return this},getMouseData:function(){var a=d(e);a.isInside=j;a.clicked=q;a.mouseDown=m;a.mouseUp=p;p=m=q=!1;typeof r==="function"&&r(a);if(n.isInside)return n.mouseUp|=a.mouseUp,d(n),n;if(!a.isInside&&k.isInside)return k.mouseUp|=a.mouseUp,d(k),k;k.x=a.x;k.y=a.y;d(a);return a},getParentMouseData:function(){return k},getChildMouseData:function(){return n}}});
redhelper.define("xmpp/messages","application/session.objects,xmpp/connection,xmpp/queue,application/dispatcher,common/constants/sender,common/extensions/jquery.plugins,common/application/time,common/extensions/mouse,common/extensions/strophe".split(","),function(a,d,b,e,j,f,c,k){var n={_isTypedTextChanged:"",_firstMessageSent:!1,_isTyping:!1,_lockOperatorTyping:!1,_notTypingCount:0,_mouseOperators:{},_isMouseSniffed:!1,_immediateMouse:!1,_receivedMessage:{},sniff:function(){var b=a.currentTypedText.replace(/[\n]+$/g,
" "),c=$msg({to:a.currentOperator.toOperatorJid(),jid:a.vid.toVisitorJid(),type:"chat",content:"partial"}).c("body").t(b).up();if(this._isTypedTextChanged&&b){this._isTypedTextChanged=!1;if(!this._isTyping)c.c("composing",{xmlns:"http://jabber.org/protocol/chatstates"}).up(),this._lockOperatorTyping=this._isTyping=!0;d._connection.send(c.tree())}else if(n._isTyping)this._notTypingCount<3?this._notTypingCount++:(this._notTypingCount=0,c.c("paused",{xmlns:"http://jabber.org/protocol/chatstates"}).up(),
d._connection.send(c.tree()),n._isTyping=!1)},touchOperator:function(){var b=$msg({to:a.currentOperator.toOperatorJid(),jid:a.vid.toVisitorJid(),type:"chat",content:"partial"}).c("body").t("").up();b.c("composing",{xmlns:"http://jabber.org/protocol/chatstates"}).up();d._connection.send(b.tree());b=$msg({to:a.currentOperator.toOperatorJid(),jid:a.vid.toVisitorJid(),type:"chat",content:"partial"}).c("body").t("").up();b.c("paused",{xmlns:"http://jabber.org/protocol/chatstates"}).up();d._connection.send(b.tree())},
typedTextChanged:function(){this._isTypedTextChanged=!0},stopSniffMouse:function(b){delete n._mouseOperators[b.extractNode().toOperatorJid()];var b=!1,c;for(c in n._mouseOperators)if(n._mouseOperators.hasOwnProperty(c)){b=!0;break}a.mouseOperators=JSON.stringify(n._mouseOperators);(a.isSendMouseActive=b)?k.enable():k.disable()},sniffMouse:function(b,c){var e=[],f=[],j=[],i=[],h=[],l=[],v=[],C=[],K=0,x=new Date,c=c||x.getTime(),b=b.extractNode(),b=(b||a.currentOperator).toOperatorJid();n._mouseOperators[b]=
{jid:b,start:c};a.mouseOperators=JSON.stringify(n._mouseOperators);n._immediateMouse=!0;this._isMouseSniffed||k.setHandler(function(){if(a.isSendMouseActive){var b=k.getMouseData(),c=new Date,t=b.width,r=b.height;e.push(b.x);f.push(b.y);j.push(+b.clicked);h.push(+b.mouseUp);i.push(+b.mouseDown);l.push(b.scrollX);v.push(b.scrollY);C.push(b.isInside);K++;(K>=10||n._immediateMouse)&&function(){var b={},k;b.chatX=a.currentChatX;b.chatY=a.currentChatY;b.chatWidth=a.currentChatWidth||a.chatWidth;b.chatHeight=
a.currentChatHeight||a.chatHeight;b.chatState=a.chatState;b.xArr=e;b.yArr=f;b.clickedArr=j;b.upArr=h;b.downArr=i;b.scrollXArr=l;b.scrollYArr=v;b.insideArr=C;b.width=t;b.height=r;b.id=c.getTime();for(k in n._mouseOperators)if(n._mouseOperators.hasOwnProperty(k))if(c.getTime()-n._mouseOperators[k].start>36E5)n.stopSniffMouse(k);else{var u=$msg({to:n._mouseOperators[k].jid,jid:a.vid.toVisitorJid(),type:"chat",content:"mouse"}).c("body").t(JSON.stringify(b)).up().up();d.isAuthenticated()&&(d._connection.send(u.tree()),
d._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"})),n._immediateMouse&&d._connection.flush())}K=0;e=[];f=[];j=[];h=[];i=[];l=[];v=[];C=[];n._immediateMouse=!1}()}});this._isMouseSniffed=!0;k.enable()},onMessageReceived:function(b){try{b.getAttribute("to");var d=b.getAttribute("from"),k=b.getAttribute("displayName"),m=b.getAttribute("type");b.getElementsByTagName("result").length&&b.getElementsByTagName("result")[0].getAttribute("xmlns")==="consultant:queue"&&setTimeout(function(){e.fire("refreshOperator")},
5E3);if(b.getAttribute("content")==="invitation"){if(d.extractNode()===a.currentOperator)e.fire({type:"invitation",message:f("body",b).text()});else{var p=function(){e.removeEventListener("operator",p);e.fire({type:"invitation",message:f("body",b).text()})};e.addEventListener("operator",p);e.fire("updateServerInfo")}return!0}if(b.getAttribute("content")==="mouse")f("state",b).text()==="on"?(n.sniffMouse(d),a.isSendMouseActive=!0):n.stopSniffMouse(d);else if(b.getAttribute("content")==="typing")if(n._firstMessageSent&&
!n._lockOperatorTyping)e.fire("typing");else{var i=function(a){if(a.sender===j.VISITOR){var b=setTimeout(function(){e.fire("typing")},2500),c=function(a){a.sender===j.OPERATOR&&(clearTimeout(b),e.removeEventListener("message",c))};e.addEventListener("message",c)}e.removeEventListener("message",i)};e.addEventListener("message",i)}else if(b.getAttribute("content")==="command"){var h=JSON.parse(f("body",b).text());h.type==="highlight"&&e.fire(h);h.type==="redirect"&&e.fire(h)}else if(!b.getAttribute("content")||
b.getAttribute("content")==="normal"){var l=Strophe.getText(b.getElementsByTagName("body")[0]);if(l){var v=b.getElementsByTagName("body")[0].getAttribute("mid");if(v&&n._receivedMessage[v])return!0;v&&(n._receivedMessage[v]=!0)}if(l&&(l.indexOf(":g")===0||l.indexOf(":\u0433")===0)){var C=l.substr(3);e.fire("redirect",{link:C});return!0}if(l&&l.indexOf(":r")===0)return e.fire("operatorRedirect"),!0;if(l&&l.indexOf(":ok redirect")>-1)return e.fire("operatorRedirectOk",{operator:d,displayName:k}),!0;
if(l&&l.indexOf(":fail redirect")===0)return e.fire("operatorRedirectFail"),!0;if(m==="chat"&&l){var K=c.now().toString();e.fire({type:"message",time:K,text:l,sender:j.OPERATOR,displayName:k,id:(new Date).getTime(),unixTime:(new Date).getTime()})}}return!0}catch(x){return!0}},onMessageSent:function(b){if(b.raw)d._connection.send(f(b.text));else if(b.sent){if(b.sender===j.VISITOR&&a.stringChatState!=="chat")a.stringChatState="chat",e.fire("updateChatState",{state:"chat"});if(b.sender===j.VISITOR){n._lockOperatorTyping=
!1;var c=$msg({to:a.currentOperator.toOperatorJid(),jid:a.vid.toVisitorJid(),type:"chat"}).c("body").attrs({mid:b.guid}).t(b.text).up();n._firstMessageSent||c.c("active",{xmlns:"http://jabber.org/protocol/chatstates"}).up();d._connection.receipts.sendMessage(c);d._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"}));if(b.sender===j.VISITOR)n._firstMessageSent=!0}}else if(b.sender===j.VISITOR)n._firstMessageSent=!0}};return n});
redhelper.define("view/cssChecker",["common/extensions/jquery.plugins","application/dispatcher"],function(a,d){var b={_defaultCssLoadSelector:"rh-loadCss",_checkLoadInterval:50,check:function(a,b){if(a===void 0)a=this._defaultCssLoadSelector;this._listenCssLoad(a,b)},_listenCssLoad:function(e,j){a("#"+e).css("z-index")==="1"?j!==void 0?d.fire(j):setTimeout(function(){d.fire("cssLoaded")},200):setTimeout(function(){b._listenCssLoad(e,j)},b._checkLoadInterval)}};return b});
redhelper.define("application/statistics",["application/session.objects"],function(a){var d=!1,b=!1;return{checkNewVisit:function(){var b=new Date(a.lastVisit),j=new Date;a.lastVisit=(new Date).toString();return d=j.getTime()-b.getTime()>12E5},checkNewDay:function(){var d=new Date(a.previousDay);if(b=(new Date).getTime()-d.getTime()>864E5)a.previousDay=(new Date).toString();return b}}});
redhelper.define("xmpp/authentication","xmpp/connection,application/dispatcher,application/session.objects,common/constants/sender,common/extensions/jquery.plugins,common/application/time,application/statistics,config/setup,common/extensions/browserDetect,common/extensions/strophe,common/communication/encoder,common/extensions/debug".split(","),function(a,d,b,e,j,f,c,k,n,t,r,q){var m={resendAuth:function(){try{a._connection.send($pres().tree());var d=$iq({type:"set"}).c("query",{xmlns:"consultant:auth"}).c("client").t(k.CLIENT_NAME).up().c("clientName").t(k.CLIENT_NAME).up().c("os").t(n.OS).up().c("browser").c("type").t(n.browser).up().c("version").t(n.version.toString()).up().up().c("browserName").t(n.browser+
" "+n.version).up().c("ip").t(b.ip).up().c("url").t(k.CURRENT_URL).up().c("currentUrl").t(k.CURRENT_URL).up().c("title").t(k.CURRENT_TITLE).up().c("currentPageTitle").t(k.CURRENT_TITLE).up().c("referrer").t(b.referrer).up().c("visits").t(b.visits.toString()).up().c("time").t(b.time.toString()).up().c("timeOnSite").t(b.time.toString()).up().c("currentOperator").t(b.currentOperator).up().c("viewedPages").t(b.viewedPages.toString()).up().c("inviteState").t(b.inviteState?b.inviteState.toString():"none").up().c("chatState").t(b.stringChatState||
"browse").up().c("trigger").t(b.trigger).up().c("country").t(b.country).up().c("region").t(b.region).up().c("city").t(b.city).up();try{if(!b.free&&b.customFields){var e=r.parse(b.customFields);d.c("keys");for(o in e)e.hasOwnProperty(o)&&d.c("key").c("name").t(e[o].name).up().c("value").t(e[o].value).up().up();d.up()}}catch(f){q.log(f)}c.checkNewVisit()&&d.c("newVisit").t("1").up();c.checkNewDay()&&d.c("newDay").t("1").up();b.vid>0&&d.c("vid").t(b.vid.toString());a._connection.sendIQ(d.tree(),m.onReauth,
null,7E3)}catch(l){q.log(l)}},onReauth:function(a){j("vid",a).text()?b.vid=j("vid",a).text():f.setTimeDifference(j("time",a).text())},init:function(){var d;try{a._connection.send($pres().tree());var e=$iq({type:"set"}).c("query",{xmlns:"consultant:auth"}).c("client").t(k.CLIENT_NAME).up().c("clientName").t(k.CLIENT_NAME).up().c("os").t(n.OS).up().c("browser").c("type").t(n.browser).up().c("version").t(n.version.toString()).up().up().c("browserName").t(n.browser+" "+n.version).up().c("ip").t(b.ip).up().c("url").t(k.CURRENT_URL).up().c("currentUrl").t(k.CURRENT_URL).up().c("title").t(k.CURRENT_TITLE).up().c("currentPageTitle").t(k.CURRENT_TITLE).up().c("referrer").t(b.referrer).up().c("visits").t(b.visits.toString()).up().c("time").t(b.time.toString()).up().c("timeOnSite").t(b.time.toString()).up().c("currentOperator").t(b.currentOperator).up().c("viewedPages").t(b.viewedPages.toString()).up().c("inviteState").t(b.inviteState?
b.inviteState.toString():"none").up().c("chatState").t(b.stringChatState||"browse").up().c("trigger").t(b.trigger).up().c("country").t(b.country).up().c("region").t(b.region).up().c("city").t(b.city).up();try{if(!b.free&&b.customFields){var f=r.parse(b.customFields);e.c("keys");for(d in f)f.hasOwnProperty(d)&&e.c("key").c("name").t(f[d].name).up().c("value").t(f[d].value).up().up();e.up()}}catch(l){q.log(l)}c.checkNewVisit()&&e.c("newVisit").t("1").up();c.checkNewDay()&&e.c("newDay").t("1").up();
b.vid>0&&e.c("vid").t(b.vid.toString());a._connection.sendIQ(e.tree(),m.onAuthenticate,null,7E3)}catch(j){q.log(j)}},onAuthenticate:function(a){j("vid",a).text()?b.vid=j("vid",a).text():f.setTimeDifference(j("time",a).text());d.fire("authenticated")},onHistory:function(a){d.fire("historyReceived");var a=j("message",a),c;for(c=0;c<a.length;c++){var h=j(a[c]),l=h.attr("from")===b.vid.toVisitorJid()?e.VISITOR:e.OPERATOR,k=f.parse(h.attr("time")).toString(),m=h.children("body").text(),n=h.attr("displayName")||
"";d.fire({type:"message",time:k,id:f.parse(h.attr("time")).getTime(),text:m,sender:l,displayName:n,isHistory:!0})}}};return m});
redhelper.define("xmpp/loadTest","common/extensions/jquery.plugins,common/extensions/browserDetect,application/session.objects,config/setup,common/extensions/strophe,common/extensions/compatibility".split(","),function(a,d,b,e,j){function f(a){try{if(typeof a!=="undefined"){if(typeof a.domain==="string")r=a.domain;if(typeof a.url==="string")q=a.url;if(typeof a.pingInterval==="number"&&a.pingInterval>2E3)n=a.pingInterval;if(typeof a.updateInterval==="number"&&a.updateInterval>2E3)t=a.updateInterval;
if(typeof a.probability==="number")k=a.probability;c()}}catch(b){}}function c(){if(Math.random()*1E3<1E3*k)try{var a;setTimeout(function(){a=new Strophe.Connection(q);a.connect(r,"",c,50)},3E3);var c=function(c){if(c===Strophe.Status.CONNECTED||c===Strophe.Status.ATTACHED){a.send($pres().tree());var e=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(b.vid.toString()).up().c("clientName").t(j.CLIENT_NAME+"").up().c("time").t("1").up(),f=$iq({type:"get"}).c("query",{xmlns:"consultant:ping"}),
c=$iq({type:"set"}).c("query",{xmlns:"consultant:auth"}).c("client").t(j.CLIENT_NAME).up().c("clientName").t(j.CLIENT_NAME).up().c("os").t(d.OS).up().c("browser").c("type").t(d.browser).up().c("version").t(d.version+"").up().up().c("browserName").t(d.browser+" "+d.version).up().c("ip").t(b.ip).up().c("url").t(j.CURRENT_URL).up().c("currentUrl").t(j.CURRENT_URL).up().c("title").t(j.CURRENT_TITLE).up().c("currentPageTitle").t(j.CURRENT_TITLE).up().c("referrer").t(b.referrer).up().c("visits").t(b.visits+
"").up().c("time").t(b.time+"").up().c("timeOnSite").t(b.time+"").up().c("currentOperator").t(b.currentOperator).up().c("viewedPages").t(b.viewedPages+"").up().c("inviteState").t(b.inviteState+"").up().c("chatState").t(b.stringChatState?b.stringChatState:"browse").up().c("trigger").t(b.trigger).up().c("country").t(b.country).up().c("region").t(b.region).up().c("city").t(b.city).up();a.sendIQ(c,function(){setInterval(function(){a.sendIQ(e)},t);setInterval(function(){a.sendIQ(f)},n)})}}}catch(e){}}
if(location.protocol==="http:"&&!(d.browser.toLowerCase()!=="chrome"&&d.browser.toLowerCase()!=="firefox")){var k=0.1,n=1E4,t=3E4,r="test.xmpp.redhelper.ru",q="http://test.web.redhelper.ru/http-bind/";try{window.rh_load_tst=f;var m=a("<script type='text/javascript' src='"+(location.protocol+"//"+location.hostname+"/conf.js")+"'><\/script>");a("head").append(m)}catch(p){}}});redhelper.requirejs.config({baseUrl:"js",paths:{common:"../../common/js"}});
redhelper.define("xmpp/xmppManager","application/dispatcher,xmpp/update,xmpp/xmppException,xmpp/queue,xmpp/authentication,application/session.objects,xmpp/connection,xmpp/loadTest,xmpp/messages,common/extensions/strophe,common/constants/sender".split(","),function(a,d,b,e,j,f,c,k,n,t,r){var q=[],m=function(a){c._isAuthenticated||!a.isMultiTab&&!a.isHistory&&q.push(a)},p={_updateId:null,_sniffId:null,_isAuthenticated:!1,_isConnected:!1,_getOperatorId:null,_UPDATE_TIME:35E3,logMessages:function(){a.addEventListener("message",
m)},stopLogMessages:function(){p.flushQueue();a.removeEventListener("message",m)},flushQueue:function(){q.splice(0,q.length)},start:function(){var b;p.logMessages();a.addEventListener("authenticated",function(){p.routines();e.getOperator();var a=2E4,b=function(){f.isOnline||(e.getOperator(),a+=2E4);p._getOperatorId=setTimeout(b,a)};p._getOperatorId=setTimeout(b,a)});a.fire("xmppConnecting");c.setMessageHandler(n.onMessageReceived);c.init();a.addEventListener("operator",function(){for(var a in q)q.hasOwnProperty(a)&&
(n.onMessageSent(q[a]),q.splice(a,1));f.isOnline=!0;p.stopLogMessages()});a.addEventListener("connected",function(){p._isConnected=!0;j.init()});a.addEventListener("attached",function(){p._isConnected=!0;j.init()});c._attached&&j.init();a.addEventListener("updateServerInfo",function(){e.checkOperator()});a.addEventListener("refreshOperator",function(){e.getOperator()});a.addEventListener("sniffMouse",function(){f.isSendMouseActive=!0;n.sniffMouse()});a.addEventListener("cobrowseMessage",function(b){var d=
$msg({to:f.currentOperator.toOperatorJid(),jid:f.vid.toVisitorJid(),type:"chat",content:"cobrowse"}).c("body").t(JSON.stringify(b)).up();c.isAuthenticated()?(c._connection.send(d.tree()),c._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"})),c._connection.flush(),b.type="cobrowseMessageSent",a.fire(b)):setTimeout(function(){a.fire(b)},500)});a.addEventListener("operatorRedirectOk",function(a){f.currentOperator=a.operator.extractNode();f.operDisplayName=a.displayName;e.getOperator()});
a.addEventListener("stropheDisconnected",function(){if(!c.disconnecting)f.reconnects++,c._isAuthenticated=!1,a.fire("disconnected")});a.addEventListener("reconnect",c.reconnect);a.addEventListener("disconnect",function(){clearInterval(p._updateId);clearInterval(p._sniffId);a.removeEventListener("message",n.onMessageSent);a.removeEventListener("rawMessage",n.onMessageSent);c.disconnect()});if(f.isSendMouseActive){var h=JSON.parse(f.mouseOperators||"{}");for(b in h)h.hasOwnProperty(b)&&n.sniffMouse(h[b].jid,
h[b].start)}a.addEventListener("customFieldsChanged",function(a){d.customFields(a.keys)});a.addEventListener("xmppGotOperator",function(a){e.onGetOperator(a.stanza);f.lastMessageFrom===r.VISITOR&&f.lastMessageTime>(new Date).getTime()-3E5&&n.touchOperator()});a.addEventListener("urlChanged",function(){j.resendAuth()})},counter:function(a){if(!a.isHistory)f.lastMessageTime=a.unixTime,f.lastMessageFrom=a.sender},routines:function(){d.simple();p._updateId&&clearInterval(p._updateId);p._sniffId&&clearInterval(p._sniffId);
p._getOperatorId&&clearInterval(p._getOperatorId);p._updateId=setInterval(function(){d.simple()},this._UPDATE_TIME);p._sniffId=setInterval(function(){n.sniff()},1E3);a.removeEventListener("message",n.onMessageSent);a.removeEventListener("rawMessage",n.onMessageSent);a.removeEventListener("message",p.counter);a.addEventListener("message",n.onMessageSent);a.addEventListener("rawMessage",n.onMessageSent);a.addEventListener("message",p.counter);c._isAuthenticated=!0},stop:function(){a.fire("disconnect")}};
return p});redhelper.define("common/constants/offlineError",{UNDEFINED:0,INCORRECT_EMAIL:1});redhelper.define("common/extensions/guid",[],function(){return{generate:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var d=Math.random()*16|0;return(a=="x"?d:d&3|8).toString(16)})}}});
redhelper.define("view/uiEvents","common/extensions/jquery.plugins,application/session.objects,config/lang,config/setup,application/dispatcher,common/constants/sender,common/constants/offlineError,common/application/basicActivity,common/application/time,common/extensions/guid,common/extensions/browserDetect".split(","),function(a,d,b,e,j,f,c,k,n,t,r){var q=!1,m={_isSendingOffline:!1,bind:function(){var c=function(){k.update();return!0};a(window).click(c);a(window).mousemove(c);a(window).keydown(c);
a(window).resize(function(){var b=a("#chatItself")[0];b.scrollTop=b.scrollHeight});var i=function(){};if(r.isMobile){if(a("#chatTextarea").val("").css("color","#000").attr("placeholder",b.CHAT_LABEL).keypress(function(b){b.keyCode===13&&a("#chatSend").click()}),!b.CHAT_LABEL){var h=function(){b.CHAT_LABEL?a("#chatTextarea").attr("placeholder",b.CHAT_LABEL):setTimeout(h,100)};h()}}else a("#chatTextarea").focus(function(){a(this).val()===b.CHAT_LABEL&&a(this).val("");a(this).css("color","#000")}).blur(function(){a(this).val().trim()===
""&&a(this).val(b.CHAT_LABEL);a(this).css("color","#bbb")}).keydown(function(b){if(!q){i();if(b.keyCode===13){if(b.ctrlKey)if(b=this.value,typeof this.selectionStart==="number"&&typeof this.selectionEnd==="number"){var c=this.selectionStart;this.value=b.slice(0,c)+"\n"+b.slice(this.selectionEnd);this.selectionStart=this.selectionEnd=c+1}else{if(document.selection&&document.selection.createRange)this.focus(),b=document.selection.createRange(),b.text="\r\n",b.collapse(!1),b.select()}else{if(e.DEBUG&&
b.shiftKey)return j.fire({type:"rawMessage",text:a("#chatTextarea").val(),raw:!0}),!1;a("#chatSend").click()}return!1}d.currentTypedText=a(this).val()}}).keyup(function(){a(this).val().length>8E3&&(j.fire("showLabel",{text:b.TOO_LONG}),i=function(){a("#chatTextarea").val().length<=8E3&&(j.fire("hideLabel"),i=function(){})})});j.addEventListener("disableChat",function(b){b.reason&&j.fire("showLabel",{text:b.reason});q=!0;a("#chatTextarea").attr("disabled","disabled");a("#chatSend, #chatTextarea").addClass("disabled")});
j.addEventListener("enableChat",function(){q&&(q=!1,a("#chatTextarea").removeAttr("disabled"),j.fire("hideLabel"),a("#chatSend, #chatTextarea").removeClass("disabled"))});a("#chatSend").click(function(){if(!q){var c=a("#chatTextarea").val();if(c.length>8E3)j.fire("showLabel",{text:b.TOO_LONG}),i=function(){a("#chatTextarea").val().length<=8E3&&(j.fire("hideLabel"),i=function(){})};else{d.currentTypedText="";if(c.replace(/\n+/g,"\n").trim()!==""&&c.replace(/\n+/g,"")!==b.CHAT_LABEL){var e=n.now().toString();
j.fire({type:"message",text:c,id:(new Date).getTime(),time:e,sender:f.VISITOR,displayName:b.YOU_LABEL,sent:!0,unixTime:(new Date).getTime(),guid:t.generate()})}a("#chatTextarea").val("");try{a("#chatTextarea").focus()}catch(h){}}}});a(document).keydown(function(a){a.ctrlKey&&a.altKey&&a.keyCode===69&&j.fire("refreshHistory");if(a.ctrlKey&&a.altKey&&a.keyCode===68)return e.DEBUG=!e.DEBUG,localStorage.setItem("rhlp.debug",e.DEBUG?"true":""),!1});a("#chatLabel").on("click","[href='#offline']",function(){a("#online").hide();
a("#offline").show()});a("#sendButton").click(function(){}).mousedown(function(){a(this).addClass("pressed")}).mouseup(function(){a(this).removeClass("pressed")}).mouseout(function(){a(this).removeClass("pressed")}).click(function(){if(m._isSendingOffline)return!1;var c=a("#email"),e=a("#phone"),f=a("#name"),i=a("#message");c.val(a.trim(c.val()));e.val(a.trim(e.val()));f.val(a.trim(f.val()));i.val(a.trim(i.val()));var h=d.offlineFields.indexOf("phone")>-1,k=d.offlineFields.indexOf("email")>-1,p=d.offlineFields.indexOf("message")>
-1,n=d.offlineFields.indexOf("name")>-1;!c.val()&&k||!f.val()&&n||!i.val()&&p||!e.val()&&h?a("#offlineError").text(b.NOT_ALL_FIELDS):k&&!c.val().match(/^[^@?&]+[@][a-zA-Z0-9\.]+([a-z0-9A-Z\-.]*[a-zA-Z0-9\.])[.][^@]{2,16}$/)?a("#offlineError").text(b.INCORRECT_EMAIL):h&&!e.val().match(/^\+?([\(\)\-]?\d[\(\)\-]?){6,20}$/)?a("#offlineError").text(b.INCORRECT_PHONE):(this._isSendingOffline=!0,a("#email, #name, #message, #phone").attr("disabled","disabled"),a("#throbber").show(),a("#sendButton").css("opacity",
"0.7"),j.fire("sendOffline",{name:n?f.val():"",email:k?c.val():"",message:p?i.val():"",phone:h?e.val():""}))});a("input, textarea").keyup(function(){a("#mailSuccess").hide()});j.addEventListener("offlineSuccess",function(){m.showSuccess()});j.addEventListener("offlineFailure",function(a){m.showFailure(a)})},showSuccess:function(){m._isSendingOffline=!1;a("#offlineError").hide();a("#throbber").hide();a("#sendButton").css("opacity","1");a("#offlineSuccess").show();a("#offline").hide();setTimeout(function(){a("#offlineSuccess").hide();
a("#offline").show();a("#email, #name, #message").removeAttr("disabled").val("");a("#mailSuccess").text(b.MAIL_SENT).show();j.fire("offlineDone")},1200)},showFailure:function(d){m._isSendingOffline=!1;a("#offlineError").text(d.errorCode===c.INCORRECT_EMAIL?b.EMAIL_INCORRECT:b.FAILED_TO_SEND).show();a("#offlineSuccess").hide();a("#email, #name, #message").removeAttr("disabled");a("#throbber").hide();a("#sendButton").css("opacity","1")}};return m});
redhelper.define("common/extensions/swfobject",[],function(){try{if(document.createElement("audio").canPlayType)return{}}catch(a){}var d=function(){function a(){if(!N){try{var b=w.getElementsByTagName("body")[0].appendChild(w.createElement("span"));b.parentNode.removeChild(b)}catch(c){return}N=!0;for(var b=$.length,d=0;d<b;d++)$[d]()}}function e(a){N?a():$[$.length]=a}function j(a){if(typeof D.addEventListener!=x)D.addEventListener("load",a,!1);else if(typeof w.addEventListener!=x)w.addEventListener("load",
a,!1);else if(typeof D.attachEvent!=x)h(D,"onload",a);else if(typeof D.onload=="function"){var b=D.onload;D.onload=function(){b();a()}}else D.onload=a}function f(){var a=w.getElementsByTagName("body")[0],b=w.createElement(s);b.setAttribute("type",S);var d=a.appendChild(b);if(d){var e=0;(function(){if(typeof d.GetVariable!=x){var f=d.GetVariable("$version");if(f)f=f.split(" ")[1].split(","),y.pv=[parseInt(f[0],10),parseInt(f[1],10),parseInt(f[2],10)]}else if(e<10){e++;setTimeout(arguments.callee,10);
return}a.removeChild(b);d=null;c()})()}else c()}function c(){var a=P.length;if(a>0)for(var b=0;b<a;b++){var c=P[b].id,d=P[b].callbackFn,e={success:!1,id:c};if(y.pv[0]>0){var f=i(c);if(f)if(l(P[b].swfVersion)&&!(y.wk&&y.wk<312)){if(C(c,!0),d)e.success=!0,e.ref=k(c),d(e)}else if(P[b].expressInstall&&n()){e={};e.data=P[b].expressInstall;e.width=f.getAttribute("width")||"0";e.height=f.getAttribute("height")||"0";if(f.getAttribute("class"))e.styleclass=f.getAttribute("class");if(f.getAttribute("align"))e.align=
f.getAttribute("align");for(var h={},f=f.getElementsByTagName("param"),j=f.length,m=0;m<j;m++)f[m].getAttribute("name").toLowerCase()!="movie"&&(h[f[m].getAttribute("name")]=f[m].getAttribute("value"));t(e,h,c,d)}else r(f),d&&d(e)}else if(C(c,!0),d){if((c=k(c))&&typeof c.SetVariable!=x)e.success=!0,e.ref=c;d(e)}}}function k(a){var b=null;if((a=i(a))&&a.nodeName=="OBJECT")typeof a.SetVariable!=x?b=a:(a=a.getElementsByTagName(s)[0])&&(b=a);return b}function n(){return!E&&l("6.0.65")&&(y.win||y.mac)&&
!(y.wk&&y.wk<312)}function t(a,b,c,d){E=!0;U=d||null;W={success:!1,id:c};var e=i(c);if(e){e.nodeName=="OBJECT"?(R=q(e),H=null):(R=e,H=c);a.id=O;if(typeof a.width==x||!/%$/.test(a.width)&&parseInt(a.width,10)<310)a.width="310";if(typeof a.height==x||!/%$/.test(a.height)&&parseInt(a.height,10)<137)a.height="137";w.title=w.title.slice(0,47)+" - Flash Player Installation";d=y.ie&&y.win?"ActiveX":"PlugIn";d="MMredirectURL="+D.location.toString().replace(/&/g,"%26")+"&MMplayerType="+d+"&MMdoctitle="+w.title;
typeof b.flashvars!=x?b.flashvars+="&"+d:b.flashvars=d;if(y.ie&&y.win&&e.readyState!=4)d=w.createElement("div"),c+="SWFObjectNew",d.setAttribute("id",c),e.parentNode.insertBefore(d,e),e.style.display="none",function(){e.readyState==4?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}();m(a,b,c)}}function r(a){if(y.ie&&y.win&&a.readyState!=4){var b=w.createElement("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(q(a),b);a.style.display="none";(function(){a.readyState==4?a.parentNode.removeChild(a):
setTimeout(arguments.callee,10)})()}else a.parentNode.replaceChild(q(a),a)}function q(a){var b=w.createElement("div");if(y.win&&y.ie)b.innerHTML=a.innerHTML;else if(a=a.getElementsByTagName(s)[0])if(a=a.childNodes)for(var c=a.length,d=0;d<c;d++)!(a[d].nodeType==1&&a[d].nodeName=="PARAM")&&a[d].nodeType!=8&&b.appendChild(a[d].cloneNode(!0));return b}function m(a,b,c){var d,e=i(c);if(y.wk&&y.wk<312)return d;if(e){if(typeof a.id==x)a.id=c;if(y.ie&&y.win){var f="",h;for(h in a)if(a[h]!=Object.prototype[h])h.toLowerCase()==
"data"?b.movie=a[h]:h.toLowerCase()=="styleclass"?f+=' class="'+a[h]+'"':h.toLowerCase()!="classid"&&(f+=" "+h+'="'+a[h]+'"');h="";for(var j in b)b[j]!=Object.prototype[j]&&(h+='<param name="'+j+'" value="'+b[j]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";Q[Q.length]=a.id;d=i(a.id)}else{j=w.createElement(s);j.setAttribute("type",S);for(var l in a)a[l]!=Object.prototype[l]&&(l.toLowerCase()=="styleclass"?j.setAttribute("class",a[l]):l.toLowerCase()!=
"classid"&&j.setAttribute(l,a[l]));for(f in b)b[f]!=Object.prototype[f]&&f.toLowerCase()!="movie"&&(a=j,h=f,l=b[f],c=w.createElement("param"),c.setAttribute("name",h),c.setAttribute("value",l),a.appendChild(c));e.parentNode.replaceChild(j,e);d=j}}return d}function p(a){var b=i(a);if(b&&b.nodeName=="OBJECT")y.ie&&y.win?(b.style.display="none",function(){if(b.readyState==4){var c=i(a);if(c){for(var d in c)typeof c[d]=="function"&&(c[d]=null);c.parentNode.removeChild(c)}}else setTimeout(arguments.callee,
10)}()):b.parentNode.removeChild(b)}function i(a){var b=null;try{b=w.getElementById(a)}catch(c){}return b}function h(a,b,c){a.attachEvent(b,c);T[T.length]=[a,b,c]}function l(a){var b=y.pv,a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?!0:!1}function v(a,b,c,d){if(!y.ie||!y.mac){var e=w.getElementsByTagName("head")[0];if(e){c=c&&typeof c=="string"?c:"screen";d&&(X=J=null);if(!J||X!=
c)d=w.createElement("style"),d.setAttribute("type","text/css"),d.setAttribute("media",c),J=e.appendChild(d),y.ie&&y.win&&typeof w.styleSheets!=x&&w.styleSheets.length>0&&(J=w.styleSheets[w.styleSheets.length-1]),X=c;y.ie&&y.win?J&&typeof J.addRule==s&&J.addRule(a,b):J&&typeof w.createTextNode!=x&&J.appendChild(w.createTextNode(a+" {"+b+"}"))}}}function C(a,b){if(Y){var c=b?"visible":"hidden";N&&i(a)?i(a).style.visibility=c:v("#"+a,"visibility:"+c)}}function K(a){return/[\\\"<>\.;]/.exec(a)!=null&&
typeof encodeURIComponent!=x?encodeURIComponent(a):a}var x="undefined",s="object",S="application/x-shockwave-flash",O="SWFObjectExprInst",D=window,w=document,B=navigator,u=!1,$=[function(){u?f():c()}],P=[],Q=[],T=[],R,H,U,W,N=!1,E=!1,J,X,Y=!0,y=function(){var a=typeof w.getElementById!=x&&typeof w.getElementsByTagName!=x&&typeof w.createElement!=x,b=B.userAgent.toLowerCase(),c=B.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b),c=c?/mac/.test(c):/mac/.test(b),b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,
"$1")):!1,e=!+"\u000b1",f=[0,0,0],i=null;if(typeof B.plugins!=x&&typeof B.plugins["Shockwave Flash"]==s){if((i=B.plugins["Shockwave Flash"].description)&&!(typeof B.mimeTypes!=x&&B.mimeTypes[S]&&!B.mimeTypes[S].enabledPlugin))u=!0,e=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),f[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),f[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),f[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof D.ActiveXObject!=x)try{var h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
if(h&&(i=h.GetVariable("$version")))e=!0,i=i.split(" ")[1].split(","),f=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]}catch(j){}return{w3:a,pv:f,wk:b,ie:e,win:d,mac:c}}();(function(){y.w3&&((typeof w.readyState!=x&&w.readyState=="complete"||typeof w.readyState==x&&(w.getElementsByTagName("body")[0]||w.body))&&a(),N||(typeof w.addEventListener!=x&&w.addEventListener("DOMContentLoaded",a,!1),y.ie&&y.win&&(w.attachEvent("onreadystatechange",function(){w.readyState=="complete"&&(w.detachEvent("onreadystatechange",
arguments.callee),a())}),D==top&&function(){if(!N){try{w.documentElement.doScroll("left")}catch(c){setTimeout(arguments.callee,0);return}a()}}()),y.wk&&function(){N||(/loaded|complete/.test(w.readyState)?a():setTimeout(arguments.callee,0))}(),j(a)))})();(function(){y.ie&&y.win&&window.attachEvent("onunload",function(){for(var a=T.length,b=0;b<a;b++)T[b][0].detachEvent(T[b][1],T[b][2]);a=Q.length;for(b=0;b<a;b++)p(Q[b]);for(var c in y)y[c]=null;y=null;for(var e in d)d[e]=null;d=null})})();return{registerObject:function(a,
b,c,d){if(y.w3&&a&&b){var e={};e.id=a;e.swfVersion=b;e.expressInstall=c;e.callbackFn=d;P[P.length]=e;C(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(y.w3)return k(a)},embedSWF:function(a,b,c,d,f,i,h,j,k,p){var q={success:!1,id:b};y.w3&&!(y.wk&&y.wk<312)&&a&&b&&c&&d&&f?(C(b,!1),e(function(){c+="";d+="";var e={};if(k&&typeof k===s)for(var u in k)e[u]=k[u];e.data=a;e.width=c;e.height=d;u={};if(j&&typeof j===s)for(var r in j)u[r]=j[r];if(h&&typeof h===s)for(var v in h)typeof u.flashvars!=
x?u.flashvars+="&"+v+"="+h[v]:u.flashvars=v+"="+h[v];if(l(f))r=m(e,u,b),e.id==b&&C(b,!0),q.success=!0,q.ref=r;else if(i&&n()){e.data=i;t(e,u,b,p);return}else C(b,!0);p&&p(q)})):p&&p(q)},switchOffAutoHideShow:function(){Y=!1},ua:y,getFlashPlayerVersion:function(){return{major:y.pv[0],minor:y.pv[1],release:y.pv[2]}},hasFlashPlayerVersion:l,createSWF:function(a,b,c){if(y.w3)return m(a,b,c)},showExpressInstall:function(a,b,c,d){y.w3&&n()&&t(a,b,c,d)},removeSWF:function(a){y.w3&&p(a)},createCSS:function(a,
b,c,d){y.w3&&v(a,b,c,d)},addDomLoadEvent:e,addLoadEvent:j,getQueryParamValue:function(a){var b=w.location.search||w.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return K(b);for(var b=b.split("&"),c=0;c<b.length;c++)if(b[c].substring(0,b[c].indexOf("="))==a)return K(b[c].substring(b[c].indexOf("=")+1))}return""},expressInstallCallback:function(){if(E){var a=i(O);if(a&&R){a.parentNode.replaceChild(R,a);if(H&&(C(H,!0),y.ie&&y.win))R.style.display="block";U&&U(W)}E=!1}}}}();return d});
redhelper.define("common/extensions/audio",["common/extensions/swfobject","config/setup","common/extensions/browserDetect"],function(a,d,b){return function(){var e,j,f=!0,c,k=!0;return{init:function(n){typeof n!="undefined"&&(f=!!n);if(b.isMobile||b.OS==="Android"||b.OS==="iPhone")k=!1,c=function(){};else if(e=document.createElement("audio"),e.canPlayType)e.canPlayType("audio/mp3")?e.setAttribute("src",d.DATA_URL+"/extras/msg.mp3"):e.setAttribute("src",d.DATA_URL+"/extras/msg.ogg"),e.volume=0.4,c=
function(){e.play()};else{try{if(!a.hasFlashPlayerVersion("1")){c=function(){};k=!1;return}}catch(t){c=function(){};k=!1;return}j=a.createSWF({data:"extras/mp3player.swf",width:"0",height:"0"},{AllowScriptAccess:"always"},"audio");c=function(){try{j.SetVariable("method:setVolume","40"),j.SetVariable("method:setUrl","extras/msg.mp3"),j.SetVariable("method:play","")}catch(a){}}}},play:function(){f&&c()},turnOn:function(){f=!0},turnOff:function(){f=!1},soundCheck:function(){return k}}}()});
redhelper.define("common/extensions/punycode",[],function(){var a={};(function(a){function b(a){throw RangeError(S[a]);}function e(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function j(a){for(var b=[],c=0,d=a.length,e,f;c<d;)e=a.charCodeAt(c++),(e&63488)==55296&&c<d?(f=a.charCodeAt(c++),(f&64512)==56320?b.push(((e&1023)<<10)+(f&1023)+65536):b.push(e,f)):b.push(e);return b}function f(a){return e(a,function(a){var b="";a>65535&&(a-=65536,b+=w(a>>>10&1023|55296),a=56320|a&1023);b+=w(a);return b}).join("")}
function c(a,b,c){var d=0,a=c?D(a/l):a>>1;for(a+=D(a/b);a>O*i>>1;d+=m)a=D(a/O);return D(d+(O+1)*a/(a+h))}function k(a){var d=[],e=a.length,h,j=0,l=C,k=v,n,r,t,s,w;n=a.lastIndexOf(K);n<0&&(n=0);for(r=0;r<n;++r)a.charCodeAt(r)>=128&&b("not-basic"),d.push(a.charCodeAt(r));for(n=n>0?n+1:0;n<e;){for(r=j,h=1,t=m;;t+=m){n>=e&&b("invalid-input");s=a.charCodeAt(n++);s=s-48<10?s-22:s-65<26?s-65:s-97<26?s-97:m;(s>=m||s>D((q-j)/h))&&b("overflow");j+=s*h;w=t<=k?p:t>=k+i?i:t-k;if(s<w)break;s=m-w;h>D(q/s)&&b("overflow");
h*=s}h=d.length+1;k=c(j-r,h,r==0);D(j/h)>q-l&&b("overflow");l+=D(j/h);j%=h;d.splice(j++,0,l)}return f(d)}function n(a){var d,e,f,h,l,k,n,r,s,t=[],x,J,O,a=j(a);x=a.length;d=C;e=0;l=v;for(k=0;k<x;++k)s=a[k],s<128&&t.push(w(s));for((f=h=t.length)&&t.push(K);f<x;){for(n=q,k=0;k<x;++k)s=a[k],s>=d&&s<n&&(n=s);J=f+1;n-d>D((q-e)/J)&&b("overflow");e+=(n-d)*J;d=n;for(k=0;k<x;++k)if(s=a[k],s<d&&++e>q&&b("overflow"),s==d){for(r=e,n=m;;n+=m){s=n<=l?p:n>=l+i?i:n-l;if(r<s)break;O=r-s;r=m-s;t.push(w(s+O%r+22+75*
(s+O%r<26)-0));r=D(O/r)}t.push(w(r+22+75*(r<26)-0));l=c(e,J,f==h);e=0;++f}++e;++d}return t.join("")}function t(a){return e(a.split("."),function(a){return s.test(a)?k(a.slice(4).toLowerCase()):a}).join(".")}function r(a){return e(a.split("."),function(a){return x.test(a)?"xn--"+n(a):a}).join(".")}var q=2147483647,m=36,p=1,i=26,h=38,l=700,v=72,C=128,K="-",x=/[^ -~]/,s=/^xn--/,S={overflow:"Overflow: input needs wider integers to process.","not-basic":"Illegal input >= 0x80 (not a basic code point)",
"invalid-input":"Invalid input"},O=m-p,D=Math.floor,w=String.fromCharCode;a.punycode={version:"1.1.1",ucs2:{decode:j,encode:f},decode:k,encode:n,toASCII:r,toUnicode:t,decodeUri:function(a){var b=a.split("//").pop().split("/")[0],c=t(b);return a.replace(b,c)},encodeUri:function(a){var b=a.split("//").pop().split("/")[0],c=r(b);return a.replace(b,c)}}})(a);return a.punycode});
redhelper.require(["application/dispatcher","config/setup","common/extensions/compatibility","common/extensions/jquery"],function(a,d,b,e){function j(){var a=window.localStorage.getItem(f);a!==t&&(r=JSON.parse(a)||[])}if(window.localStorage){var f=d.CLIENT_NAME+".history",c;if(window.localStorage.getItem(f)&&f!=="rhlp.global.history"){var k=JSON.parse(window.localStorage.getItem("rhlp.global.history"))||[],n=JSON.parse(window.localStorage.getItem(f))||[];for(b=0,c=n.length;b<c;b++)n[b].clientName=
d.CLIENT_NAME,k.push(n[b]);window.localStorage.setItem("rhlp.global.history",JSON.stringify(k));window.localStorage.removeItem(f)}var f="rhlp.global.history",t=window.localStorage.getItem(f),r=t?JSON.parse(t)||[]:[];a.addEventListener("message",function(a){!a.isHistory&&!a.ignore&&a.text&&!a.isMultiTab&&(r.push({clientName:d.CLIENT_NAME,time:a.time,id:a.id,text:a.text,sender:a.sender,displayName:a.displayName,guid:a.guid}),r.length>500&&r.splice(0,r.length-500),window.localStorage.setItem(f,JSON.stringify(r)))});
a.addEventListener("getHistory",function(){var b;j();for(b in r)if(r.hasOwnProperty(b)&&r[b].clientName===d.CLIENT_NAME)r[b].isHistory=!0,a.fire("message",r[b]);a.fire("historyShown")});e.browser.msie&&parseInt(e.browser.version,10)<9||rhlpSetInterval(function(){var b,c,e,f=r;j();var h=r,l=[];for(b in h)if(h.hasOwnProperty(b)){var k=!0;for(e in f)f.hasOwnProperty(e)&&f[e].id===h[b].id&&(k=!1);k&&l.push(h[b])}for(c in l)if(l.hasOwnProperty(c)&&l[c].clientName===d.CLIENT_NAME)l[c].isHistory=!0,l[c].isMultiTab=
!0,l[c].sent=!0,l[c].log=!0,a.fire("message",l[c])},300)}});redhelper.define("xmpp/history.cache",function(){});
redhelper.define("xmpp/offline","common/extensions/jquery.plugins,application/dispatcher,config/lang,config/setup,common/constants/offlineError,application/session.objects,common/communication/encoder".split(","),function(a,d,b,e,j,f,c){var k=function(){return{send:function(k,t,r,q){var m="["+e.CURRENT_URL+"]\n",p;if(!f.free&&f.customFields)try{var i=c.parse(f.customFields);for(p in i)i.hasOwnProperty(p)&&(m+=i[p].name+": "+i[p].value+"\n")}catch(h){}q&&(m+=b.PHONE_MESSAGE+": "+q+"\n");m+="\n";a.ajax({url:e.NX_URL+
"offline/"+e.CLIENT_NAME,data:{message:m+r,name:k,email:t,domain:e.CURRENT_URL},dataType:"jsonp",type:"POST",success:function(a){a==="OK"?d.fire("offlineSuccess"):d.fire("offlineFailure",{errorCode:j.INCORRECT_EMAIL})}})}}}();d.addEventListener("sendOffline",function(a){k.send(a.name,a.email,a.message,a.phone)})});
redhelper.define("common/extensions/mozvisibility",[],function(){MozVisibility={_MAX_TRIES:10,_date:new Date,_tries:0,_timer:null,_isVisible:void 0,_proxy:function(a,d){d=d||window;return function(){a.apply(d,arguments)}},_getEvent:function(){if(!this._event)this._event=document.createEvent("HTMLEvents"),this._event.initEvent("mozvisibilitychange",!0,!0),this._event.eventName="mozvisibilitychange";return this._event},_setVisibilityState:function(a){this._isVisible=a==="visible";document.mozVisibilityState=
a;document.mozHidden=!this._isVisible;document.dispatchEvent(this._getEvent())},_visibilityCheck:function(){this._date=new Date;this._tries=0;this._timer=setTimeout(this._invisibilityCheckTimeout,0)},_invisibilityCheckTimeoutTemplate:function(){var a=new Date,d=a-this._date;this._date=a;this._tries++;if(d>1E3)this._setVisibilityState("hidden");else if(this._tries<this._MAX_TRIES)this._timer=setTimeout(this._invisibilityCheckTimeout,0)},_onFocus:function(){clearTimeout(this._timer);this._isVisible||
this._setVisibilityState("visible")},_onBlur:function(){this._isVisible&&this._visibilityCheck()},canBeEmulated:function(){var a=/(mozilla)(?:.*? rv:([\w.]+))?/,d=navigator.userAgent.toLowerCase(),a=d.indexOf("compatible")<0&&a.exec(d)||[];return window.top===window&&a[2]&&parseInt(a[2])>=5&&!document.visibilityState&&!document.MozVisibilityState},emulate:function(){if(!this.canBeEmulated())return!1;this._invisibilityCheckTimeout=this._proxy(this._invisibilityCheckTimeoutTemplate,this);window.addEventListener("focus",
this._proxy(this._onFocus,this),!1);window.addEventListener("blur",this._proxy(this._onBlur,this),!1);this._visibilityCheck();return!0}};MozVisibility.emulate()});
redhelper.define("common/extensions/visibility.fallback",["common/extensions/mozvisibility"],function(){if(!document.visibilityState&&!document.webkitVisibilityState&&!document.msVisibilityState&&!document.mozVisibilityState&&!document.oVisibilityState){document.hidden=!1;document.visibilityState="visible";var a=null,d=function(){document.createEvent?(a||(a=document.createEvent("HTMLEvents"),a.initEvent("visibilitychange",!0,!0)),document.dispatchEvent(a)):typeof Visibility=="object"&&Visibility._onChange.call(Visibility,
{})},b=function(){document.hidden=!1;document.visibilityState="visible";d()},e=function(){document.hidden=!0;document.visibilityState="hidden";d()};document.addEventListener?(window.addEventListener("focus",b,!0),window.addEventListener("blur",e,!0)):(document.attachEvent("onfocusin",b),document.attachEvent("onfocusout",e))}});
redhelper.define("common/extensions/visibility.core",["common/extensions/visibility.fallback"],function(){var a=function(a){return"undefined"!=typeof a},d={onVisible:function(a){if(!this.isSupported()||!this.hidden())return a(),this.isSupported();var e=this.change(function(){d.hidden()||(d.unbind(e),a())});return e},change:function(a){if(!this.isSupported())return!1;this._lastCallback+=1;var d=this._lastCallback;this._callbacks[d]=a;this._setListener();return d},unbind:function(a){delete this._callbacks[a]},
afterPrerendering:function(a){if(!this.isSupported()||"prerender"!=this.state())return a(),this.isSupported();var e=this.change(function(j,f){"prerender"!=f&&(d.unbind(e),a())});return e},hidden:function(){return this._prop("hidden",!1)},state:function(){return this._prop("visibilityState","visible")},isSupported:function(){return a(this._prefix())},_doc:window.document,_prefixes:["webkit","moz","o","ms"],_chechedPrefix:null,_listening:!1,_lastCallback:-1,_callbacks:{},_hiddenBefore:!1,_init:function(){this._hiddenBefore=
this.hidden()},_prefix:function(){if(null!==this._chechedPrefix)return this._chechedPrefix;if(a(this._doc.visibilityState))return this._chechedPrefix="";for(var b,d=0;d<this._prefixes.length;d++)if(b=this._prefixes[d]+"VisibilityState",a(this._doc[b]))return this._chechedPrefix=this._prefixes[d]},_name:function(a){var d=this._prefix();return""==d?a:d+a.substr(0,1).toUpperCase()+a.substr(1)},_prop:function(a,d){return!this.isSupported()?d:this._doc[this._name(a)]},_onChange:function(a){var d=this.state(),
j;for(j in this._callbacks)this._callbacks[j].call(this._doc,a,d);this._hiddenBefore=this.hidden()},_setListener:function(){if(!this._listening){var a=this._prefix()+"visibilitychange",e=function(){d._onChange.apply(d,arguments)};this._doc.addEventListener?this._doc.addEventListener(a,e,!1):this._doc.attachEvent(a,e);this._listening=!0;this._hiddenBefore=this.hidden()}}};d._init();return d});
redhelper.define("common/extensions/tabs",["common/extensions/compatibility","config/setup","common/extensions/visibility.core"],function(a,d,b){var e=!b.hidden(),j="rhlp.tabs."+d.CLIENT_NAME+".flag",f="rhlp.tabs."+d.CLIENT_NAME+".lasttab",c=0,k=(new Date).getTime(),n=!1,t=!0,r=null,q=localStorage.getItem(j),m=function(){},p=function(){},i=function(){localStorage.setItem(f,k);var a=setInterval(function(){localStorage.setItem(j,(new Date).getTime())},50);m();c=0;n=!0;return a};rhlpSetInterval(function(){t||
!n&&q==localStorage.getItem(j)&&!b.hidden()?(t=!1,r=i()):!n&&q==localStorage.getItem(j)&&(c++,c>4&&i());q!=localStorage.getItem(j)&&k!=localStorage.getItem(f)&&n&&(clearInterval(r),p(),n=!1,c=0);q=localStorage.getItem(j)},1100);return{active:function(a){m=a;n&&a()},inactive:function(a){p=a;e||a()}}});redhelper.define("config/settings",["common/communication/encoder"],function(a){try{return a.decompress(location.hash.split("#")[1])}catch(d){return{}}});
redhelper.define("application/redhelper",["application/dispatcher","application/session.objects"],function(a,d){var b,e;window.RedHelper={execFunction:function(b,d){a.fire("sendExecFunction",{name:b,args:d})}};window.RedHelper.session={};for(b=0,e=d.fields.length;b<e;b++)(function(a){window.RedHelper.session[a]=d[a];d.dispatcher.addEventListener("on"+a.charAt(0).toUpperCase()+a.substr(1)+"Changed",function(){window.RedHelper.session[a]=d[a]})})(d.fields[b])});
redhelper.define("text",["module"],function(a){var d,b,e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],j=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,f=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c=typeof location!=="undefined"&&location.href,k=c&&location.protocol&&location.protocol.replace(/\:/,""),n=c&&location.hostname,t=c&&(location.port||void 0),r=[],q=a.config&&a.config()||{};d={version:"2.0.3",strip:function(a){if(a){var a=a.replace(j,""),b=a.match(f);b&&(a=b[1])}else a=
"";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:q.createXhr||function(){var a,b,c;if(typeof XMLHttpRequest!=="undefined")return new XMLHttpRequest;else if(typeof ActiveXObject!=="undefined")for(b=0;b<3;b+=1){c=e[b];try{a=new ActiveXObject(c)}catch(d){}if(a){e=[c];break}}return a},parseName:function(a){var b=
!1,c=a.indexOf("."),d=a.substring(0,c),a=a.substring(c+1,a.length),c=a.indexOf("!");c!==-1&&(b=a.substring(c+1,a.length),b=b==="strip",a=a.substring(0,c));return{moduleName:d,ext:a,strip:b}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,b,c,e){var f,j;f=d.xdRegExp.exec(a);if(!f)return!0;a=f[2];f=f[3];f=f.split(":");j=f[1];f=f[0];return(!a||a===b)&&(!f||f.toLowerCase()===c.toLowerCase())&&(!j&&!f||j===e)},finishLoad:function(a,b,c,e){c=b?d.strip(c):c;q.isBuild&&(r[a]=c);e(c)},load:function(a,
b,e,f){if(f.isBuild&&!f.inlineText)e();else{q.isBuild=f.isBuild;var j=d.parseName(a),f=j.moduleName+"."+j.ext,r=b.toUrl(f),C=q.useXhr||d.useXhr;!c||C(r,k,n,t)?d.get(r,function(b){d.finishLoad(a,j.strip,b,e)},function(a){e.error&&e.error(a)}):b([f],function(a){d.finishLoad(j.moduleName+"."+j.ext,j.strip,a,e)})}},write:function(a,b,c){if(r.hasOwnProperty(b)){var e=d.jsEscape(r[b]);c.asModule(a+"!"+b,"redhelper.define(function () { return '"+e+"';});\n")}},writeFile:function(a,b,c,e,f){var b=d.parseName(b),
j=b.moduleName+"."+b.ext,k=c.toUrl(b.moduleName+"."+b.ext)+".js";d.load(j,c,function(){var b=function(a){return e(k,a)};b.asModule=function(a,b){return e.asModule(a,k,b)};d.write(a,j,b,f)},f)}};if(q.env==="node"||!q.env&&typeof process!=="undefined"&&process.versions&&process.versions.node)b=require.nodeRequire("fs"),d.get=function(a,c){var d=b.readFileSync(a,"utf8");d.indexOf("\ufeff")===0&&(d=d.substring(1));c(d)};else if(q.env==="xhr"||!q.env&&d.createXhr())d.get=function(a,b,c){var e=d.createXhr();
e.open("GET",a,!0);if(q.onXhr)q.onXhr(e,a);e.onreadystatechange=function(){var d;if(e.readyState===4)d=e.status,d>399&&d<600?(d=Error(a+" HTTP status: "+d),d.xhr=e,c(d)):b(e.responseText)};e.send(null)};else if(q.env==="rhino"||!q.env&&typeof Packages!=="undefined"&&typeof java!=="undefined")d.get=function(a,b){var c,d,e=new java.io.File(a),f=java.lang.System.getProperty("line.separator"),e=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(e),"utf-8")),j="";try{c=
new java.lang.StringBuffer;(d=e.readLine())&&d.length()&&d.charAt(0)===65279&&(d=d.substring(1));for(c.append(d);(d=e.readLine())!==null;)c.append(f),c.append(d);j=String(c.toString())}finally{e.close()}b(j)};return d});redhelper.define("text!common/../../service/template.html",[],function(){return'<template>\n\t<div id="offline" style="display: none;">\n\t\t<div class="colorifier"></div>\n\t\t<div class="center">\n\t\t\t<div class="topPanel">\n\t\t\t\t<div class="header"></div>\n\t\t\t\t<div class="description"></div>\n\t\t\t</div>\n\t\t\t<div id="offlineError"></div>\n\t\t\t<div id="mailSuccess"></div>\n\t\t\t<div id="feedbackForm">\n\t\t\t\t<div class="inputField name">\n\t\t\t\t\t<label for="name"></label>\n\t\t\t\t\t<input id="name" type="text" name="name"/>\n\t\t\t\t</div>\n\t\t\t\t<div class="inputField email">\n\t\t\t\t\t<label for="email"></label>\n\t\t\t\t\t<input id="email" type="email" name="email"/>\n\t\t\t\t</div>\n                <div class="inputField phone">\n                    <label for="phone"></label>\n                    <input id="phone" type="text" name="phone"/>\n                </div>\n\t\t\t\t<div class="inputField message">\n\t\t\t\t\t<label for="message"></label>\n\t\t\t\t\t<textarea id="message" name="message"></textarea>\n\t\t\t\t</div>\n\t\t\t\t<div id="actionPanel">\n\t\t\t\t\t<div id="sendButton"></div>\n\t\t\t\t\t<div id="throbber" style="display: none;"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div id="offlineSuccess" style="display: none;">\n\t\t<div></div>\n\t</div>\n\t<div id="online" style="display: none;">\n\t\t<div class="colorifier"></div>\n\t\t<div id="onlinePanel">\n\t\t\t<div class="center">\n\t\t\t\t<div class="wrapper">\n\t\t\t\t\t<div class="topPanel">\n\t\t\t\t\t\t<div id="faceWrapper">\n\t\t\t\t\t\t\t<img id="face" alt="">\n\t\t\t\t\t\t\t<div id="topDescription">\n\t\t\t\t\t\t\t\t<div id="topHeader"></div>\n\t\t\t\t\t\t\t\t<div id="topText"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="scrollBarContainer">\n\t\t\t\t\t\t<div id="scrollBar"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="chatItself">\n\t\t\t\t\t\t<div id="invitation"></div>\n\n\t\t\t\t\t\t<div class="msg" id="typingLabel">\n\t\t\t\t\t\t\t<div class="textWrapper">\n\t\t\t\t\t\t\t\t<div class="text">%text%</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="msg" id="chatLabel">\n\t\t\t\t\t\t\t<div class="textWrapper">\n\t\t\t\t\t\t\t\t<div class="text">%text%</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="chatInput">\n\t\t\t\t\t\t<div id="textAreaWrapper">\n\t\t\t\t\t\t\t<textarea id="chatTextarea"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="chatSend"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div id="fromOperatorHeader" class="msgHeader fromOperator">\n\t\t<span class="sender">%displayName%</span>\n\t</div>\n\n\t<div id="fromOperator" class="msg">\n\t\t<span class="time">%time%</span>\n\t\t<div class="textWrapper">\n\t\t\t<div class="text">%text%</div>\n\t\t</div>\n\t</div>\n\n\t<div id="fromVisitorHeader" class="msgHeader fromVisitor">\n\t\t<span class="sender">%displayName%</span>\n\t</div>\n\n\t<div id="fromVisitor" class="msg">\n\t\t<span class="time">%time%</span>\n\t\t<div class="textWrapper">\n\t\t\t<div class="text">%text%</div>\n\t\t</div>\n\t</div>\n</template>'});
redhelper.requirejs.config({baseUrl:"js",paths:{common:"../../common/js"}});
redhelper.requirejs("application/dispatcher,view/view,view/chat,application/session.objects,common/extensions/jquery.plugins,config/lang,xmpp/messages,view/cssChecker,xmpp/xmppManager,view/uiEvents,common/extensions/audio,common/extensions/punycode,application/parent,xmpp/connection,common/constants/sender,application/timer,common/application/basicActivity,common/extensions/debug,config/setup,xmpp/update,common/extensions/mouse,common/communication/messageTarget,xmpp/history.cache,xmpp/offline,common/extensions/tabs,config/settings,config/api,application/redhelper,common/communication/encoder,text!common/../../service/template.html".split(","),function(a,
d,b,e,j,f,c,k,n,t,r,q,m,p,i,h,l,v,C,K,x,s,S,O,D,w,B,u,$,P){window.$=window.jQuery=j;m.addHandler("execFunction",function(a){try{window[a.name].apply(null,a.args)}catch(b){console&&console.log(b)}});var Q=function(){a.removeEventListener("start",Q);f.initLanguage();var c=function(b){e.isOnline===!1&&!b.isHistory&&a.fire("refreshOperator")};a.addEventListener("message",c);a.addEventListener("invitation",c);a.addEventListener("cssLoaded",function(){j("#loading").animate({opacity:"hide"},150);b.scrollBottom()});
setTimeout(function(){j("#loading").hide()},1E3);a.addEventListener("historyShown",function(){b.scrollBottom()});a.addEventListener("cssLoaded",function(){if(navigator.userAgent.indexOf("Android")>-1){var a=function(){parseInt(j("#online .center").css("padding-top"),10)?j("#onlinePanel").css("height",j("#online").height()-parseInt(j("#online .center").css("padding-top"),10)-parseInt(j("#online .center").css("padding-bottom"),10)+"px"):setTimeout(a,100)};setTimeout(a,500)}});k.check();a.addEventListener("cssLoaded",
function(){if(e.cachedEvent){var b=JSON.parse(e.cachedEvent);e.cachedEvent="";Array.isArray(b)?j.each(b,function(b,c){c.isCached=!0;a.fire(c)}):(b.isCached=!0,a.fire(b))}});!e.isOnline&&!e.offlineEnabled&&m.send("hide");B.innerCSS&&j("<link rel='stylesheet' href='"+B.innerCSS+"'>").appendTo("head");if(B.additionalJS)for(c=B.additionalJS.length-1;c>-1;c--)j.getScript(B.additionalJS[c]);m.addHandler("scrollMessages",function(){b.scrollBottom()});m.addHandler("templateReceived",function(b){a.fire("templateReceived",
b)});C.STANDALONE&&a.fire("templateReceived",{template:P});m.send("templateRequest");B.waitForTemplate(function(){d.show();b.setOutput("#chatItself");a.addEventListener("message",function(a){b.append(a)});if(B.commands)for(var c=B.commands.length,e=0;e<c;e++)j(B.commands[e].applyTo)[B.commands[e].method].apply(j(B.commands[e].applyTo),B.commands[e].arguments);a.fire("getHistory");f.initLanguage();t.bind();b.scrollBottom();a.fire("ready")})};a.addEventListener("xmppConnecting",function(){a.fire("showLabel",
{text:f.OPERATOR_CONNECTING,loading:!0});if(!f.OPERATOR_CONNECTING){var c=function(){f.OPERATOR_CONNECTING?a.fire("showLabel",{text:f.OPERATOR_CONNECTING,loading:!0}):setTimeout(c,100)};setTimeout(c,100)}var d=function(){b.hideLabel();a.removeEventListener("operator",d)};a.addEventListener("operator",d)});a.addEventListener("start",Q);a.addEventListener("xmppStart",function(){a.addEventListener("operator",function(){e.firstMessage&&e.operDisplayName&&!j("#chatItself .invitation").length&&(b.showFirstMessage({sender:i.OPERATOR,
time:"",text:!e.free?e.currentFirstMessage||e.firstMessage:f.DEFAULT_FIRST_MESSAGE,displayName:e.operDisplayName}),m.send("operator"))});e.dispatcher.addEventListener("onCurrentTypedTextChanged",function(){c.typedTextChanged()});a.addEventListener("message",function(){l.update()});a.addEventListener("authenticated",function(){d.show();v.timeEnd("Connection")});a.addEventListener("connected",function(){b.scrollBottom()});a.addEventListener("highlight",function(b){b.url===C.CURRENT_URL||q.decodeUri(b.url)===
C.CURRENT_URL?(r.play(),m.send("highlight",b),a.fire("cobrowseMessage",{action:"confirm",target:"highlight"})):(e.cachedEvent=JSON.stringify(b),a.fire({type:"redirect",link:b.url,noFeedback:!0}))});a.addEventListener("redirect",function(a){r.play();b.showRedirectPrompt(a.link,a.noFeedback)});a.addEventListener("redirectCancel",function(){a.fire("cobrowseMessage",{action:"reject",target:"redirect"})});a.addEventListener("redirectOK",function(b){var c=function(d){d.action==="confirm"&&d.target==="redirect"&&
m.send("redirect",b);a.removeEventListener("cobrowseMessageSent",c)};a.addEventListener("cobrowseMessageSent",c);a.fire("cobrowseMessage",{action:"confirm",target:"redirect"})})});e.onLoad(function(){var c=function(){v.time("Connection");var c=e.onlineOperators;if(!e.isOnline&&c.length)for(var d=c.length,j=0;j<d;j++)if(c[j].name.match(RegExp("^"+e.currentOperator+"$","i"))){e.isOnline=!0;m.send("show");break}D.active(function(){e.isOnline?n.start():setTimeout(function(){},3E4)});D.inactive(function(){n.stop()});
a.addEventListener("start",function(){e.firstMessage&&e.operDisplayName&&b.showFirstMessage({sender:i.OPERATOR,time:"",text:!e.free?e.currentFirstMessage||e.firstMessage:f.DEFAULT_FIRST_MESSAGE,displayName:e.operDisplayName})});m.addHandler("customFieldsChanged",function(b){a.fire("customFieldsChanged",{keys:b.keys})});l.start();if(C.STANDALONE)C.CURRENT_URL=f.URL_NEW_TAB,C.CURRENT_TITLE=f.TITLE_NEW_TAB,a.fire("start"),a.addEventListener("operator",function(){K.state("chat")}),a.addEventListener("userBack",
function(){p.init(!0);a.fire("refreshHistory")}),a.addEventListener("userAway",function(){a.fire("disconnect")}),a.addEventListener("timer_userBack",function(){h.start()}),a.addEventListener("timer_userAway",function(){h.stop()});else{a.addEventListener("updateChatState",function(a){K.state(a.state)});m.addHandler("init",function(){m.send("ready")});m.addHandler("echo",function(){m.send("echo")});m.addHandler("start",function(b){C.CURRENT_URL=b.url;C.CURRENT_TITLE=b.title;e.referrer=b.referrer;m.setOrigin(b.url);
a.fire("xmppStart")});m.addHandler("urlChanged",function(b){C.CURRENT_TITLE=b.currentTitle;C.CURRENT_URL=b.currentURL;a.fire("urlChanged")});var k=!0,q=!0;m.addHandler("active",function(){k=!0;l.isActive()||n.start()});m.addHandler("inactive",function(){k=!1;l.isActive()||a.fire("disconnect")});a.addEventListener("userBack",function(){k||(n.start(),a.fire("refreshHistory"))});a.addEventListener("userAway",function(){k||a.fire("disconnect")});m.addHandler("timer_active",function(){q=!0;h.getActivity().isActive()||
h.start()});m.addHandler("timer_inactive",function(){q=!1;h.getActivity().isActive()||h.stop()});a.addEventListener("timer_userBack",function(){q||h.start()});a.addEventListener("timer_userAway",function(){q||h.stop()});m.addHandler("message",function(a){b.append(a)});m.addHandler("reconnect",function(){a.fire("reconnect")});m.send("ready");x.init().setAsMaster().addParentSlave(m);x.setOffsetFunction(function(a){a.x+=e.currentChatX;a.y=a.y+e.currentChatY+20;a.width=x.getParentMouseData().width;a.height=
x.getParentMouseData().height;a.scrollX=x.getParentMouseData().scrollX;a.scrollY=x.getParentMouseData().scrollY});m.addHandler("state",function(a){a.inviteState?K.invite(a.chatState,a.inviteState,a.trigger):K.state(a.chatState)});m.addHandler("invitationSniff",function(a){K.inviteSniff(a.trigger,a.trigger==="manual"?e.currentOperator:"")});m.addHandler("chOper",function(a){C.REQUIRE_OPERATOR=a.value});m.addHandler("chatXChanged",function(a){e.chatX=a.x});m.addHandler("chatYChanged",function(a){e.chatY=
a.y});m.addHandler("chatWidthChanged",function(a){e.chatWidth=a.width});m.addHandler("chatHeightChanged",function(a){e.chatHeight=a.height});m.addHandler("chatStateChanged",function(a){e.chatState=a.chatState});m.addHandler("chatXChanged",function(a){e.chatX=a.x;e.currentChatX=a.x});m.addHandler("chatYChanged",function(a){e.chatY=a.y;e.currentChatY=a.y});m.addHandler("chatWidthChanged",function(a){e.chatWidth=a.width;e.currentChatWidth=a.width});m.addHandler("chatHeightChanged",function(a){e.chatHeight=
a.height;e.currentChatHeight=a.height});m.addHandler("currentChatXChanged",function(a){e.currentChatX=a.x});m.addHandler("currentChatYChanged",function(a){e.currentChatY=a.y});m.addHandler("currentChatWidthChanged",function(a){e.currentChatWidth=a.width});m.addHandler("currentChatHeightChanged",function(a){e.currentChatHeight=a.height});m.addHandler("chatStateChanged",function(a){e.chatState=a.chatState});a.addEventListener("invitation",function(a){m.send("invitation",a)});a.addEventListener("authenticated",
function(){m.send("authenticated");!e.isOnline&&!e.offlineEnabled&&m.send("hide")});a.addEventListener("changeState",function(a){a.online&&m.send("show");!a.online&&!e.offlineEnabled&&(e.chatStarted||m.send("hide"))});a.addEventListener("disconnected",function(){m.send("disconnected");p.reconnect()});m.addHandler("reload",function(){setTimeout(function(){location.reload()},3E3)});a.addEventListener("message",function(a){m.send("message",a)});a.addEventListener("offlineDone",function(){m.send("minimize")});
a.addEventListener("sendExecFunction",function(a){m.send("execFunction",{name:a.name,args:a.args})})}r.init(e.audioEnabled);r.soundCheck()||m.send("hideSoundButton");a.addEventListener("message",function(a){a.sender===i.OPERATOR&&!a.isHistory&&r.play()});m.addHandler("soundOn",function(){e.audioEnabled=!0;r.turnOn()});m.addHandler("soundOff",function(){e.audioEnabled=!1;r.turnOff()});a.fire("start")};if(C.STANDALONE){var d=location.href.split("//")[0]+(location.href.indexOf("://test.")>-1?"//test.nx.redhelper.ru":
"//nx.redhelper.ru");d+="/nx/presence/"+C.CLIENT_NAME;j.ajax({dataType:"jsonp",async:!0,url:d,success:function(a){for(o in a)if(a.hasOwnProperty(o)&&o!=="operators")if(o==="status"){if(e.isOnline=a[o]==="online",!e.isOnline&&a.operators.length)for(var b=a.operators.length,d=0;d<b;d++)if(a.operators[d].name.match(RegExp("^"+e.currentOperator+"$","i")))e.isOnline=!0}else o==="offlineMode"?e.offlineEnabled=a[o]==="yes"||a.clientType==="limited":o==="clientType"?e.free=a[o]==="limited":e[o]=a[o];if(typeof a.operators===
"string")try{a.operators=$.parse(a.operators)}catch(f){}e.onlineOperators=a.operators||[];j(c)}})}else j(c)})});redhelper.define("application/main",function(){});
